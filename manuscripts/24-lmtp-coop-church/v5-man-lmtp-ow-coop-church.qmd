---
title: "Causal effects of religious service attendance on prosociality evidence from a national longitudinal study"
abstract: |
   The question: "does religion causes prosociality?" is poorly defined. To make it precise, we must state a causal contrast on a well-defined feature of religion, specify measures of "prosociality" on which to assess effects, and clarify the target population for whom results are meant to generalise. Here, we contrast three hypothetical interventions on religious service attendance and examine their effects on three measures of prosociality across the population of New Zealand from 2018-2022. Study 1 investigates the effects on self-reported social behaviours;  Study 2 investigates effects on reported hours of help received from others; Study 3 investigates the effects of reported money received from others. The latter two measures avoid self-presentation bias. Each study finds evidence that religion supports pro-social behaviours However, magnitudes of benefit vary depending on the causal contrast of interest. Overall, both the gain and loss of regular religious service attendance have considerable economic consequences for charitable donations, whose "cash value" we compute. Collectively, these findings document the social consequences of religious behaviours and offer a blue-print quantitative causal investigations of the effects of cultural practices. 
author: 
  - name: Joseph A. Bulbulia
    affiliation: Victoria University of Wellington, New Zealand
    orcid_id: 0000-0002-5861-2056
    email: joseph.bulbulia@vuw.ac.nz
    corresponding: yes
  - name: Don E Davis
    affiliation: Georgia State University
    orcid_id: 0000-0003-3169-6576 
  - name: Ken Rice
    affiliation: Georgia State University 
  - name: Chris G. Sibley
    affiliation: School of Psychology, University of Auckland
    orcid_id: 0000-0002-4064-8800
  - name: Geoffrey Troughton
    affiliation: Victoria University of Wellington
    orcid_id: 0000-0001-7423-0640
keywords:
  - Causal Inference
  - Charity
  - Church
  - Cooperation
  - Religion
  - Shift Intervention
  - Volunteering
editor_options: 
  chunk_output_type: console
format:
  pdf:
    sanitise: true
    keep-tex: true
    link-citations: true
    colorlinks: true
    documentclass: article
    classoption: [single column]
    lof: false
    lot: false
    geometry:
      - top=30mm
      - left=20mm
      - heightrounded
    header-includes:
      - \input{/Users/joseph/GIT/latex/latex-for-quarto.tex}
date: last-modified
execute:
  echo: false
  warning: false
  include: true
  eval: true
fontfamily: libertinus
bibliography: /Users/joseph/GIT/templates/bib/references.bib
csl: /Users/joseph/GIT/templates/csl/camb-a.csl
---

```{r}
#| label: load-libraries
#| echo: false
#| include: false
#| eval: true

## WARNING SET THIS PATH TO YOUR DATA ON YOUR SECURE MACHINE. 
pull_path <-
  fs::path_expand(
    #"/Users/joseph/v-project\ Dropbox/Joseph\ Bulbulia/00Bulbulia\ Pubs/DATA/nzavs_refactor/nzavs_data_23"
    "/Users/joseph/Library/CloudStorage/Dropbox-v-project/Joseph\ Bulbulia/00Bulbulia\ Pubs/DATA/nzavs-current/r-data/nzavs_data_qs"
  )



push_mods <-  fs::path_expand(
  "/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/nzvs_mods/24/church-prosocial-v6"
)


#tinytext::tlmgr_update()

# WARNING:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI
#source("/Users/joseph/GIT/templates/functions/libs2.R")

library(margot)
library(ggplot2)
library(tidyverse)
library(gtsummary)
# # WARNING:  COMMENT THIS OUT. JB DOES THIS FOR WORKING WITHOUT WIFI
# source("/Users/joseph/GIT/templates/functions/funs.R")

# ALERT: UNCOMMENT THIS AND DOWNLOAD THE FUNCTIONS FROM JB's GITHUB
# source(
#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"
# )

# source(
#   "https://raw.githubusercontent.com/go-bayes/templates/main/functions/experimental_funs.R"
# )

# check path:is this correct?  check so you know you are not overwriting other directors
#push_mods

# for latex graphs
# for making graphs
library("tinytex")
library("extrafont")
library("tidyverse")
library("kableExtra")

loadfonts(device = "all")

## Read in data from analysis 
# imports
n_participants <-  margot::here_read("n_participants")
n_total <-  margot::here_read("n_total")

#n_participants
# read standard deviations units of outcome (volunteering/donations) in 2020
sd_donations <- margot::here_read("sd_donations")
sd_volunteer <- margot::here_read("sd_volunteer")

#conflicts_prefer(stats::filter)

# propensity score graph 

love_plot_base <- margot::here_read("love_plot_base")
love_plot <- margot::here_read("love_plot")
# love_plot

# # summary of matching
# summary_match_ebal_base <- margot::here_read("summary_match_ebal")
# # summary_match_ebal$summary_match_ebal_base
# 
# summary_match_ebal <- margot::here_read("summary_match_ebal")
# summary_match_ebal$effective.sample.size

# verify positivity 
#church
transition_table <- margot::here_read("transition_table")
#transition_table
# binary
transition_table_binary_gain <- margot::here_read("transition_table_binary_gain")
transition_table_binary_zero <- margot::here_read("transition_table_binary_zero")

#transition_table_binary
# 
# # ordinary regressions
fit_church_on_hours_charity<- margot::here_read('fit_church_on_hours_charity')
fit_church_on_charity_donate<-margot::here_read('fit_church_on_charity_donate')


# fit_church_on_community_time_binary<- margot::here_read('fit_church_on_community_time_binary')
# fit_church_on_community_money_binary<- margot::here_read('fit_church_on_community_money_binary')
library(gtsummary)
library(glue)

# lm_fit_church_on_hours_charity <- tbl_regression(fit_church_on_hours_charity)
# 
# # 
#b_church_on_hours_charity <-inline_text(lm_fit_church_on_hours_charity,
                                        # variable = religion_church_round,
                                        # pattern = "b = {estimate}; (95% CI {conf.low}, {conf.high})")
#b_church_on_hours_charity
# here_save(b_church_on_hours_charity, "b_church_on_hours_charity")

b_church_on_hours_charity<-margot::here_read("b_church_on_hours_charity")

# 
# 
#lm_coef_fit_church_on_charity_donate <- tbl_regression(fit_church_on_charity_donate)
#b_church_on_charity_donate <-inline_text(lm_coef_fit_church_on_charity_donate, variable = religion_church_round, pattern = "b = {estimate}; (95% CI {conf.low}, {conf.high})")
# # 
#b_church_on_charity_donate
#here_save(b_church_on_charity_donate, "b_church_on_charity_donate")
b_church_on_charity_donate<-margot::here_read("b_church_on_charity_donate")
#b_church_on_charity_donate

#push_mods
# # lm_coef_fit_church_on_community_time_binary <- tbl-regression(fit_church_on_community_time_binary)
# # b_church_on_community_time_binary <-inline_text(lm_coef_fit_church_on_community_time_binary, variable = religion_church_round, pattern = "b = {estimate}; (95% CI {conf.low}, {conf.high})")
# # 
# # here_save(b_church_on_community_time_binary, "b_church_on_community_time_binary")
# b_church_on_community_time_binary<-margot::here_read("b_church_on_community_time_binary")
# #b_church_on_community_time_binary
# 
# # lm_coef_fit_church_on_community_money_binary <- tbl-regression(fit_church_on_community_money_binary)
# # b_church_on_community_money_binary <-inline_text(lm_coef_fit_church_on_community_money_binary, variable = religion_church_round, pattern = "b = {estimate}; (95% CI {conf.low}, {conf.high})")
# # 
# # here_save(b_church_on_community_money_binary, "b_church_on_community_money_binary")
# b_church_on_community_money_binary<-margot::here_read("b_church_on_community_money_binary")
# 

library(margot)
library(glue)
# works but not used
#testlm_coef_church_on_donate <- glue("b = {fit_church_on_donate_x[2, 1]}, SE = {fit_church_on_donate_x[2, 3]}")
# not this table is too long in most instance 
# table_baseline<-margot::here_read("table_baseline")

# baseline
table_baseline <-margot::here_read("table_baseline")

table_exposures <-margot::here_read("table_exposures")

table_outcomes <-margot::here_read("table_outcomes")

# density of the exposure 
graph_density_of_exposure_up<-margot::here_read("graph_density_of_exposure_up")
graph_density_of_exposure_down<-margot::here_read("graph_density_of_exposure_down")



# examples
mean_volunteer <- margot::here_read("mean_volunteer")

# sample mean at end of study (won't be population mean)
mean_donations <- margot::here_read("mean_donations")


# import models

# population mean
t2_charity_donate_z_null <- here_read("t2_charity_donate_z_null")

# individual models
t2_charity_donate_z_zero <- here_read("t2_charity_donate_z_zero")
t2_charity_donate_z_gain <- here_read("t2_charity_donate_z_gain")
t2_hours_charity_z_gain <-  here_read("t2_hours_charity_z_gain")
t2_hours_charity_z_zero <- here_read("t2_hours_charity_z_zero")
t2_hours_charity_z_null<- here_read("t2_hours_charity_z_null")




# results
# import to manuscript -------------------------------------------------------

tab_all_prosocial <- here_read("tab_all_prosocial")
tab_all_prosocial_null <- here_read("tab_all_prosocial_null")
tab_all_prosocial_null_zero <- here_read("tab_all_prosocial_null_zero")
tab_all_prosocial
tab_all_prosocial_null
tab_all_prosocial_null_zero


group_tab_all_prosocial<- here_read("group_tab_all_prosocial")
group_tab_all_prosocial_null<- here_read("group_tab_all_prosocial_null")
group_tab_all_prosocial_null_zero<- here_read("group_tab_all_prosocial_null_zero")

group_tab_all_prosocial
group_tab_all_prosocial_null
group_tab_all_prosocial_null_zero
# # 
# tab_all_prosocial_rr <- here_read("tab_all_prosocial_rr")
# group_tab_all_prosocial_rr <- here_read("group_tab_all_prosocial_rr")

# tab_all_perceived_support <- here_read("tab_all_perceived_support")
# tab_all_perceived_support_null <- here_read("tab_all_perceived_support_null")
# tab_all_perceived_support_null_zero <- here_read("tab_all_perceived_support_null_zero")
# tab_all_perceived_support
# tab_all_perceived_support_null
# tab_all_perceived_support_null_zero

# group_tab_all_perceived_support <- here_read("group_tab_all_perceived_support")
# group_tab_all_perceived_support_null <- here_read("group_tab_all_perceived_support_null")
# group_tab_all_perceived_support_null_zero <- here_read("group_tab_all_perceived_support_null_zero")
# group_tab_all_perceived_support
# group_tab_all_perceived_support_null
# group_tab_all_perceived_support_null_zero

tab_all_received_money <- here_read( "tab_all_received_money")
tab_all_received_money_null <- here_read( "tab_all_received_money_null")
tab_all_received_money_null_zero <- here_read( "tab_all_received_money_null_zero")
# tab_all_received_money
# tab_all_received_money_null
# tab_all_received_money_null_zero

group_tab_all_received_money <- here_read( "group_tab_all_received_money")
group_tab_all_received_money_null <- here_read( "group_tab_all_received_money_null")
group_tab_all_received_money_null_zero <- here_read( "group_tab_all_received_money_null_zero")
# group_tab_all_received_money
# group_tab_all_received_money_null
# group_tab_all_received_money_null_zero

tab_contrast_received_time <- here_read( "tab_contrast_received_time")
tab_contrast_received_time_null <- here_read( "tab_contrast_received_time_null")
tab_contrast_received_time_null_zero <- here_read( "tab_contrast_received_time_null_zero")
# tab_contrast_received_time
# tab_contrast_received_time_null
# tab_contrast_received_time_null_zero


group_tab_contrast_received_time <- here_read( "group_tab_contrast_received_time")
group_tab_contrast_received_time_null <- here_read( "group_tab_contrast_received_time_null")
group_tab_contrast_received_time_null_zero <- here_read( "group_tab_contrast_received_time_null_zero")
# group_tab_contrast_received_time
# group_tab_contrast_received_time_null
# group_tab_contrast_received_time_null_zero


# graphs ------------------------------------------------------------------
title = "Weekly Religious Service vs No Religious Service"
title_null = "Weekly Religious Service vs Status Quo"
title_null_zero = "No Religious Service vs Status Quo"
# 
# 
# plot_group_tab_all_prosocial <- margot_plot(
#   group_tab_all_prosocial,
#   type = "RD",
#   title = title,
#   subtitle = "Self-Reported Prosociality",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = -.5,
#   x_lim_lo = -.5,
#   x_lim_hi =  .5
# )
# 
# plot_group_tab_all_prosocial

# regression scale
# (sd_donations * .173)
# (sd_volunteer * .091)
# .37 * 60
# 
# ggsave(
#   plot_group_tab_all_prosocial,
#   path = here::here(here::here(push_mods)),
#   width = 16,
#   height = 9,
#   units = "in",
#   filename = "plot_group_tab_all_prosocial.png",
#   device = 'png',
#   limitsize = FALSE,
#   dpi = 300
# )

# # # null 
# plot_group_tab_all_prosocial_null <- margot_plot(
#   group_tab_all_prosocial_null,
#   type = "RD",
#   title = title_null,
#   subtitle = "Self-Reported Prosociality",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = -.5,
#   x_lim_lo = -.5,
#   x_lim_hi =  .5
# )
# 
# plot_group_tab_all_prosocial_null
# 
# #( sd_donations * .096) / 4

# 
# plot_group_tab_all_prosocial_null_zero <- margot_plot(
#   group_tab_all_prosocial_null_zero,
#   type = "RD",
#   title = title_null_zero,
#   subtitle = "Self-Reported Prosociality",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = -.5,
#   x_lim_lo = -.5,
#   x_lim_hi =  .5
# )
# 
# plot_group_tab_all_prosocial_null_zero
# 
# ( sd_donations * -.022) 
# 
# ( sd_volunteer * -.077) 
# 
# (.31 * 60) 
# 
# plot_group_tab_all_perceived_support <- margot_plot(
#   group_tab_all_perceived_support,
#   type = "RD",
#   title = title,  
#   subtitle = "Perceived Social Support",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = -.5,
#   x_lim_lo = -.5,
#   x_lim_hi =  .5
# )
# plot_group_tab_all_perceived_support
# 
# plot_group_tab_all_perceived_support_null <- margot_plot(
#   group_tab_all_perceived_support_null,
#   type = "RD",
#   title = title_null,
#   subtitle = "Perceived Social Support",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = -.5,
#   x_lim_lo = -.5,
#   x_lim_hi =  .5
# )
# plot_group_tab_all_perceived_support_null
# ggsave(
#   plot_group_tab_all_perceived_support_null,
#   path = here::here(here::here(push_mods)),
#   width = 16,
#   height = 9,
#   units = "in",
#   filename = "plot_group_tab_all_perceived_support_null.png",
#   device = 'png',
#   limitsize = FALSE,
#   dpi = 300
# )
# 
# 
# 
# plot_group_tab_all_perceived_support_null_zero <- margot_plot(
#   group_tab_all_perceived_support_null_zero,
#   type = "RD",
#   title = title_null_zero,
#   subtitle = "Perceived Social Support",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = -.5,
#   x_lim_lo = -.5,
#   x_lim_hi =  .5
# )
# plot_group_tab_all_perceived_support_null_zero


# plot_group_tab_all_received_time <- margot_plot(
#   group_tab_contrast_received_time,
#   type = "RR",
#   title = title,
#   subtitle = "Support Received From Others: Time",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = 0,
#   x_lim_lo = 0,
#   x_lim_hi =  4
# )
# 
# plot_group_tab_all_received_time
# # 
# 
# ggsave(
#   plot_group_tab_all_received_time,
#   path = here::here(here::here(push_mods)),
#   width = 16,
#   height = 9,
#   units = "in",
#   filename = "plot_group_tab_all_received_time.png",
#   device = 'png',
#   limitsize = FALSE,
#   dpi = 300
# )
# 
# 
# 
# plot_group_tab_all_received_time_null <- margot_plot(
#   group_tab_contrast_received_time_null,
#   type = "RR",
#   title = title_null,
#   subtitle = "Support Received From Others: Time",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = 0,
#   x_lim_lo = 0,
#   x_lim_hi =  4
# )
# 
# plot_group_tab_all_received_time_null
# 
# 
# plot_group_tab_all_received_time_null_zero <- margot_plot(
#   group_tab_contrast_received_time_null_zero,
#   type = "RR",
#   title = title_null_zero,
#   subtitle = "Support Received From Others: Time",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = 0,
#   x_lim_lo = 0,
#   x_lim_hi =  4
# )
# 
# plot_group_tab_all_received_time_null_zero
# 
# # 
# # 
# # ggsave(
# #   plot_group_tab_all_received_time_null,
# #   path = here::here(here::here(push_mods)),
# #   width = 16,
# #   height = 9,
# #   units = "in",
# #   filename = "plot_group_tab_all_received_time_null.png",
# #   device = 'png',
# #   limitsize = FALSE,
# #   dpi = 300
# # )
# 
# 
# 
# plot_group_tab_all_received_money <- margot_plot(
#   group_tab_all_received_money,
#   type = "RR",
#   title = title,  
#   subtitle = "Support Received From Others: Money",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = 0,
#   x_lim_lo = 0,
#   x_lim_hi =  4
# )
# plot_group_tab_all_received_money
# #plot_group_tab_all_received_money
# # ggsave(
# #   plot_group_tab_all_received_money,
# #   path = here::here(here::here(push_mods)),
# #   width = 16,
# #   height = 9,
# #   units = "in",
# #   filename = "plot_group_tab_all_received_money.png",
# #   device = 'png',
# #   limitsize = FALSE,
# #   dpi = 300
# # )
# plot_group_tab_all_received_money_null <- margot_plot(
#   group_tab_all_received_money_null,
#   type = "RR",
#   title = title_null,
#   subtitle = "Support Received From Others: Money",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = 0,
#   x_lim_lo = 0,
#   x_lim_hi =  4
# )
# plot_group_tab_all_received_money_null
# 
# plot_group_tab_all_received_money_null_zero <- margot_plot(
#   group_tab_all_received_money_null_zero,
#   type = "RR",
#   title = title_null_zero,
#   subtitle = "Support Received From Others: Money",
#   xlab = "",
#   ylab = "",
#   estimate_scale = 1,
#   base_size = 18,
#   text_size = 4.5,
#   point_size = 3.5,
#   title_size = 18,
#   subtitle_size = 16,
#   legend_text_size = 10,
#   legend_title_size = 10,
#   x_offset = 0,
#   x_lim_lo = 0,
#   x_lim_hi =  4
# )
# plot_group_tab_all_received_money_null_zero

# 
# ggsave(
#   plot_group_tab_all_received_money_null,
#   path = here::here(here::here(push_mods)),
#   width = 16,
#   height = 9,
#   units = "in",
#   filename = "plot_group_tab_all_received_money_null.png",
#   device = 'png',
#   limitsize = FALSE,
#   dpi = 300
# )
# 



```


## Introduction


A central question in the scientific study of religion is whether religion causes cooperation. However, to address this question is challenging. Most features of religion are inaccessible to experiments. Yet to obtain valid causal inferences from non-experimental data requires a combination of high-resolution time-series data and robust causal inferential methods. Few studies that combine these features.  (see @kelly2024religiosity, although for indirect causal evidence see @sosis2003cooperation; for an appropriately designed observational study of religious service on mental health, a different topic, see @chen2020religious).

Equally fundamental, the question: "does religion cause prosociality?" is poorly defined. To make this question precise, we must state a causal contrasts of interest, state specific measures of "prosociality" to be evaluated, and define the target population for whom results are meant to generalise (@hernan2024WHATIF; @ogburn2021; @bulbulia2022). 

Here, we leverage comprehensive panel data from `r n_participants` who participated in the New Zealand Attitudes and Values Study from 2018-2021 and investigate the effects of well-defined population-level shifts in religious attendance across three measurement domains of pro-sociality. 

Following the Neyman-Rubin causal model, we define causal effects as quantitative contrasts of potential outcomes under different treatments regimes in a target population [@rubin2005; @neyman1923]. 

The first causal contrast asks:  "what would be difference on average across the population of New Zealand if everyone attended religious service regularly (defined as at least four times per month) compared with if no one ever attended religious service?" This question holds theoretical interest. It is akin to a hypothetical experiment in which everyone is randomly assigned eiether to regular or zero-attendance condition. 

The second causal contrast asks:  "what would be difference on average across the population of New Zealand if everyone  attended religious service regularly compared with the status quo?"  Notice that this causal contrast does not require shifting those people who regularly attend religious services to zero attendance. This causal question clarifies the implications of policies that target the behaviours of those who do not attend regular religious service.

The second causal contrast asks:  "what would be difference on average across the population of New Zealand if no one attended religious service at all compared with the status quo?" Here the potential outcomes of interest do not require shifting who never attend religious service. This causal question clarifies the implications of policies that target the behaviours of those who attend regular religious service. 

Note that there are inumerably many causal contrasts we mind consider. Those that we consider here give insights into the distinct effect of loss and gain of religious behaviour on society-wide averages of prosociality, defined by the indicators presented below. 

## Method

### Sample

Data were collected as part of The New Zealand Attitudes and Values Study (NZAVS), an annual longitudinal national probability panel study of social attitudes, personality, ideology and health outcomes in New Zealand. Chris G. Sibley started the NZAVS in 2009. It has since grown to a community of over fifty researchers. Since its inception, the NZAVS has collected questionnaire responses from `r n_total` New Zealand residents. The NZAVS is university-based, not-for-profit and independent of political or corporate funding; see https://doi.org/10.17605/OSF.IO/75SNB.  Sample descriptive information for this study are given in Appendices B-D.

### Measures of prosociality

There are two self-reported measures of prosocial behaviour in the NZAVS:

**Study 1. Self-reported charity** as measured by:

(a) self-reported hours of weekly volunteering; 
(b) self-reported annual financial donations (dollars);

**Study 2: Reported help received in hours** in the previous week from:

(a) family (coded: yes/no) 
(b) friends (coded: yes/no)
(c) community (coded: yes/no)

**Study 3: Reported financial help received in dollars** in the previous week from:

(a) family (coded: yes/no) 
(b) friends (coded: yes/no)
(c) community (coded: yes/no)

Details about all measures are provided in *Appendix A.* 


Studies 2 and 3 minimise self-presentation bias by using individuals as measures of prosocial outcomes based on the following assumption: if religious service attendance induced greater within-group prosociality, then regular religious service attendance would increase prosocial exposures. Self-reported dependency are robust to directed self-presentation bias that might induce the appearance of a causal association between religious service attendance and prosocial behaviour.


### Causal Contrasts


The contrasts of interest in this study take the form of longitudinal modified treatment policies. To precisely state these policies, let $A$  denote the intervention of interest monthly frequency of religious service. Our treatment policies evaluate interventions that take the form of differing shift functions $f(A)$:

$$
d(A) = 
\begin{cases} 
a, & \text{where } a \text{ is the observed value.}\\
a^* = 4, & \text{if } a < 4 \times \text{monthly religious service attendance; otherwise, } a^* = a.\\
a' = 0, & \text{if } a > 0 \text{ and monthly religious service attendance is positive; otherwise, } a' = a. 
\end{cases}
$$

where,

- **for $d(A=a)$**: the observed value of $a$ remains unchanged. Estimation is performed for the observed value.
  
- **for $d(A =a^*)$**: $a^* = 4$ if the observed value of $a$ is less than four times the monthly religious service attendance. If the observed value of $a$ is four or greater, no intervention is performed, and $a^*$ equals $a$. This function enforces a minimum threshold for religious attendance at four but allows those who meet or exceed this threshold to remain unchanged.
  
- **for $a^\prime$**: this condition modifies $a$ to $a' = 0$ when the observed value of $a$ is greater than 0, thus setting all values of religious attendance to 0 if they are not already at 0. Again, the intervention only applies to those who attend religious services at any frequency.

We next formulate our causal contrasts precisely. Let $Y(\bar{a})$ denote a potential outcome at the end of the study under the treatment rule $d(A)$. In this three-wave panel study, we consider two intervention intervals, one at baseline and one at the baseline + 1 wave. Outcomes are subsequently assessed in the baseline + 2 wave. $L$ denotes the set of measured covariates we assume sufficient for confounding control. Measurements of $L$ are obtained from the baseline wave. Because causes precede effects, panel data allow us to order measurements such that confounders $L$ preceded causes $A$ and causes $A$ precede effects $Y$. 

1. Our first causal question asks: "What would be the social consequences one year after an intervention in which everyone attended religious service for two years compared with an intervention in which no one attended religious service for two years?" For continuous outcomes, we compute the causal contrast from this longitudinal modified treatment policy (LMTP) on the difference scale as:

$$ \text{LMTP: ALL GAIN vs ALL LOSS} = E[Y(a*,a*)|\textcolor{red}{d(A)},L] - E[Y(a^\prime,a^\prime)|\textcolor{red}{d(A)},L] $$

Again this causal question reflects a classical theoretical interest in which we compare the population estimates with everyone attending regularly vs the population estimates with no one attending regularly on each measurement domain of interest. 


2. Our second causal question asks: "What would be the social consequences if everyone who was not attending weekly religious service in New Zealand were to do so?"  The contrast conditions for this estimand are given by (a) regular religious service attendance and (b) the status quo, which can be written on the difference scale:

$$  \text{LMTP: ALL GAIN vs. STATUS QUO}  = E[Y(a*,a*)|\textcolor{red}{d(A)},L] - E[Y(a,a)|\textcolor{red}{d(A)},L] $$

Again this causal question reflects a practical interest in comparing the population estimates with everyone attending regularly vs the population at its status quo on each measurement domain of interest. The question helps us understand the implications of promoting religious service attendance.



2. Our third causal question asks: "What would be the social consequences if everyone attending weekly religious service in New Zealand were to stop?"  The contrast conditions for this estimand are given by (a) no religious service attendance and (b) the status quo, which can be written on the difference scale:


$$ \text{LMTP: ALL LOSS vs. STATUS QUO}  = E[Y(a^\prime,a^\prime)|\textcolor{red}{d(A)},L] - E[Y(a,a)|\textcolor{red}{d(A)},L] $$

This contrast allows us to evaluate the social effects of a policy that promoted the society-wide loss of religious service attendance in the contemporary population. In the case of New Zealand, where religious service is on the decline, we may use this quantity to clarify the social consequences of failing to prevent loss.


### Identification assumptions

To obtain valid causal effect estimates, we must satisfy three identification assumptions.

1.  **Causal consistency**: each outcome observed in the data corresponds to at least one of the potential outcomes to be contrasted []. Moreover, multiple treatment versions must be independent of the potential outcomes conditional on measured covariates []. 

2.  **Conditional exchangeability**: given the observed covariates, treatment assignment is independent of the potential outcomes under consideration. Put differently, our statistical models obtain balance in confounding covariates across the treatments of interest.

To improve the credibility of this assumption, we conduct analysis using semi-parametric doubly robust estimators, as explained below.

3.  **Positivity**: every subject has a non-zero probability of receiving each treatment to be compared. Below, we evaluate the positivity assumption by reporting the number of instances in which individuals transitioned from one state of religious service in the baseline wave to another in the treatment wave.  


### Target Population 

The target population is the population of New Zealand at the baseline wave (years 2018-2019). The New Zealand Attitudes and Values Study is a national probability study with a good representation of the New Zealand population. However, its coverage is not perfect. For example, the study under-samples males and Asians and over-samples women and Māori (New Zealand's indigenous peoples). Therefore, we pass New Zealand Census survey weights when computing marginal treatment effects; in this study we weighted the sample to age, gender and ethnicity. Methods for these weights are described in [].



### Eligibility criteria 

-   Enrolled in the New Zealand Attitudes and Values Study in 2018 (NZAVS time 10).
-   No missing data about religious service attendance at baseline (NZAVS time 10)
-   Missing data for all variables at baseline were allowed and imputed using the `ppm` algorithm from the `mice` package [@vanbuuren2018].
-   Attrition/loss to follow-up was permitted. Targeted learning models that compute censoring weights were calculated as part of estimation in `lmtp` to adjust for missing outcomes at NZAVS Time 12 (years 2020-2021, the outcome wave). See details of the `lmtp` package [@williams2021])

There were `r n_participants` who met these criteria.


### Confounding control

We use @vanderweele2020 *modified disjunctive cause criterion* in which we (1) identified all common causes of the treatment and outcomes; (2) removed any variables identified that might influence the exposure but not the outcome -- instrumental variables -- because instrumental variables are known to reduce efficiency; (3) included proxies for any unmeasured variables affecting both exposure and outcome -- including instrumental variables, because by the rules of d-separation, conditioning on a proxy is akin to conditioning on its parent (in this case, a confounder) (4) **control for baseline exposure** and (5) **control for baseline outcome** Both serve as proxies for unmeasured common causes [@vanderweele2020]. Note that our shift interventions obtain controlled effects for baseline treatment and exposure wave treatment, with the naturally observed treatment levels being explicitly modelled from the data, see [] for details. 



#### Sensitivity Analysis Using the E-value

To assess the sensitivity of results to unmeasured confounding, we report VanderWeele and Ding's "E-value" in all analyses [@vanderweele2017]. The E-value quantifies the minimum strength of association (on the risk ratio scale) that an unmeasured confounder would need to have with both the exposure and the outcome (after considering the measured covariates) to explain away the observed exposure-outcome association [@vanderweele2020; @linden2020EVALUE]. To evaluate the strength of evidence, we use the bound of the E-value 95% confidence interval closest to 1.

### Analytic Approach

<!-- We use a Sequentially Doubly-Robust (SDR) estimator designed for the analysis of longitudinal data within causal inference frameworks [@díaz2021]. The estimator is grounded in the principles of robust semi-parametric statistics and is characterised first by its sequential approach to handling time-varying treatments and outcomes, and secondly by its double robustness property. -->

<!-- Fundamentally, the SDR estimator operates by iteratively regressing pseudo-outcomes on observed treatments and covariates at each time point, starting from the end of the observation period and proceeding backwards. This iterative process employs the concept of pseudo-outcomes, which are updated at each step based on the outcome of the regression, incorporating information from both the treatment mechanism and the outcome model. -->

<!-- A key feature of the SDR estimator is its 'multiply robust' property, implying that the estimator remains consistent if, for each time point, either the model for the treatment assignment or the model for the outcome, conditional on past treatments and covariates, is correctly specified. This property significantly enhances the estimator's applicability to real-world scenarios such as ours, where model misspecification is a common challenge. Furthermore, the marriage of SDR and machine learning reduces the dependence of inference on restrictive modelling assumptions and introduces an additional layer of robustness. For further details see [@hoffman2022; @hoffman2023; @díaz2021]. Estimation was performed using the `lmtp` package [@williams2021].  -->


We employ a semi-parametric Targeted Learning, specifically Targeted Minimum Loss-based Estimation (TMLE) estimator. TMLE is a robust method that combines machine learning techniques with traditional statistical models to estimate causal effects while providing valid statistical uncertainty measures for these estimates.

TMLE operates through a two-step process involving both the outcome and treatment (exposure) models. Initially, it employs machine learning algorithms to flexibly model the relationship between treatments, covariates, and outcomes. This flexibility allows TMLE to account for complex, high-dimensional covariate spaces without imposing restrictive model assumptions. The outcome of this step is a set of initial estimates for these relationships.

The second step of TMLE involves "targeting" these initial estimates by incorporating information about the observed data distribution to improve the accuracy of the causal effect estimate. This is achieved through an iterative updating process, which adjusts the initial estimates towards the true causal effect. This updating process is guided by the efficient influence function, ensuring that the final TMLE estimate is as close as possible, given the measures and data to the true causal effect, while still being robust to model misspecification in either the outcome model or the treatment model.

Again, a central feature of TMLE is its double-robustness property. This means that if either the model for the treatment or the outcome is correctly specified, the TMLE estimator will still consistently estimate the causal effect. Additionally, TMLE uses cross-validation to avoid over-fitting and ensure that the estimator performs well in finite samples. Each step contributes to a robust methodology for examining the *causal* effects of interventions on outcomes. The marriage of TMLE and machine learning technologies reduces the dependence on restrictive modelling assumptions and introduces an additional layer of robustness. For further details see [@hoffman2022; @hoffman2023; @díaz2021]. We performed estimation using the `lmtp` package [@williams2021]. We used the `superlearner` library for non-parametric estimation with the predefined libraries `SL.ranger`, `SL.glmnet`, and `SL.xboost`. Graphs, tables and output reports were created using the `margot` package [@margot2024]. All analysis methods follow pre-stated protocols in @bulbulia2024PRACTICAL. 


{{< pagebreak >}}

@tbl-identification presents our strategy for confounding control. 

::: {#tbl-identification}

```{=latex}
\lmtp table
```
Identification strategy
:::


<!-- ```{tikz} -->
<!-- #| label: fig-outcome wide-dag -->
<!-- #| fig-cap: "Causal graph: three-wave panel design with selection bias. By controlling for confounding at baseline we block back-door paths that might lead to an association between the treatment and the outcome. Adding previous measurements of the exposure and outcome at baseline further reduces confounding. Nevertheless, because we cannot ensure all confounding paths have been blocked, we perform sensitivity analysis. These allow us to ask how strong the unmeasured confounder needs to be in its association with the treatment and the outcome to explain away the observed association." -->
<!-- #| out-width: 80% -->
<!-- #| echo: false -->
<!-- #| include: true -->
<!-- #| eval: true -->
<!-- #| fig-height: 8 -->

<!-- \usetikzlibrary{positioning} -->
<!-- \usetikzlibrary{shapes.geometric} -->
<!-- \usetikzlibrary{arrows} -->
<!-- \usetikzlibrary{decorations} -->
<!-- \tikzstyle{Arrow} = [->, thin, preaction = {decorate}] -->
<!-- \tikzset{>=latex} -->
<!-- % Define a simple decoration -->
<!-- \tikzstyle{cor} = [-, dotted, preaction = {decorate}] -->

<!-- \begin{tikzpicture}[{every node/.append style}=draw] -->

<!-- \node [rectangle, draw=white] (U) at (0, 0) {U}; -->
<!-- \node [rectangle, draw=black](C1) at (0, -1) {C}; -->
<!-- \node [rectangle, draw=black, align=left] (L) at (2, 0) {L$_{t0}$ \\A$_{t0}$ \\Y$_{t0}$}; -->
<!-- \node [rectangle, draw=white] (A) at (4, 0) {A$_{t1}$}; -->
<!-- \node [ellipse, draw=white] (US) at (0, -2) {U}; -->
<!-- \node [rectangle, draw=black](C2) at (6, 0) {C}; -->
<!-- \node [ellipse, draw=white] (Y) at (8, 0) {Y$_{t2}$}; -->

<!-- \draw [-latex, draw=black] (U) to (L); -->
<!-- \draw [-latex, draw=black] (L) to (A); -->
<!-- \draw [-latex, bend left=50, draw=black] (L) to (Y); -->
<!-- \draw [-latex, bend right=50, draw=black, dotted] (U) to (Y); -->
<!-- \draw [-latex, bend left=50, draw=black, dotted] (U) to (A); -->
<!-- \draw [-latex, draw=black] (A) to (C2); -->
<!-- draw [-latex, draw=black] (US) to (C1); -->
<!-- \draw [-latex, draw=black] (US) to (C2); -->
<!-- \draw [-latex, draw=black] (US) to (Y); -->
<!-- \draw [-latex, bend left = 40, draw=red, dashed] (A) to (Y); -->
<!-- \draw [cor, draw=red, bend right=20, dashed] (A) to (US); -->

<!-- \end{tikzpicture} -->


<!-- ``` -->



### Scope of Interventions

To better understand the scope of the interventions to be contrasted, we recommend presenting histograms showing treatment instances. The following presents responses from baseline + 1 wave. 

The All-GAIN intervention $d(A=a^*)$ intervention is shown in @fig-0up


```{r}
#| label: fig-0up
#| fig-cap: "Figure shows a histogram of responses to religious service frequency in the baseline + 1 wave. Responses above eight were assigned to eight and values were rounded to the nearest whole number. The red dashed line shows the population average. All responses in the gold bars are shifted to four on the ALL-GAIN intervention. All those responses in grey (four and above) remain unchanged"
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

graph_density_of_exposure_up <- margot::here_read("graph_density_of_exposure_up")
graph_density_of_exposure_up
```



Notably, the ALL-GAIN intervention requires shifting a considerable mass of the sample population. However, it does not require shifting those who are attending religious service more frequently that four times per month.



The All-LOSS intervention $d(A=a^\prime)$ intervention is shown in @fig-0down

```{r}
#| label: fig-0down
#| fig-cap: "Figure shows a histogram of responses to religious service frequency in the baseline + 1 wave. Responses above eight were assigned to eight, and values were rounded to the nearest whole number. The red dashed line shows the population average. All responses in the blue bars are shifted to zero on the ALL-LOSS intervention. All those responses in grey (zero) remain unchanged"
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6


graph_density_of_exposure_down <- margot::here_read("graph_density_of_exposure_down")
graph_density_of_exposure_down
```


Notably, the ALL-LOSS intervention requires shifting a smaller proportion of the sample population than the ALL-GAIN intervention. Because religious service is declining in New Zealand, this intervention holds more policy interest: the implications of loss are relevant to a society where loss is occurring.



### Evidence for Change in the Treatment Variable

@tbl-transition clarifies the change in the treatment variable from the baseline wave to the baseline + 1 wave across the sample.  Assessing change in a variable is essential for evaluating the positivity assumption and for recovering evidence for the incidence-effect of the treatment variable [].  

```{r}
#| label: tbl-placeholder
#| eval: false
#| echo: false

transition_table <- margot::here_read("transition_table")
```

|  From   |  State 0  | State 1 | State 2 | State 3 | State 4 | State 5 | State 6 | State 7 | State 8 |
|:-------:|:---------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|
| State 0 | **26762** |   405   |   174   |   71    |   126   |   26    |   13    |    8    |   68    |
| State 1 |    647    | **235** |   85    |   44    |   46    |    5    |    2    |    3    |   10    |
| State 2 |    236    |   105   | **188** |   104   |   96    |   12    |   13    |    2    |   21    |
| State 3 |    112    |   54    |   110   | **164** |   173   |   18    |    8    |    4    |   15    |
| State 4 |    150    |   71    |   127   |   205   | **881** |   124   |   64    |   16    |   91    |
| State 5 |    24     |    7    |   17    |   17    |   145   | **61**  |   25    |    7    |   33    |
| State 6 |    14     |    5    |   13    |   17    |   84    |   22    | **29**  |    5    |   37    |
| State 7 |     9     |    0    |    6    |    3    |   16    |    6    |    9    |  **6**  |   19    |
| State 8 |    74     |   14    |   17    |   14    |   105   |   34    |   42    |   17    | **351** |



: This transition matrix captures shifts in states across two waves—baseline and treatment—for individuals under study. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the state at baseline (From), and the columns correspond to the state at the treatment wave (To). **Diagonal entries** (in **bold**): these signify the number of individuals who remained in their initial state across both waves. **Off-diagonal entries**: these signify the transitions of individuals from their baseline state to a different state in the treatment wave. A higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more significant shifts from the baseline state to other states. {#tbl-transition}


@tbl-tbl-transition presents state change between the first and second wave in religious service frequency.  We find that state 4 (weekly attendance) and state 0 present the highest overall. However, we also find that movement between these states, revealing they are not deterministic.  States 1, 2, 3, and 5 indicate relatively frequent movement in and out of these states, suggesting lower stability in these conditions.



{{< pagebreak >}}


## Results

## Study 1: Causal Effects of Regular Church Attendance on Self-Reported Volunteering and Self-Reported Volunteering and Donations

@fig-1_1 and @tbl-1_1 present results for the ALL-GAIN vs. ALL-LOSS treatment policy on self-reported volunteering and charitable donations


```{r}
#| label: fig-1_1
#| fig-cap: "This figure reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs universal loss of weekly religious service on reported charitable behaviours at the end of the study. Outcomes are expressed in standard deviation units."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

plot_group_tab_all_prosocial <- margot::margot_plot(
  group_tab_all_prosocial,
  type = "RD",
  title = title,
  subtitle = "Self-Reported Prosociality",
  estimate_scale = 3,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -1.5,
  x_lim_hi =  .5
)

plot_group_tab_all_prosocial
```

```{r}
#| label: tbl-1_1
#| tbl-cap: "This table reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs universal loss of weekly religious service on reported charitable behaviours at the end of the study. Outcomes are expressed in standard deviation units."
#| eval: true
#| include: true
#| echo: false

tab_all_prosocial |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
#margot_interpret_table(group_tab_all_prosocial, "causal_difference", "lmtp")

# t2_charity_donate_z_gain<- here_read("t2_charity_donate_z_gain")
# 
# round( ( sd_donations * tab_all_prosocial[1,1]), 2)
```

The Longitudinal Modified Treatment Policy (LMTP) calculates the expected outcome difference between treatment and contrast groups for a specified population, focusing on longitudinal data.

For 'donations', the effect estimate is 0.173 [0.097, 0.25]. The E-value for this estimate is 1.617 with a lower bound of 1.409. Given all modelled covariates, an unmeasured confounder would need a minimum association strength with both the treatment and outcome of 1.409 to nullify the observed effect. Weaker associations would not overturn it. We infer **Evidence for causality**.

On the data scale, this intervention represents a difference of NZD `r round( ( sd_donations * tab_all_prosocial[1,1]), 2)` per adult per year in charitable giving.


For 'hours volunteer', the effect estimate is 0.091 [-0.042, 0.223]. The E-value for this estimate is 1.393 with a lower bound of 1. Given all modelled covariates, an unmeasured confounder would need a minimum association strength with both the treatment and outcome of 1 to nullify the observed effect. Weaker associations would not overturn it. We infer  **Evidence for causality is not reliable**.



{{< pagebreak >}}

@fig-1_2 and @tbl-1_2 present results for the ALL-GAIN vs. STATUS QUO treatment policy on self-reported volunteering and charitable donations

```{r}
#| label: fig-1_2
#| fig-cap: "This figure reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs status quo on reported charitable behaviours at the end of the study. Outcomes are expressed in standard deviation units."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

plot_group_tab_all_prosocial_null <- margot_plot(
  group_tab_all_prosocial_null,
  type = "RD",
  title = title_null,
  subtitle = "Self-Reported Prosociality",
  estimate_scale = 3,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -1.5,
  x_lim_hi =  .5
)

plot_group_tab_all_prosocial_null
```



```{r}
#| label: tbl-1_2
#| tbl-cap: "Table reports results of model estimates for the causal effects of a universal gain of weekly religious service vs status quo on reported charitable behaviours at the end of the study. Outcomes are expressed in standard deviation units."
#| eval: true
#| include: true
#| echo: false

library(tidyverse)
library(margot)
tab_all_prosocial_null |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_all_prosocial_null, "causal_difference", "lmtp")

#round( ( sd_donations * tab_all_prosocial_null[1,1]), 2)

```

The Longitudinal Modified Treatment Policy (LMTP) calculates the expected outcome difference between treatment and contrast groups for a specified population, focusing on longitudinal data.

For 'donations', the effect estimate is 0.131 [0.058, 0.205]. The E-value for this estimate is 1.504 with a lower bound of 1.295. Given all modelled covariates, an unmeasured confounder would need a minimum association strength with both the treatment and outcome of 1.295 to nullify the observed effect. Weaker associations would not overturn it. We infer **Evidence for causality**.

On the data scale, this intervention represents a difference of NZD `r round( ( sd_donations * tab_all_prosocial_null[1,1]), 2)` per adult per year in charitable giving.


For 'hours volunteer', the effect estimate is 0.069 [-0.06, 0.199]. The E-value for this estimate is 1.327 with a lower bound of 1. Given all modelled covariates, an unmeasured confounder would need a minimum association strength with both the treatment and outcome of 1 to nullify the observed effect. Weaker associations would not overturn it. We infer **Evidence for causality is not reliable**.



{{< pagebreak >}}

```{r}
#| label: fig-1_3
#| fig-cap: "Figure reports results of model estimates for the causal effects of a universal loss of weekly religious service vs status quo on reported charitable behaviours at the end of the study. Outcomes are expressed in standard deviation units."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

plot_group_tab_all_prosocial_null_zero <- margot_plot(
  group_tab_all_prosocial_null_zero,
  type = "RD",
  title = title_null_zero,
  subtitle = "Self-Reported Prosociality",
  estimate_scale = 3,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -1.5,
  x_lim_hi =  .5
)

plot_group_tab_all_prosocial_null_zero
```



```{r}
#| label: tbl-1_3
#| tbl-cap: "Table reports results of model estimates for the causal effects of a universal loss of weekly religious service vs status quo on reported charitable behaviours at the end of the study. Outcomes are expressed in standard deviation units."
#| eval: true
#| include: true
#| echo: false


tab_all_prosocial_null_zero |>
  mutate(across(where(is.numeric), ~ round(., 3))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_all_prosocial_null_zero, "causal_difference", "lmtp")

loss_charity <- round( ( sd_donations *  tab_all_prosocial_null_zero[1,1]), 2)
loss_volunteer <- round( ( 60 * sd_volunteer *  tab_all_prosocial_null_zero[2,1]), 2)

#loss_volunteer 

```

The Longitudinal Modified Treatment Policy (LMTP) calculates the expected outcome difference between treatment and contrast groups for a specified population, focusing on longitudinal data.

For 'hours volunteer', the effect estimate is -0.022 [-0.033, -0.01]. The E-value for this estimate is 1.164 with a lower bound of 1.107. Given all modelled covariates, an unmeasured confounder would need a minimum association strength with both the treatment and outcome of 1.107 to nullify the observed effect. Weaker associations would not overturn it. We infer **weak evidence for causality**.

On the data scale, this intervention represents a difference of `r loss_volunteer` in volunteering minutes.


For 'donations', the effect estimate is -0.042 [-0.056, -0.028]. The E-value for this estimate is 1.24 with a lower bound of 1.19. Given all modelled covariates, an unmeasured confounder would need a minimum association strength with both the treatment and outcome of 1.19 to nullify the observed effect. Weaker associations would not overturn it. We infer  **evidence for causality**.

On the data scale, this intervention represents a difference of NZD `r loss_charity` per adult per year in charitable giving.


## Study 2: Causal Effects of Regular Church Attendance on Support Received From Others -- Time


```{r}
#| label: fig-2_1
#| fig-cap: "This figure reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs universal loss of weekly religious service on voluntary help received from others during the past week (yes/no) at the end of the study. Outcomes are expressed on the risk ratio scale."
#| eval: false
#| include: false
#| echo: false
#| fig-width: 10
#| fig-height: 6
plot_group_tab_all_received_time <- margot_plot(
  group_tab_contrast_received_time,
  type = "RR",
  title = title,
  subtitle = "Support Received From Others: Time",
  estimate_scale = 6,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -3,
  x_lim_hi =  4,
  linewidth = .85
)
plot_group_tab_all_received_time
```


```{r}
#| label: tbl-2_1
#| tbl-cap: "Table reports results of model estimates for the causal effects of a universal gain of weekly religious service vs universal loss of weekly religious service on voluntary help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: false
#| include: false
#| echo: false

tab_contrast_received_time |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_contrast_received_time, causal_scale = "risk_ratio" , estimand = "lmtp")

```

For the outcome 'community gives time', the estimate is 1.439 [1.046,1.979]. The E-value for this effect estimate is 2.234 with a lower bound of 1.265. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.265 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'friends gives time', given the lower bound of the E-value equals 1; we infer that **evidence for causality is not reliable.**

For the outcome 'family gives time', given the lower bound of the E-value equals 1; we infer that **evidence for causality is not reliable.**

{{< pagebreak >}}

```{r}
#| label: fig-2_2
#| fig-cap: "Figure reports results of model estimates for the causal effects of a universal gain of weekly religious service vs status quo on voluntary help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: false
#| include: false
#| echo: false
#| fig-width: 10
#| fig-height: 6
plot_group_tab_all_received_time_null <- margot_plot(
  group_tab_contrast_received_time_null,
  type = "RR",
  title = title_null,
  subtitle = "Support Received From Others: Time",
  estimate_scale = 6,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -3,
  x_lim_hi =  4
)

plot_group_tab_all_received_time_null

```



```{r}
#| label: tbl-2_2
#| tbl-cap: "Table reports results of model estimates for the causal effects of a universal gain of weekly religious service vs status quo on voluntary help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: false
#| include: false
#| echo: false


tab_contrast_received_time_null |>
  mutate(across(where(is.numeric), ~ round(., 3))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_contrast_received_time_null, "risk_ratio", "lmtp")

```

For the outcome 'community gives time', given the lower bound of the E-value equals 1; we infer that **evidence for causality is not reliable.**

For the outcome 'friends gives time', given the lower bound of the E-value equals 1; we infer that **evidence for causality is not reliable.**

For the outcome 'family gives time', given the lower bound of the E-value equals 1; we infer that **evidence for causality is not reliable.**
> 

{{< pagebreak >}}


```{r}
#| label: fig-2_3
#| fig-cap: "This figure reports the results of model estimates for the causal effects of a universal loss of weekly religious service vs. status quo on voluntary help received from others during the past week (yes/no) at the end of the study. Outcomes are expressed on the risk ratio scale."
#| eval: false
#| include: false
#| echo: false
#| fig-width: 10
#| fig-height: 6

plot_group_tab_all_received_time_null_zero <- margot_plot(
  group_tab_contrast_received_time_null_zero,
  type = "RR",
  title = title_null_zero,
  subtitle = "Support Received From Others: Time",
  estimate_scale = 6,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -3,
  x_lim_hi =  4
)

plot_group_tab_all_received_time_null_zero
```



```{r}
#| label: tbl-2_3
#| tbl-cap: "Table reports results of model estimates for the causal effects of a universal loss of weekly religious service vs status quo on voluntary help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: false
#| include: false
#| echo: false



tab_contrast_received_time_null_zero |>
  mutate(across(where(is.numeric), ~ round(., 3))) %>%
  kbl(format = "markdown")

# margot::margot_interpret_table(group_tab_contrast_received_time_null_zero, "risk_ratio", "lmtp")


```


For the outcome 'family gives time', the estimate is 0.976 [0.964,0.987]. The E-value for this effect estimate is 1.183, with a lower bound of 1.129. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.129 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'friends give time', the estimate is 0.966 [0.95,0.982]. The E-value for this effect estimate is 1.226 with a lower bound of 1.155. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.155 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'community gives time', the estimate is 0.897 [0.866,0.93]. The E-value for this effect estimate is 1.473 with a lower bound of 1.36. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.36 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

{{< pagebreak >}}

## Study 3: Causal Effects of Regular Church Attendance on Support Received From Others -- Money


```{r}
#| label: fig-3_1
#| fig-cap: "This figure reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs universal loss of weekly religious service on financial help received from others during the past week (yes/no) at the end of the study. Outcomes are expressed on the risk ratio scale."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6
plot_group_tab_all_received_money <- margot_plot(
  group_tab_all_received_money,
  type = "RR",
  title = title,
  subtitle = "Support Received From Others: Money",
  estimate_scale = 6,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -3,
  x_lim_hi =  4
)
plot_group_tab_all_received_money
```


```{r}
#| label: tbl-3_1
#| tbl-cap: "This table reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs universal loss of weekly religious service on financial help received from others during the past week (yes/no) at the end of the study. Outcomes are expressed on the risk ratio scale."
#| eval: true
#| include: true
#| echo: false


tab_all_received_money |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_all_received_money, "risk_ratio", "lmtp")

```



For the outcome 'community gives money', the estimate is 2.663 [1.932,3.671]. The E-value for this effect estimate is 4.767, with a lower bound of 3.274. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 3.274 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **the evidence for causality is strong**.

For the outcome 'friends give money', the estimate is 2.052 [1.323,3.184]. The E-value for this effect estimate is 3.521, with a lower bound of 1.977. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.977 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'family gives money', the estimate is 1.656 [1.219,2.249]. The E-value for this effect estimate is 2.698, with a lower bound of 1.736. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.736 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.


{{< pagebreak >}}

```{r}
#| label: fig-3_2
#| fig-cap: "Figure reports results of model estimates for the causal effects of a universal gain of weekly religious service vs status quo on financial help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

plot_group_tab_all_received_money_null <- margot_plot(
  group_tab_all_received_money_null,
  type = "RR",
  title = title_null,
  subtitle = "Support Received From Others: Money",
  estimate_scale = 6,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -3,
  x_lim_hi =  4
)
plot_group_tab_all_received_money_null
```


```{r}
#| label: tbl-3_2
#| tbl-cap: "This table reports the results of model estimates for the causal effects of a universal gain of weekly religious service vs status quo on financial help received from others during the past week (yes/no) at the end of the study. Outcomes are expressed on the risk ratio scale."
#| eval: true
#| include: true
#| echo: false



tab_all_received_money_null|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_all_received_money_null, "risk_ratio", "lmtp")

```

For the outcome 'community gives money', the estimate is 2.042 [1.59,2.623]. The E-value for this effect estimate is 3.501 with a lower bound of 2.559. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 2.559 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **the evidence for causality is strong**.

For the outcome 'friends give money', the estimate is 1.718 [1.129,2.616]. The E-value for this effect estimate is 2.829 with a lower bound of 1.511. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.511 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'family gives money', the estimate is 1.467 [1.086,1.981]. The E-value for this effect estimate is 2.295 with a lower bound of 1.392. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.392.


{{< pagebreak >}}


```{r}
#| label: fig-3_3
#| fig-cap: "Figure reports results of model estimates for the causal effects of a universal loss of weekly religious service vs status quo on financial help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

plot_group_tab_all_received_money_null_zero <- margot_plot(
  group_tab_all_received_money_null_zero,
  type = "RR",
  title = title_null_zero,
  subtitle = "Support Received From Others: Money",
  estimate_scale = 6,
  base_size = 18,
  text_size = 4.5,
  point_size = 3.5,
  title_size = 18,
  subtitle_size = 16,
  legend_text_size = 10,
  legend_title_size = 10,
  x_offset = -.5,
  x_lim_lo = -3,
  x_lim_hi =  4
)
plot_group_tab_all_received_money_null_zero
```


```{r}
#| label: tbl-3_3
#| tbl-cap: "Table reports results of model estimates for the causal effects of a universal loss of weekly religious service vs status quo on financial help received from others during the past week (yes/no) at the end of study. Outcomes are expressed on the risk ratio scale."
#| eval: true
#| include: true
#| echo: false



tab_all_received_money_null_zero|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

#margot::margot_interpret_table(group_tab_all_received_money_null_zero, "risk_ratio", "lmtp")
```

For the outcome 'family gives money', the estimate is 0.886 [0.863,0.91]. The E-value for this effect estimate is 1.51 with a lower bound of 1.429. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.429 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'friends gives money', the estimate is 0.837 [0.784,0.894]. The E-value for this effect estimate is 1.677, with a lower bound of 1.483. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.483 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.

For the outcome 'community gives money', the estimate is 0.767 [0.672,0.875]. The E-value for this effect estimate is 1.933 with a lower bound of 1.547. In this scenario, assuming all modelled covariates, an unmeasured confounder that exhibits an association with both the treatment and outcome with a minimum strength (on the risk ratio scale) of 1.547 could nullify the observed effect. However, the effect would survive weaker unmeasured confounding. Here, we find **evidence for causality**.


## Discussion 


### Limitations


1.  **Causality and confounding**: we employ rigorous causal inference techniques, but these are contingent the adequacy of our identification strategy. Although our sensitivity analyses allow us to describe the amount of unmeasured confounding needed to explain away our results, it is unclear whether such confounders are present and, if so, how strongly they may be related to the treatments and outcomes.

2. **Treatment effect heterogeneity**:  even if we assume that the results are independent of the 

3. **Individual treatment rules**:

4. **Prosociality**: we are limited  'prosociality'.  Giving to others: however,

5. **Measurement error**: Direct and/or correlated measurement errors may lead to bias by implying true effects in their absence. Additionally, uncorrelated measurement errors may lead to bias by attenuating true results in their presence. To some extent, our method for evaluating causation across multiple measures of "prosociality" addresses these threats. However, variability in results may arise from presently unknown combinations of measurement error.... (say more)

6.  **Generalisability and transportability**: our findings should be interpreted within the context of the New Zealand population from which the data were sourced and weighted. Although these results may have broader relevance to similar populations, we advise against direct extrapolation to different populations or sociocultural settings.


### Summary of findings

First, as expected, we observed that in theoretically relevant contrast, ALL GAIN vs ALL LOSS had stronger effects than the policy-motivated contrast ALL GAIN vs STATUS QUO. For example, whereas the measure of social support revealed a causal effect for the theoretical intervention, the policy-relevant intervention was unreliable. This result suggests caution when inferring policy decisions on the results from theoretically-motivated interventions. 

Second, compared with the STATUS QUO, different policy motivations arise for gaining and losing religious service attendance. In the first place, the confidence intervals around loss expectations were narrower because the underlying shifts involved required less counterfactual projection across the population. 

<!-- Third, perhaps most obviously, the measures themselves suggest different interpretations of the importance of religion.  For example, although social connection measures did not generally reveal strong evidence for causal influence from either the gain or loss of regular religious service, except on social belonging in the ALL GAIN vs ALL LOSS intervention, arguably, the concept of social connection does not directly relate to prosociality. One may feel socially connected to people without their help, and one can receive help from strangers [@mccullough2020kindness]. Nevertheless, we include social connection measures to provide a clearer picture of the multi-dimensional pro-social response phenotype. Notably, a long tradition of reflection in the social scientific study of religion implies that religion induces prosociality by collective effervescence, or more recently, by postulated ego-fusion & etc [].  Although rituals may evoke these affective responses, whether and how charitable behaviours and volunteering remain uncertain.  -->

Third, we find corroborating evidence for the effects of religious service attendance on charitable donations, measured by self-report data and help-received responses. Presumably, much of this giving is to religious institutions. Additional support for charitable giving comes from public records, which in New Zealand must be reported because religious institutions are charities that must report their earnings and expenses []. Whatever one may think of churches, the evidence from New Zealand suggests they are efficient charities []. 

Fourth, Daryl... 

### Economic value of regular religious service

```{r}
#| label: cashvalue
#| eval: true
#| include: false
#| echo: false
# # model estimates for charity under each intervention
# average annual donations 

# sample mean at end of study (won't be population mean)
mean_donations <- margot::here_read("mean_donations")
mean_volunteer <- margot::here_read("mean_volunteer")

# import models
# population mean
t2_charity_donate_z_null <- here_read("t2_charity_donate_z_null")

# all loss
t2_charity_donate_z_zero <- here_read("t2_charity_donate_z_zero")

# all gain
t2_charity_donate_z_gain <- here_read("t2_charity_donate_z_gain")

# calculate  population estimates for means of annual charitable donations, using the models
# note these correctly account for sample weights
mean_donations_gain <-mean_donations  + ( t2_charity_donate_z_gain$theta * sd_donations )
mean_donations_null <-mean_donations  + ( t2_charity_donate_z_null$theta * sd_donations )

mean_donations_zero<- mean_donations  + ( t2_charity_donate_z_zero$theta * sd_donations )


mean_volunteer_gain<- mean_volunteer  + ( t2_hours_charity_z_gain$theta * sd_volunteer )
mean_volunteer_null<- mean_volunteer  + ( t2_hours_charity_z_null$theta * sd_volunteer )
mean_volunteer_zero <- mean_volunteer  + ( t2_hours_charity_z_zero$theta * sd_volunteer )

mean_volunteer_gain - mean_volunteer_null
mean_volunteer_null - mean_volunteer_zero
mean_volunteer_gain - mean_volunteer_zero

# sanity checks for differences 
donations_lmtp_up = abs(mean_donations_null - mean_donations_gain)
donations_lmtp_down = mean_donations_null - mean_donations_zero

volunteer_lmtp_up = abs(mean_volunteer_null - mean_volunteer_gain)
volunteer_lmtp_down = (mean_volunteer_null - mean_volunteer_zero)

volunteer_lmtp_up * 60 
volunteer_lmtp_down * 60

# verify
contrast_char <-
  lmtp::lmtp_contrast(t2_charity_donate_z_gain , ref =  t2_charity_donate_z_zero, type = "additive")

contrast_vol <-
  lmtp::lmtp_contrast(t2_hours_charity_z_gain , ref =  t2_hours_charity_z_zero, type = "additive")



# verified: this is exactly correct
contrast_char$vals$theta * sd_donations

# #number of people in NZ > 18 year olds in 2021/22
nz_adult_population <- 3989000
nz_20_over <- 3.8391
#source; https://www.stats.govt.nz/information-releases/national-population-estimates-at-30-june-2021


# annual charity estimate for the population = status quo
factual_charity_estimate <- nz_adult_population * mean_donations_null

# counterfactual charity estimate if all were to attend religious service regularly
counterfactual_factual_charity_estimate_up = nz_adult_population * mean_donations_gain


# counterfactual charity estimate if all were to lose religious service regularly
counterfactual_factual_charity_estimate_down = nz_adult_population * mean_donations_zero
net_loss = counterfactual_factual_charity_estimate_down - factual_charity_estimate
net_gain = counterfactual_factual_charity_estimate_up - factual_charity_estimate
# net_loss
# net_gain
 
# compute differences at the national level : gain
counterfactual_difference_charity_donate_up = counterfactual_factual_charity_estimate_up - factual_charity_estimate
#counterfactual_difference_charity_donate_up

# compute differences at the national level : loss
counterfactual_difference_charity_donate_down =  factual_charity_estimate - counterfactual_factual_charity_estimate_down
#counterfactual_difference_charity_donate_down

# differences  - absolute scale
#print(counterfactual_difference_charity_donate_up)
#print(counterfactual_difference_charity_donate_down)
# 
# # ~ 2.5 billion NZD 
# # 2503913110
# 
# nz annual budget in 2021

nz_annual_budget = 14494000000 * 4 # treasury (https://www.treasury.govt.nz/publications/budgets/budget-2021)
# 
# # intervention as percentage of gov't annual budget 

# percentage of gain/loss as a function of nz government annual budget
per_gain <- counterfactual_difference_charity_donate_up/ nz_annual_budget
per_lost <- counterfactual_difference_charity_donate_down/ nz_annual_budget

# per_gain
# per_lost
# prop of values
prop_loss_of_gain <- round( abs(net_loss/net_gain), 2)
```


We may use our results to compute the approximate economic value of religious service attendance by comparing the sums of expected donations across the New Zealand's adult population under the all-gain, all-loss, and status quo.

We find that an increase in religious service attendance is expected to result in an individual average donation rate of `r mean_donations_gain`,  Conversely, a decrease in religious service attendance is expected to an average charitable donation rate of `r mean_donations_zero`. The status quo is expected to yield an average donation rate of `r mean_donations_null`.  The number of adult residents living in New Zealand in 2021 was `r nz_adult_population`,[^pop]  Multiplying this number by the estimated rates suggests the net gain to charity of country-wide religious service attendance compared with the status quo is `r net_gain`. By contrast the net cost of a country-wide loss of regular religious service attendance on charitable donations is: `r net_loss`.  


[^pop]: [https://www.stats.govt.nz/information-releases/national-population-estimates-at-30-june-2021](https://www.stats.govt.nz/information-releases/national-population-estimates-at-30-june-2021)

Putting these figures in context, the government of New Zealand's annual budget in 2021 was `r nz_annual_budget`.[^source]. The expected gain from the country-wide adoption of religious service is `r per_gain` of New Zealand's annual government budget in 2021 The expected loss from the country-wide loss of all religious service amounts to `r per_lost` of New Zealand's annual government budget in 2021.

[^source]: [https://www.treasury.govt.nz/publications/budgets/budget-2021](https://www.treasury.govt.nz/publications/budgets/budget-2021)

We infer that the declining religious service in New Zealand affects charitable giving, however these costs sum to about `r prop_loss_of_gain` the opportunity cost of hypothetical New Zealand in which the population attended religious service regularly.


### Note of concern about the use of cross-sectional regression models to investigate the social consequences of religion

```{r}
#| label: regressionsucks
#| eval: true
#| include: false
#| echo: false
# regression 
# b_church_on_hours_charity<-margot::here_read("b_church_on_hours_charity")
# b_church_on_hours_charity
# lm_coef_fit_church_on_charity_donate
# verify

# contrast for charity

contrast_charity <-
  lmtp::lmtp_contrast(t2_charity_donate_z_gain , ref =  t2_charity_donate_z_zero, type = "additive")
contrast_volunteer <-
  lmtp::lmtp_contrast(t2_hours_charity_z_gain , ref =  t2_hours_charity_z_zero, type = "additive")




b_church_on_hours_charity<-margot::here_read("b_church_on_hours_charity")
b_church_on_charity_donate<-margot::here_read("b_church_on_charity_donate")

#b_church_on_hours_charity

fit_church_on_hours_charity<-margot::here_read("fit_church_on_hours_charity")
fit_church_on_hours_charity
fit_church_on_charity_donate<-margot::here_read("fit_church_on_charity_donate")
fit_church_on_charity_donate

regression_regular_church_charity <- fit_church_on_charity_donate$coefficients[2]  *  4.2 # monthly
regression_regular_church_charity

regression_regular_church_volunteer_minutes <- fit_church_on_hours_charity$coefficients[2]  *  4.2  * 60 # monthly
regression_regular_church_volunteer_minutes

# donate data scale 
donate_lmtp <- contrast_charity$vals$theta* sd_donations
donate_lmtp
# voluneer_data scale
volunteer_lmtp_mins = contrast_volunteer$vals$theta * sd_volunteer * 60

# perc greater

percent_greater_regression_donate  <- round( (regression_regular_church_charity/donate_lmtp), 2) 
percent_greater_regression_volunteer <- round( (regression_regular_church_volunteer_minutes/volunteer_lmtp_mins), 2) 
percent_greater_regression_donate
percent_greater_regression_volunteer
```

How do these results compare to cross-sectional regression? 

We performed a cross-sectional analysis in which we estimated the relationship between religious service attendance and charitable donations. We included all regression covariates from the causal models (including sample weights), except the baseline outcome. The coefficient for religious service attendance in this model, which represents the change in expectation from a one-unit change in the predictor, is `r b_church_on_charity_donate`. To obtain the monthly rate we multiplied this estimate by 4.2 to obtain a prediction of `r regression_regular_church_charity`. This amount is `r percent_greater_regression_donate` than we infer from the ALL-GAIN vs ALL LOSS causal model.

Recalled we did not find reliable evidence for self-reported volunteering from gains in religious service attendance. However, the coefficients we obtained for volunteering in a cross-sectional model were estimated to be reliable at `r b_church_on_hours_charity`.  To obtain the monthly rate we multiplied this estimate by 4.2 and by 60 to obtain a prediction of `r regression_regular_church_volunteer_minutes` minutes. This amount is `r percent_greater_regression_volunteer` than we infer from the ALL-GAIN vs ALL LOSS causal model.

The results underscore the importance of remembering that cross-sectional regressions are unreliable for estimating causal effects. 





{{< pagebreak >}}

### Ethics

The University of Auckland Human Participants Ethics Committee reviews the NZAVS every three years. Our most recent ethics approval statement is as follows: The New Zealand Attitudes and Values Study was approved by the University of Auckland Human Participants Ethics Committee on 26/05/2021 for six years until 26/05/2027, Reference Number UAHPEC22576.

### Acknowledgements

The New Zealand Attitudes and Values Study is supported by a grant from the Templeton Religious Trust (TRT0196; TRT0418). JB received support from the Max Planck Institute for the Science of Human History. The funders had no role in preparing the manuscript or the decision to publish.


### Author Statement

- JB conceived of the study and analytic approach.  
- CS led NZAVS data collection. 
- All authors contributed to the manuscript.


{{< pagebreak >}}

## Appendix A: Measures {#appendix-measures}

#### Age (waves: 1-15)

We asked participants' ages in an open-ended question ("What is your age?" or "What is your date of birth").


#### Charitable Donations  (Study 1 outcome)

Using one item from @hoverd_religious_2010, we asked participants "How much money have you donated to charity in the last year?". 

<!-- To stabilise this indicator, we took the natural log of the response + 1. -->


#### Charitable Volunteering  (Study 1 outcome)


We measured hours of volunteering using one item from @sibley2011: "Hours spent … voluntary/charitable work."

<!-- To stabilise this indicator, we took the natural log of the response + 1. -->


#### Community: Sense of Community (Study 2 outcome)

We measured a sense of community with a single item from @sengupta2013: "I feel a sense of community with others in my local neighbourhood." Participants answered on a scale of 1 (strongly disagree) to 7 (strongly agree).


#### Community: Felt Belongingness  (Study 2 outcome)

We assessed felt belongingness with three items adapted from the Sense of Belonging Instrument [@hagerty1995]: (1) "Know that people in my life accept and value me"; (2) "Feel like an outsider"; (3) "Know that people around me share my attitudes and beliefs". Participants responded on a scale from 1 (Very Inaccurate) to 7 (Very Accurate). The second item was reversely coded.

#### Community: Social Support (Study 2 outcome)

Participants' perceived social support was measured using three items from @cutrona1987 and @williams_cyberostracism_2000: (1) "There are people I can depend on to help me if I really need it"; (2) "There is no one I can turn to for guidance in times of stress"; (3) "I know there are people I can turn to when I need help." Participants indicated the extent to which they agreed with those items (1 = Strongly Disagree to 7 = Strongly Agree). The second item was negatively worded, so we reversely recorded the responses to this item.

#### Disability

We assessed disability with a one item indicator adapted from @verbrugge1997, that asks "Do you have a health condition or disability that limits you, and that has lasted for 6+ months?" (1 = Yes, 0 = No).


#### Education Attainment (waves: 1, 4-15)

We asked participants, "What is your highest level of qualification?". We coded participants' highest finished degree according to the New Zealand Qualifications Authority. Ordinal-Rank 0-10 NZREG codes (with overseas school quals coded as Level 3, and all other ancillary categories coded as missing) See:https://www.nzqa.govt.nz/assets/Studying-in-NZ/New-Zealand-Qualification-Framework/requirements-nzqf.pdf

#### Employment (waves: 1-3, 4-11)

We asked participants, "Are you currently employed? (This includes self-employed or casual work)". \* note: This question disappeared in the updated NZAVS Technical documents (Data Dictionary).

<!-- #### European (waves: 1-15) -->

<!-- Participants were asked "Which ethnic group do you belong to (NZ census question)?" or "Which ethnic group(s) do you belong to? (Open-ended)" (wave: 3). Europeans were coded as 1, whereas other ethnicities were coded as 0. -->

#### Ethnicity

Based on the New Zealand Census, we asked participants, "Which ethnic group(s) do you belong to?". The responses were: (1) New Zealand European; (2) Māori; (3) Samoan; (4) Cook Island Māori; (5) Tongan; (6) Niuean; (7) Chinese; (8) Indian; (9) Other such as DUTCH, JAPANESE, TOKELAUAN. Please state:. We coded their answers into four groups: Maori, Pacific, Asian, and Euro (except for Time 3, which used an open-ended measure).


#### Fatigue

We assessed subjective fatigue by asking participants, "During the last 30 days, how often did ... you feel exhausted?" Responses were collected on an ordinal scale (0 = None of The Time, 1 = A little of The Time, 2 = Some of The Time, 3 = Most of The Time, 4 = All of The Time).

#### Gender (waves: 1-15)

We asked participants' gender in an open-ended question: "what is your gender?" or "Are you male or female?" (waves: 1-5). Female was coded as 0, Male was coded as 1, and gender diverse coded as 3 [@fraser_coding_2020]. (or 0.5 = neither female nor male)

Here, we coded all those who responded as Male as 1, and those who did not as 0.


#### Honesty-Humility-Modesty Facet (waves: 10-14)

Participants indicated the extent to which they agree with the following four statements from @campbell2004 , and @sibley2011 (1 = Strongly Disagree to 7 = Strongly Agree)

```
i.  I want people to know that I am an important person of high status, (Waves: 1, 10-14)
ii. I am an ordinary person who is no better than others.
iii. I wouldn't want people to treat me as though I were superior to them.
iv. I think that I am entitled to more respect than the average person is.
```
#### Has Siblings

"Do you have siblings?" [@stronge2019onlychild]

#### Hours of Childcare

We measured hours of exercising using one item from @sibley2011: 'Hours spent … looking after children."

To stabilise this indicator, we took the natural log of the response + 1.


#### Hours of Housework

We measured hours of exercising using one item from @sibley2011: "Hours spent … housework/cooking"

To stabilise this indicator, we took the natural log of the response + 1.

#### Hours of Exercise

We measured hours of exercising using one item from @sibley2011: "Hours spent … exercising/physical activity" 

To stabilise this indicator, we took the natural log of the response + 1.

<!-- #### Hours Volunteering -->

<!-- We measured hours of volunteering using one item from @sibley2011: "Hours spent … voluntary/charitable work." -->

<!-- To stabilise this indicator, we took the natural log of the response + 1. -->

#### Hours of Childcare

We measured hours of exercising using one item from @sibley2011: 'Hours spent … looking after children."

To stabilise this indicator, we took the natural log of the response + 1.


#### Hours of Exercise

We measured hours of exercising using one item from @sibley2011: "Hours spent … exercising/physical activity" 

To stabilise this indicator, we took the natural log of the response + 1.


#### Hours of Housework

We measured hours of exercising using one item from @sibley2011: "Hours spent … housework/cooking"

To stabilise this indicator, we took the natural log of the response + 1.


#### Hours of Sleep

Participants were asked "During the past month, on average, how many hours of *actual sleep* did you get per night".


#### Socialising (time 10, time 11)

As part of the time usage measures, participants were asked to state how many hour the spent in activities related to socialising with the following groups:

  - Hours spent … socialising with family
  - Hours spent … socialising with friends
  - Hours spent … socialising with community groups
  
  <!-- - Hours spent … socialising with religious groups -->

#### Hours of Work

We measured hours of work using one item from @sibley2011:"Hours spent … working in paid employment."

To stabilise this indicator, we took the natural log of the response + 1.


#### Income (waves: 1-3, 4-15)

Participants were asked "Please estimate your total household income (before tax) for the year XXXX". To stabilise this indicator, we first took the natural log of the response + 1, and then centred and standardised the log-transformed indicator.

<!-- #### Job Security (waves: 1-3,4-7,9-15) -->

<!-- Participants indicated their feeling of job security by answering "How secure do you feel in your current job?" on a scale from 1 (not secure) to 7 (very secure). -->


#### Living in an Urban Area (waves: 1-15)

We coded whether they are living in an urban or rural area (1 = Urban, 0 = Rural) based on the addresses provided.

We coded whether they were living in an urban or rural area (1 = Urban, 0 = Rural) based on the addresses provided.

#### Mini-IPIP 6 (waves: 1-3,4-15)

We measured participants' personalities with the Mini International Personality Item Pool 6 (Mini-IPIP6) [@sibley2011], which consists of six dimensions and each dimension is measured with four items:

1.  agreeableness,

    i.  I sympathize with others' feelings.
    ii. I am not interested in other people's problems. (r)
    iii. I feel others' emotions.
    iv. I am not really interested in others. (r)

2.  conscientiousness,

    i.  I get chores done right away.
    ii. I like order.
    iii. I make a mess of things. (r)
    iv. I often forget to put things back in their proper place. (r)

3.  extraversion,

    i.  I am the life of the party.
    ii. I don't talk a lot. (r)
    iii. I keep in the background. (r)
    iv. I talk to a lot of different people at parties.

4.  honesty-humility,

    i.  I feel entitled to more of everything. (r)
    ii. I deserve more things in life. (r)
    iii. I would like to be seen driving around in a very expensive car. (r)
    iv. I would get a lot of pleasure from owning expensive luxury goods. (r)

5.  neuroticism, and

    i.  I have frequent mood swings.
    ii. I am relaxed most of the time. (r)
    iii. I get upset easily.
    iv. I seldom feel blue. (r)

6.  openness to experience

    i.  I have a vivid imagination.
    ii. I have difficulty understanding abstract ideas. (r)
    iii. I do not have a good imagination. (r)
    iv. I am not interested in abstract ideas. (r)

Each dimension was assessed with four items and participants rated the accuracy of each item as it applies to them from 1 (Very Inaccurate) to 7 (Very Accurate). Items marked with (r) are reverse coded.


#### NZ-Born (waves: 1-2,4-15)

We asked participants, "Which country were you born in?" or "Where were you born? (please be specific, e.g., which town/city?)" (waves: 6-15).


#### NZ Deprivation Index (waves: 1-15)

We used the NZ Deprivation Index to assign each participant a score based on where they live [@atkinson2019]. This score combines data such as income, home ownership, employment, qualifications, family structure, housing, and access to transport and communication for an area into one deprivation score.

#### Opt-in

The New Zealand Attitudes and Values Study allows opt-ins to the study. Because the opt-in population may differ from those sampled randomly from the New Zealand electoral roll; although the opt-in rate is low, we include an indicator (yes/no) for this variable.


#### NZSEI Occupational Prestige and Status (waves: 8-15)

We assessed occupational prestige and status using the New Zealand Socio-economic Index 13 (NZSEI-13) [@fahy2017a]. This index uses the income, age, and education of a reference group, in this case the 2013 New Zealand census, to calculate a score for each occupational group. Scores range from 10 (Lowest) to 90 (Highest). This list of index scores for occupational groups was used to assign each participant a NZSEI-13 score based on their occupation.

We assessed occupational prestige and status using the New Zealand Socio-economic Index 13 (NZSEI-13) [@fahy2017]. This index uses the income, age, and education of a reference group, in this case, the 2013 New Zealand census, to calculate a score for each occupational group. Scores range from 10 (Lowest) to 90 (Highest). This list of index scores for occupational groups was used to assign each participant a NZSEI-13 score based on their occupation.

<!-- We asked participants, "If you are a parent, what is the birth date of your eldest child?". -->
<!-- #### Parent (waves: 5-15) -->

<!-- We asked participants, "If you are a parent, what is the birth date of your eldest child?" or "If you are a parent, in which year was your eldest child born?" (waves: 10-15). Parents were coded as 1, while the others were coded as 0. --> 

#### Number of Children (waves: 1-3, 4-15)

We measured the number of children using one item from @Bulbulia_2015. We asked participants, "How many children have you given birth to, fathered, or adopted. How many children have you given birth to, fathered, or adopted?" or ""How many children have you given birth to, fathered, or adopted. How many children have you given birth to, fathered, and/or parented?" (waves: 12-15).

<!-- Here, we used responses to create a binary indicator for parenthood: Parent Yes = 1/ No = 0.  -->

#### Partner: Has

"What is your relationship status?" (e.g., single, married, de-facto, civil union, widowed, living together, etc.)



#### Politically Conservative 

We measured participants' political conservative orientation using a single item adapted from @jost_end_2006-1.

"Please rate how politically liberal versus conservative you see yourself as being."

(1 = Extremely Liberal to 7 = Extremely Conservative)

#### Politically Right Wing 

We measured participants' political right-wing orientation using a single item adapted from @jost_end_2006-1.

"Please rate how politically left-wing versus right-wing you see yourself as being.."

(1 = Extremely left-wing to 7 = Extremely right-wing)



<!-- #### Religion Affiliation -->

<!-- Participants were asked to indicate their religion identification ("Do you identify with a religion and/or spiritual group?") on a binary response (1 = Yes, 0 = No). We then asked, "What religion or spiritual group?" These questions are used in the New Zealand Census -->


<!-- #### Support -->

<!-- Participants' perceived social support was measured using three items from @cutrona1987 and @williams_cyberostracism_2000: (1) "There are people I can depend on to help me if I really need it"; (2) "There is no one I can turn to for guidance in times of stress"; (3) "I know there are people I can turn to when I need help." Participants indicated the extent to which they agreed with those items (1 = Strongly Disagree to 7 = Strongly Agree). The second item was negatively worded, so we reversely recorded the responses to this item. -->

#### Short-Form Health

Participants' subjective health was measured using one item ("Do you have a health condition or disability that limits you, and that has lasted for 6+ months?"; 1 = Yes, 0 = No) adapted from @verbrugge1997.


#### Support received: money (waves 10-13) (Study 4 outcomes)

The NZAVS has a 'revealed' measure of received help and support measured in hours of support in the previous week. The items are: 

Received help and support - money
  - family
  - friends
  - others in my community
  
  
#### Support received: time (waves 10-13) (Study 3 outcomes)

The NZAVS has a 'revealed' measure of received help and support measured in hours of support in the previous week. The items are: 

Received help and support - hours
  - family
  - friends
  - others in my community


#### Total Siblings

Participants were asked the following questions related to sibling counts: 
 
 - Were you the 1st born, 2nd born, or 3rd born, etc, child of your mother?
 - Do you have siblings?
 - How many older sisters do you have?
 - How many younger sisters do you have?
 - How many older brothers do you have?
 - How many younger brothers do you have?

A single score was obtained from sibling counts by summing responses to the "How many..." items. From these scores an ordered factor was created ranging from 0 to 7, where participants with more than 7 siblings were grouped into the highest category. 


<!-- #### Volunteers -->

<!-- We asked participants,"Please estimate how many hours you spent doing each of the following things last week" and responded to an item ("voluntary/charitable work") from [@sibley2011]. -->


## Appendix B. Baseline Demographic Statistics {#appendix-demographics}

::: {#tbl-B}

```{r}
#| label: tbl-table-demography-code
#| tbl-cap: "Baseline demographic statistics"
#| eval: false
#| echo: false
#| include: false

table_baseline <- read_here("table_baseline")
#table_baseline |>  kbl(format = "markdown")
```
:::

|**Exposure + Demographic Variables** |**N = 47,948** |
|:------------------------------------|:--------------|
|__Age__                              |NA             |
|Mean (SD)                            |49 (14)        |
|Range                                |18, 99         |
|IQR                                  |39, 60         |
|__Agreeableness__                    |NA             |
|Mean (SD)                            |5.35 (0.99)    |
|Range                                |1.00, 7.00     |
|IQR                                  |4.75, 6.00     |
|Unknown                              |452            |
|__Alert Level Combined Lead__        |NA             |
|no_alert                             |24,789 (71%)   |
|early_covid                          |3,902 (11%)    |
|alert_level_1                        |3,010 (8.7%)   |
|alert_level_2                        |865 (2.5%)     |
|alert_level_2_5_3                    |569 (1.6%)     |
|alert_level_4                        |1,648 (4.7%)   |
|Unknown                              |13,165         |
|__Born Nz__                          |37,082 (78%)   |
|Unknown                              |585            |
|__Children Num__                     |NA             |
|Mean (SD)                            |1.74 (1.46)    |
|Range                                |0.00, 14.00    |
|IQR                                  |0.00, 3.00     |
|Unknown                              |393            |
|__Conscientiousness__                |NA             |
|Mean (SD)                            |5.11 (1.06)    |
|Range                                |1.00, 7.00     |
|IQR                                  |4.50, 6.00     |
|Unknown                              |443            |
|__Education Level Coarsen__          |NA             |
|no_qualification                     |1,239 (2.7%)   |
|cert_1_to_4                          |16,700 (36%)   |
|cert_5_to_6                          |5,969 (13%)    |
|university                           |12,595 (27%)   |
|post_grad                            |5,118 (11%)    |
|masters                              |3,924 (8.4%)   |
|doctorate                            |1,125 (2.4%)   |
|Unknown                              |1,278          |
|__Employed__                         |38,024 (79%)   |
|Unknown                              |107            |
|__Eth Cat__                          |NA             |
|euro                                 |38,158 (81%)   |
|maori                                |5,457 (12%)    |
|pacific                              |1,137 (2.4%)   |
|asian                                |2,543 (5.4%)   |
|Unknown                              |653            |
|__Extraversion__                     |NA             |
|Mean (SD)                            |3.91 (1.20)    |
|Range                                |1.00, 7.00     |
|IQR                                  |3.00, 4.75     |
|Unknown                              |443            |
|__Hlth Disability__                  |10,540 (22%)   |
|Unknown                              |926            |
|__Hlth Fatigue__                     |NA             |
|0                                    |7,326 (15%)    |
|1                                    |15,242 (32%)   |
|2                                    |14,803 (31%)   |
|3                                    |7,448 (16%)    |
|4                                    |2,572 (5.4%)   |
|Unknown                              |557            |
|__Hlth Sleep Hours__                 |NA             |
|Mean (SD)                            |6.94 (1.13)    |
|Range                                |2.50, 16.00    |
|IQR                                  |6.00, 8.00     |
|Unknown                              |2,482          |
|__Honesty Humility__                 |NA             |
|Mean (SD)                            |5.41 (1.19)    |
|Range                                |1.00, 7.00     |
|IQR                                  |4.75, 6.25     |
|Unknown                              |448            |
|__Hours Children log__               |NA             |
|Mean (SD)                            |1.17 (1.61)    |
|Range                                |0.00, 5.13     |
|IQR                                  |0.00, 2.40     |
|Unknown                              |1,538          |
|__Hours Community log__              |NA             |
|Mean (SD)                            |0.34 (0.65)    |
|Range                                |0.00, 4.80     |
|IQR                                  |0.00, 0.69     |
|Unknown                              |1,538          |
|__Hours Exercise log__               |NA             |
|Mean (SD)                            |1.54 (0.85)    |
|Range                                |0.00, 4.39     |
|IQR                                  |1.10, 2.08     |
|Unknown                              |1,538          |
|__Hours Family log__                 |NA             |
|Mean (SD)                            |1.61 (1.04)    |
|Range                                |0.00, 5.13     |
|IQR                                  |1.10, 2.40     |
|Unknown                              |1,538          |
|__Hours Friends log__                |NA             |
|Mean (SD)                            |1.45 (0.87)    |
|Range                                |0.00, 5.02     |
|IQR                                  |1.10, 1.95     |
|Unknown                              |1,538          |
|__Hours Housework log__              |NA             |
|Mean (SD)                            |2.14 (0.78)    |
|Range                                |0.00, 5.13     |
|IQR                                  |1.61, 2.71     |
|Unknown                              |1,538          |
|__Hours Religious Community log__    |NA             |
|Mean (SD)                            |0.17 (0.49)    |
|Range                                |0.00, 5.04     |
|IQR                                  |0.00, 0.00     |
|Unknown                              |1,538          |
|__Hours Work log__                   |NA             |
|Mean (SD)                            |2.66 (1.58)    |
|Range                                |0.00, 4.62     |
|IQR                                  |1.39, 3.71     |
|Unknown                              |1,538          |
|__Household Inc log__                |NA             |
|Mean (SD)                            |11.39 (0.77)   |
|Range                                |0.69, 14.92    |
|IQR                                  |11.00, 11.92   |
|Unknown                              |3,726          |
|__Kessler6 Sum__                     |NA             |
|Mean (SD)                            |5 (4)          |
|Range                                |0, 24          |
|IQR                                  |2, 8           |
|Unknown                              |489            |
|__Male__                             |17,779 (37%)   |
|__Modesty__                          |NA             |
|Mean (SD)                            |5.98 (0.95)    |
|Range                                |1.00, 7.00     |
|IQR                                  |5.50, 6.75     |
|Unknown                              |34             |
|__Neuroticism__                      |NA             |
|Mean (SD)                            |3.49 (1.15)    |
|Range                                |1.00, 7.00     |
|IQR                                  |2.75, 4.25     |
|Unknown                              |454            |
|__Nz Dep2018__                       |NA             |
|Mean (SD)                            |4.77 (2.73)    |
|Range                                |1.00, 10.00    |
|IQR                                  |2.00, 7.00     |
|Unknown                              |310            |
|__Nzsei 13 l__                       |NA             |
|Mean (SD)                            |54 (17)        |
|Range                                |10, 90         |
|IQR                                  |41, 69         |
|Unknown                              |676            |
|__Openness__                         |NA             |
|Mean (SD)                            |4.96 (1.12)    |
|Range                                |1.00, 7.00     |
|IQR                                  |4.25, 5.75     |
|Unknown                              |445            |
|__Partner__                          |34,818 (75%)   |
|Unknown                              |1,539          |
|__Political Conservative__           |NA             |
|1                                    |2,515 (5.6%)   |
|2                                    |8,676 (19%)    |
|3                                    |8,820 (20%)    |
|4                                    |13,913 (31%)   |
|5                                    |6,694 (15%)    |
|6                                    |3,299 (7.4%)   |
|7                                    |741 (1.7%)     |
|Unknown                              |3,290          |
|__Religion Church Round__            |NA             |
|0                                    |38,479 (83%)   |
|1                                    |1,517 (3.3%)   |
|2                                    |1,125 (2.4%)   |
|3                                    |907 (2.0%)     |
|4                                    |2,478 (5.3%)   |
|5                                    |475 (1.0%)     |
|6                                    |326 (0.7%)     |
|7                                    |106 (0.2%)     |
|8                                    |964 (2.1%)     |
|Unknown                              |1,571          |
|__Rural Gch 2018 l__                 |NA             |
|1                                    |29,479 (62%)   |
|2                                    |9,014 (19%)    |
|3                                    |5,865 (12%)    |
|4                                    |2,694 (5.7%)   |
|5                                    |588 (1.2%)     |
|Unknown                              |308            |
|__Sample Frame Opt in__              |1,384 (2.9%)   |
|__Sample Origin__                    |NA             |
|1-2                                  |2,970 (6.2%)   |
|3-3.5                                |2,052 (4.3%)   |
|4                                    |2,700 (5.6%)   |
|5-6-7                                |4,506 (9.4%)   |
|8-9                                  |5,802 (12%)    |
|10                                   |29,918 (62%)   |
|__Short Form Health__                |NA             |
|Mean (SD)                            |5.04 (1.17)    |
|Range                                |1.00, 7.00     |
|IQR                                  |4.33, 6.00     |
|Unknown                              |9              |
|__Total Siblings__                   |NA             |
|Mean (SD)                            |2.55 (1.87)    |
|Range                                |0.00, 23.00    |
|IQR                                  |1.00, 3.00     |
|Unknown                              |1,205          |
|__Urban__                            |38,493 (81%)   |
|Unknown                              |308            |

: Baseline demographic statistics {#tbl-table-demography}


@tbl-table-demography presents baseline demographic statistics for couples who met inclusion criteria.




##  Appendix C: Treatment Statistics {#appendix-exposures}


```{r}
#| label: tbl-table-exposures-code
#| tbl-cap: "Exposures at baseline and baseline + 1 (treatment) wave"
#| eval: false
#| echo: false
#| include: false
table_exposures <-margot::here_read("table_exposures")

#table_exposures |>  kbl(format = "markdown")
```



|**Exposure Variables by Wave** |**2018**, N = 47,948 |**2019**, N = 47,948 |
|:------------------------------|:--------------------|:--------------------|
|__Religion Church Round__      |NA                   |NA                   |
|0                              |38,479 (83%)         |28,671 (84%)         |
|1                              |1,517 (3.3%)         |916 (2.7%)           |
|2                              |1,125 (2.4%)         |751 (2.2%)           |
|3                              |907 (2.0%)           |651 (1.9%)           |
|4                              |2,478 (5.3%)         |1,700 (5.0%)         |
|5                              |475 (1.0%)           |312 (0.9%)           |
|6                              |326 (0.7%)           |209 (0.6%)           |
|7                              |106 (0.2%)           |71 (0.2%)            |
|8                              |964 (2.1%)           |655 (1.9%)           |
|Unknown                        |1,571                |14,012               |
|__Alert Level Combined__       |NA                   |NA                   |
|no_alert                       |47,948 (100%)        |24,789 (71%)         |
|early_covid                    |0 (0%)               |3,902 (11%)          |
|alert_level_1                  |0 (0%)               |3,010 (8.7%)         |
|alert_level_2                  |0 (0%)               |865 (2.5%)           |
|alert_level_2_5_3              |0 (0%)               |569 (1.6%)           |
|alert_level_4                  |0 (0%)               |1,648 (4.7%)         |
|Unknown                        |0                    |13,165               |

: Baseline and treatment wave descriptive statistics {#tbl-table-exposures}


@tbl-table-exposures presents baseline (NZAVS time 10) and exposure wave (NZAVS time 11) statistics for the exposure variable: religious service attendance (range 0-8). Responses coded as eight or above were coded as "8". This decision to avoid spare treatments was based on theoretical grounds, namely, that daily exposure would be similar in its effects to more than daily exposure. We note that causal contrasts were obtained for projects at either no attendance or four-or-more visits per month. Hence this simplification of the measure is unlikely to affect theoretical and practical inferences. Because the treatment wave (NZAVS time 11) occurred in New Zealand's COVID-19 pandemic, all models adjusted for the pandemic alert-level. The pandemic is not a "confounder" because a confounder must be related to the treatment and the outcome. At the end of the study, all participants had been exposed to the pandemic.  However, to satisfy the causal consistency assumption, all treatments must be conditionally equivalent within levels of all covariates [@vanderweele2013]. Because COVID affected the ability or willingness of individuals to attend religious service, we included the lockdown condition as a covariate [@sibley2012a]. To better enable conditional independence within levels of the treatment variable, we conditioned on the lead value of COVID-alert level at baseline. To mitigate systematic biases arising from attrition, and missingness, the `lmtp` package uses inverse probability of censoring weights, which were used when estimating the causal effects of the exposure on the outcome. 



### Binary Transition Table for The Treatment

```{r}
#| label: transition-table
#| eval: false
#| echo: false

transition_table_binary_gain <-margot::here_read("transition_table_binary_gain")

#transition_table
```

The table presents a transition matrix to evaluate treatment shifts between baseline and treatment wave. Here we focus on the shift from/to monthly attendance at four or more visits per month. Entries along the diagonal (in bold) indicate the number of individuals who **stayed** in their initial state. By contrast, the off-diagonal shows the transitions from the initial state (bold) to another state in the following wave (off diagonal). Thus the cell located at the intersection of row $i$ and column $j$, where $i \neq j$, gives us the counts of individuals moving from state $i$ to state $j$.


|   From    | < weekly  | >= weekly |
|:---------:|:---------:|:---------:|
| < weekly  | **29496** |    669    |
| >= weekly |    804    | **2229**  |



### Imbalance of Confounding Covariates Treatments 

@fig-match_1 shows imbalance of covariates on the treatment at the first wave

```{r}
#| label: fig-match_1
#| fig-cap: "Figure imbalance of covariates at the first exposure (baseline) wave"
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

love_plot_base <- margot::here_read("love_plot_base")
love_plot_base
```


@fig-match_2 shows imbalance of covariates on the treatment at the second exposure. Note that church attendance at the first wave shows the strongest relationship with church attendance at the second wave.  At both waves, the `lmtp` automatically adjusts for all covariates, including the exposure at the previous wave. At both waves the natural value of the exposure is used to estimate the policy-level of the exposure. 


```{r}
#| label: fig-match_2
#| fig-cap: "Figure imbalance of covariates at the second exposure (baseline + 1) wave"
#| eval: true
#| include: true
#| echo: false
#| fig-width: 10
#| fig-height: 6

love_plot <- margot::here_read("love_plot")
love_plot
```



##  Appendix D: Baseline and End of Study Outcome Statistics {#appendix-outcomes}


```{r}
#| label: tbl-table-demographic_vars-code
#| tbl-cap: "Outcomes at baseline and end-of-study"
#| eval: false
#| echo: false
#| include: false
table_outcomes <-margot::here_read("table_outcomes")
table_outcomes |>  kbl(format = "markdown")

```

|**Outcome Variables by Wave**     |**2018**, N = 47,948 |**2020**, N = 47,948 |
|:---------------------------------|:--------------------|:--------------------|
|__Annual Charity__                |120 (25, 500)        |200 (20, 520)        |
|Unknown                           |3,181                |16,514               |
|__Community Gives Money Binary__  |205 (0.4%)           |144 (0.5%)           |
|Unknown                           |2,074                |16,836               |
|__Community Gives Time Binary__   |2,389 (5.2%)         |1,934 (6.2%)         |
|Unknown                           |2,074                |16,836               |
|__Family Gives Money Binary__     |2,802 (6.1%)         |1,477 (4.7%)         |
|Unknown                           |2,074                |16,836               |
|__Family Gives Time Binary__      |13,590 (30%)         |8,867 (29%)          |
|Unknown                           |2,074                |16,836               |
|__Friends Give Money Binary__     |589 (1.3%)           |321 (1.0%)           |
|Unknown                           |2,074                |16,836               |
|__Friends Give Time Binary__      |8,201 (18%)          |5,664 (18%)          |
|Unknown                           |2,074                |16,836               |
|__Sense Neighbourhood Community__ |NA                   |NA                   |
|1                                 |3,025 (6.3%)         |1,383 (4.3%)         |
|2                                 |5,953 (12%)          |3,252 (10%)          |
|3                                 |7,033 (15%)          |4,283 (13%)          |
|4                                 |9,911 (21%)          |6,961 (22%)          |
|5                                 |9,924 (21%)          |7,625 (24%)          |
|6                                 |8,055 (17%)          |5,921 (19%)          |
|7                                 |3,781 (7.9%)         |2,503 (7.8%)         |
|Unknown                           |266                  |16,020               |
|__Social Belonging__              |5.33 (4.33, 6.00)    |5.00 (4.33, 6.00)    |
|Unknown                           |450                  |16,114               |
|__Social Support__                |6.33 (5.33, 7.00)    |6.33 (5.33, 7.00)    |
|Unknown                           |38                   |15,919               |
|__Volunteering Hours__            |0.00 (0.00, 1.00)    |0.00 (0.00, 1.00)    |
|Unknown                           |1,538                |16,738               |
|__Volunteers Binary__             |12,905 (28%)         |8,004 (26%)          |
|Unknown                           |1,538                |16,738               |

: Outcomes measured at baseline and end-of-study  {#tbl-table-outcomes}

@tbl-table-outcomes presents baseline and end-of-study descriptive statistics for the outcome variables.  









## References {.appendix}




