---
title: "Religious Service Attendance Increases Meaning, Gratitude, and Sexual Satisfaction (But Not Much Else) in Secular New Zealand."
abstract: |
  We use nationally representative longitudinal data from 46,377 New Zealanders (2018–2023) to estimate the causal effects of religious service attendance on multiple dimensions of well-being. We compare two hypothetical four-year scenarios: (a) everyone attends services at least four times per month, and (b) no one attends. We adjust for baseline covariates measured before these interventions, including baseline service attendance and baseline measurements of multi-dimensional well-being. We also adjust for time-varying counfounders such as employment, disability, relationships, and parenting. We assess outcomes in the year following these sequential treatment regimes. Using cross-validation and doubly robust machine-learning estimators, along with inverse probability-of-censoring weights, we find that regular attendance increases a sense of meaning and purpose, enhances gratitude, and, somewhat unexpectedly, improves sexual satisfaction. Effects on mental health are modest, while effects on biological health and social well-being are negligible or small. In a largely secular population, attending religious services regularly boosts purpose, nurtures gratitude, and raises sexual satisfaction, yet yields few other clear benefits. 
  **KEYWORDS**: *Causal Inference*; *Church*; *Cross-validation*; *Distress*; *Health*; *Longitudinal*; *Machine Learning*; *Religion*; *Semi-parametric*; *Targeted Learning*.
author: 
  - name: Joseph A. Bulbulia
    affiliation: Victoria University of Wellington, New Zealand
    orcid: 0000-0002-5861-2056
    email: joseph.bulbulia@vuw.ac.nz
    corresponding: yes
  - name: Don E Davis
    affiliation: Georgia State University, Matheny Center for the Study of Stress, Trauma, and Resilience
    orcid: 0000-0003-3169-6576 
  - name: Cyrstal Park
    affiliation: Univeristy of Conneticut, Department of Psychological Sciences
    orcid: 0000-0001-6572-7321
    email: crystal.park@uconn.edu
  - name: Kenneth G. Rice
    affiliation: Georgia State University, Matheny Center for the Study of Stress, Trauma, and Resilience
    orcid: 0000-0002-0558-2818
  - name: Geoffrey Troughton
    affiliation: School of Social and Cultural Studies, Victoria University of Wellington
    orcid: 0000-0001-7423-0640
  - name: Daryl Van Tongeren
    affiliation: Hope College
    orcid: 0000-0002-1810-9448
  - name: Chris G. Sibley
    affiliation: School of Psychology, University of Auckland
    orcid: 0000-0002-4064-8800
keywords: [Use, use]
editor_options: 
    chunk_output_type: console
format:
  pdf:  
    bibliography: /Users/joseph/GIT/templates/bib/references.bib
    pdf-engine: lualatex
    sanitise: true
    keep-tex: true
    link-citations: true
    colorlinks: true
    documentclass: article
    classoption: [single column]
    lof: false
    lot: false
    geometry:
      - top=30mm
      - left=25mm
      - heightrounded
      - headsep=22pt
      - headheight=11pt
      - footskip=33pt
      - ignorehead
      - ignorefoot
    template-partials: 
      - /Users/joseph/GIT/templates/quarto/title.tex
      - /Users/joseph/GIT/templates/measures/data
    header-includes:
      - \input{/Users/joseph/GIT/latex/latex-for-quarto.tex}
      - \let\oldtabular\tabular
      - \renewcommand{\tabular}{\small\oldtabular}
      - \setlength{\tabcolsep}{4pt}  % Adjust this value as needed
date: last-modified
execute:
  echo: false
  warning: false
  include: true
  eval: true
fontfamily: libertinus
bibliography: /Users/joseph/GIT/templates/bib/references.bib
csl: /Users/joseph/GIT/templates/csl/camb-a.csl
---

```{r}
#| label: load-libraries
#| echo: false
#| include: false
#| eval: true

# detach("package:margot", unload = TRUE)
#devtools::install_github("go-bayes/boilerplate")
# for making graphs
#   docx:
#    default: false
# reproducibility
set.seed(123)

# for latex graphs
# for making graphs
library("tinytex")
library("extrafont")
library("tidyverse")
library("kableExtra")
library("gtsummary")


# fonts
loadfonts(device = "all")

# rendering document
library("margot")
library("boilerplate")
library("glue")
library("patchwork")
library("kableExtra")
library("stringr")
library("ggplot2")
library("ggeffects")
library("parameters")
library("table1")
library("printr")
packageVersion(pkg = 'margot')

# measures path
measures_path <- fs::path_expand("/Users/joseph/GIT/templates/measures/data/merged_db.rds")

# read measures data
measures_data <- read_rds(measures_path)
measures_data
# set data paths
push_mods <- here::here("/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/24-jb-church-fl-long")

# read variable names
baseline_vars <- margot::here_read("baseline_vars")
exposure_var <- margot::here_read("exposure_var")
outcome_vars <- margot::here_read("outcome_vars")


# read by domain
raw_outcomes_health <- here_read("raw_outcomes_health")
raw_outcomes_psych <- here_read("raw_outcomes_psych")
raw_outcomes_present <- here_read("raw_outcomes_present")
raw_outcomes_life <- here_read("raw_outcomes_life")
raw_outcomes_social <- here_read("raw_outcomes_social")


# exposure
raw_exposure_vars = "religion_church"

# baseline vars
baseline_vars

# exposure
raw_exposure_vars

#outcomes
raw_outcomes_health

# labels
var_labels_baseline <- c(
  "sdo" = "Social Dominance Orientation",
  "born_nz_binary" = "Born in NZ",
  "rural_gch_2018_l" = "Rural Gch 2018 Levels",
  "education_level_coarsen" = "Education Level",
  "employed_binary" = "Employed (binary)",
  "eth_cat" = "Ethnicity",
  "household_inc" = "Household Income",
  "log_household_inc" = "Log Household Income",
  "male_binary" = "Male (binary)",
  "nz_dep2018" = "NZ Deprevation Index 2018",
  "nzsei_13_l" = "NZSEI (Occupational Prestige Index)",
  "parent_binary" = "Parent (binary)",
  "rwa" = "Right Wing Authoritarianism",
  "sample_frame_opt_in_binary" = "Sample Frame Opt-In (binary)",
  "sdo" = "Social Dominance Orientation",
  "smoker_binary" = "Smoker (binary)",
  "support" = "Social Support (perceived)"
)


# labels
label_mapping_raw_exposure = c("religion_church" = "Monthly Religious Service")


# labels
label_mapping_raw_exposure = c("religion_church" = "Monthly Religious Service")

# outcomes
label_mapping_raw_health <- list(
  "hlth_bmi" = "BMI", 
  "hlth_sleep_hours" = "Sleep", 
  "log_hours_exercise" = "Hours of Exercise (log)",
  "short_form_health" = "Short Form Health" 
)

label_mapping_raw_psych<- list(
  "hlth_fatigue" = "Fatigue", 
  "kessler_latent_anxiety" = "Anxiety", 
  "kessler_latent_depression" = "Depression",  
  "rumination" = "Rumination"
)

label_mapping_raw_present<- c(
  "bodysat" = "Body Satisfaction",
  "foregiveness" = "Forgiveness",
  "perfectionism" = "Perfectionism",  
  "pwb_standard_living" = "PWB Standard Living", 
  "pwb_your_future_security", 
  "pwb_your_health" = "PWB Your Health", 
  "pwb_your_relationships" = "PWB Your Relationships",
  "self_control_have_lots" = "Self Control Have Lots", 
  "self_control_wish_more_reversed" = "Self Control Wish More Reversed",  
  "self_esteem" = "Self Esteem", 
  "sexual_satisfaction" = "Sexual Satisfaction"  )

label_mapping_raw_life <- list(
  "gratitude" = "Gratitude", 
  "lifesat" = "Life Satisfaction", 
  "meaning_purpose" = "Meaning: Purpose", 
  "meaning_sense" = "Meaning: Sense"
)

label_mapping_raw_social <- list(
  "belong" = "Belonging",
  "neighbourhood_community" = "Community Belonging", 
  "support" = "Support" 
)


label_mappings <- list(
  baseline = var_labels_baseline,
  exposure = label_mapping_raw_exposure,
  health = label_mapping_raw_health,
  psychological = label_mapping_raw_psych,
  present = label_mapping_raw_present,
  life = label_mapping_raw_life,
  social = label_mapping_raw_social
)


all_outcomes <- list(
  health = raw_outcomes_health,
  psychological = raw_outcomes_psych,
  present_focused = raw_outcomes_present,
  life_focused = raw_outcomes_life,
  social = raw_outcomes_social
)

appendix_text_version_1 <- boilerplate_measures(
  baseline_vars = baseline_vars,
  exposure_var = raw_exposure_vars,
  outcome_vars = all_outcomes,
  measure_data = measures_data,
  label_mappings = label_mappings
  )

cat(appendix_text_version_1)

# reproducibility
set.seed(123)

# import untransformed data for graphs
original_df <- margot::here_read_qs('df_wide_impute', push_mods)

# summary tables
summary_tables <- margot::here_read_qs("summary_tables", push_mods)

# read nzavs timeline
timeline_histogram <- margot::here_read_qs("timeline_histogram", push_mods)
timeline_histogram
# read latex tables
latex_table_baseline <- here_read("latex_table_baseline")
latex_table_exposures <- here_read("latex_table_exposures")
latex_table_outcomes_health <- here_read("latex_table_outcomes_health")
latex_table_outcomes_psych <- here_read("latex_table_outcomes_psych")
latex_table_outcomes_present <- here_read("latex_table_outcomes_present")
latex_table_outcomes_life <- here_read("latex_table_outcomes_life")
latex_table_outcomes_social <- here_read("latex_table_outcomes_social")




# read exposure vars names
t0_name_exposure <- here_read('t0_name_exposure')
t1_name_exposure <- here_read('t1_name_exposure')
t2_name_exposure <- here_read('t2_name_exposure')
t3_name_exposure <- here_read('t3_name_exposure')
t4_name_exposure <- here_read('t4_name_exposure')

# names of waves
baseline_wave <- margot::here_read("baseline_wave")
exposure_waves <- margot::here_read("exposure_waves")
outcome_wave <- margot::here_read("outcome_wave")


## Read in data from analysis 
# imports
n_total <-  margot::here_read("n_total")

# total
n_total

# participants
n_participants <- summary_tables$n_participants

# make pretty number
n_participants<- prettyNum(n_participants,big.mark=",")
n_total<- prettyNum(n_total,big.mark=",")

# participants
n_participants

# library
library(margot)

# verify positivity 
#church
#transition_table
# binary
transition_matrix <- margot::here_read("transition_matrix")


# label mapping
# label mappings for health outcomes
label_mapping_health <- list(
  "t5_hlth_bmi_z" = "BMI", 
  "t5_hlth_sleep_hours_z" = "Sleep", 
  "t5_log_hours_exercise_z" = "Hours of Exercise (log)",
  "t5_short_form_health_z" = "Short Form Health" 
)

# label mappings for psychological well-being outcomes
label_mapping_psych <- list(
  "t5_hlth_fatigue_z" = "Fatigue", 
  "t5_kessler_latent_anxiety_z" = "Anxiety", 
  "t5_kessler_latent_depression_z" = "Depression",  
  "t5_rumination_z" = "Rumination"
)

# label mappings for present reflective outcomes
label_mapping_present <- list(
  "t5_bodysat_z" = "Body Satisfaction",
  "t5_foregiveness_z" = "Forgiveness",  
  "t5_perfectionism_z" = "Perfectionism",  
  "t5_pwb_standard_living_z" = "PWB Standard Living", 
  "t5_pwb_your_future_security_z" = "PWB Your Future Security", 
  "t5_pwb_your_health_z" = "PWB Your Health", 
  "t5_pwb_your_relationships_z" = "PWB Your Relationships",
  "t5_self_control_have_lots_z" = "Self Control Have Lots", 
  "t5_self_control_wish_more_reversed_z" = "Self Control Wish More Reversed",  
  "t5_self_esteem_z" = "Self Esteem", 
  "t5_sexual_satisfaction_z" = "Sexual Satisfaction"
)

# label mappings for life reflective outcomes
label_mapping_life <- list(
  "t5_gratitude_z" = "Gratitude", 
  "t5_lifesat_z" = "Life Satisfaction", 
  "t5_meaning_purpose_z" = "Meaning: Purpose", 
  "t5_meaning_sense_z" = "Meaning: Sense"
)

# label mappings for social outcomes
label_mapping_social <- list(
  "t5_belong_z" = "Belonging",
  "t5_neighbourhood_community_z" = "Community", 
  "t5_support_z" = "Support" 
)




# plot options ------------------------------------------------------------
nice_exposure_name <- glue::glue("Monthly Religious Service")
title <- glue::glue("Causal Effects of {nice_exposure_name} on Multi-Dimensional Well-Being")


options_base <- list(
  type = "RD",
  title = title,
  order  = "alphabetical",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -1.05, # will be set based on type
  x_lim_lo = -1, # will be set based on type
  x_lim_hi = .6, # will be set based on typee
  text_size = 6,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 20,
  point_size = 5,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10
)


# plote options
options_health_religious_vs_secular <- margot_plot_create_options(
  subtitle = "Health: Religious vs Secular (baseline)",
  base_defaults = options_base,
  title = title,
  filename_prefix = "health_religious_vs_secular"
)

options_psych_religious_vs_secular <- margot_plot_create_options(
  subtitle = "Psychological Wellbeing: Religious vs Secular (baseline)",
  base_defaults = options_base,
  title = title,
  filename_prefix = "psych_religious_vs_secular"
)


options_present_religious_vs_secular <- margot_plot_create_options(
  subtitle = "Present Wellbeing: Religious vs Secular (baseline)",
  base_defaults = options_base,
  title = title,
  filename_prefix = "present_religious_vs_secular"
)

options_life_religious_vs_secular <- margot_plot_create_options(
  subtitle = "Life Wellbeing: Religious vs Secular (baseline)",
  base_defaults = options_base,
  title = title,
  filename_prefix = "life_religious_vs_secular"
)


options_social_religious_vs_secular <- margot_plot_create_options(
  subtitle = "Social Wellbeing: Religious vs Secular (baseline)",
  base_defaults = options_base,
  title = title,
  filename_prefix = "social_religious_vs_secular"
)


# read models
health_lmtp_output <- margot::here_read_qs('health_lmtp_output', push_mods)
psych_lmtp_output <- margot::here_read_qs('psych_lmtp_output', push_mods)
present_lmtp_output <- margot::here_read_qs('present_lmtp_output', push_mods)
life_lmtp_output<- margot::here_read_qs('life_lmtp_output', push_mods)
social_lmtp_output <- margot::here_read_qs('social_lmtp_output', push_mods)

# graphs

# religion vs secular: health
health_religious_vs_secular <- margot_plot(
   health_lmtp_output$combined_tables$combined_outcomes_religious_vs_secular,
   options = options_health_religious_vs_secular,
   save_output = TRUE,
   label_mapping = label_mapping_health,
   save_path = here::here(push_mods),
   original_df = original_df
 )



# religion vs secular: psych
psych_religious_vs_secular <- margot_plot(
  psych_lmtp_output$combined_tables$combined_outcomes_religious_vs_secular,
  options = options_psych_religious_vs_secular,
  save_output = TRUE,
  label_mapping = label_mapping_psych,
  save_path = here::here(push_mods),
  original_df = original_df
)



# religion vs secular: present
present_religious_vs_secular <- margot_plot(
  present_lmtp_output$combined_tables$combined_outcomes_religious_vs_secular,
  options = options_present_religious_vs_secular,
  save_output = TRUE,
  label_mapping = label_mapping_present,
  save_path = here::here(push_mods),
  original_df = original_df
)


# religion vs secular: life
life_religious_vs_secular <- margot_plot(
  life_lmtp_output$combined_tables$combined_outcomes_religious_vs_secular,
  options = options_life_religious_vs_secular,
  save_output = TRUE,
  label_mapping = label_mapping_life,
  save_path = here::here(push_mods),
  original_df = original_df
)


# religion vs secular: life
social_religious_vs_secular <- margot_plot(
  social_lmtp_output$combined_tables$combined_outcomes_religious_vs_secular,
  options =  options_social_religious_vs_secular,
  save_output = TRUE,
  label_mapping = label_mapping_social,
  save_path = here::here(push_mods),
  original_df = original_df
)


# plots
# health_religious_vs_secular$plot
# psych_religious_vs_secular$plot
# present_religious_vs_secular$plot
# life_religious_vs_secular$plot
# social_religious_vs_secular$plot
```


## Introduction

Religious participation is a core aspect of many cultures, and the question of whether attending religious services influences human well-being is longstanding [@koenig2012handbook; @park2005religion]. Within religious traditions, the belief that religious practices benefit adherents permeates theology, moral teaching, and community life, from Buddhism's emphasis on meditation as a path to enlightenment and reduced suffering, to Christianity's view of prayer and worship as means of spiritual growth and divine connection, to Indigenous spiritual practices that are seen as maintaining harmony between people, nature, and the sacred. More recently, secular empirical research has linked religious service attendance with multiple dimensions of well-being, including social integration, life satisfaction, mental health, and meaning-making [@vanderweele2022invited_church; @chen2020religious; @dunbar2021religiosity; @highland2022national]. These studies have demonstrated that, on average, individuals who attend services report more favourable social and psychological outcomes.

Although some studies have strengthened causal claims through appropriate causal methods [@pawlikowski2019religious; @vanderweele2021effectsReligiousServiceMetanalysis; @vanderweele2020vchenrespond; @vanderweelechurchmortality], concerns about causality persist [@highland2019attitudes]. Many investigations do not fully adjust for baseline health and baseline religious service, or important confounders that shape both religious engagement and well-being [@brown2023_church; @jokela2024_church]. For example, Jokela and Laakasuo’s analysis of four U.S. cohort studies (N=6,592) found that poorer health trajectories came before, rather than followed, religious disengagement. This suggests that declining religious practice might track pre-existing health problems rather than cause them. Similarly, global data from Iyer and Rosso (N=65,564) show that frequent attenders report about five percentage points higher life satisfaction than infrequent attenders; however, this association could reflect unmeasured biases or reverse causation. Chen and colleagues observe that well-being itself is multifaceted, spanning emotional, physical, social, and psychological domains, and that some domains -- such as meaning, purpose, and social connection -- may be more affected than others [@chen2022_church_longitudinal].

Despite these efforts, many questions remain. Existing research often relies on non-representative samples or predominantly religious environments, seldom fully addresses time-varying confounding, and rarely considers populations in which religious engagement is relatively low. Brown et al. hypothesise that community-building itself, rather than specifically religious community-building, may drive any observed well-being benefits. Natural-experimental evidence from New Zealand supports this notion [@brown2023_church]. Following the 2010–2011 Christchurch earthquakes, those who maintained or lacked faith reported similar levels of subjective health, whereas those who lost faith showed declines in subjective health [@sibley2012]. These patterns suggest that the community context -- religious or not -- may be critical.

In sum, there is a need for studies that move beyond cross-sectional correlations to address causation, address causation robustly, and systematically evaluate multiple dimensions of well-being [@vanderweele2020]. Without such evidence, policy, clinical, and theoretical questions about the causal role of religious service attendance in supporting human flourishing remain unanswered.

Here, we improve understanding by estimating the causal effects of regular religious service attendance on multidimensional well-being using data from a large, nationally diverse sample of New Zealanders (baseline $N=46,377$) enrolled in the New Zealand Attitudes and Values Study (NZAVS). New Zealand is characterised by high religious diversity and secularisation. Over half the population identifies as having no religion, while multiple religious traditions -- Christianity, Hinduism, Islam, Buddhism, and others -- coexist [@shaver2016religion]. Drawing on an informationally rich national panel study and recent innovations in causal inference [@hernan2024WHATIF; @williams2021; @bulbulia2023], we systematically examine whether a settings in which the adult population attended services regularly differs in its affects across multi-dimensional well-being from a setting in which no-one attends. We estimation these effects using a workflow in which non-parementric machine learning reduces statistical modelling assumptions. We contribute to understanding by estimating causal effects in a distinctly secular, and culturally diverse context, and obtain generalisable inferences about whether, and where, religious service attendance causally affects a well-being phenotype across dimensions of biological health, psychological health, person-focussed well-being, life-focussed well-being and social well-being. 

## Method

### Sample


Data were collected as part of the New Zealand Attitudes and Values Study (NZAVS), an annual longitudinal national probability panel assessing New Zealand residents’ social attitudes, personality, ideology, and health outcomes. The panel began in 2009 and has since expanded to include over fifty researchers, with responses from `r n_total` participants to date. The study operates independently of political or corporate funding and is based at a university. It employs prize draws to incentivise participation. The NZAVS tends to slightly under-sample males and individuals of Asian descent and to over-sample females and Māori (the Indigenous people of New Zealand). To enhance representativeness of the target population, we apply Census-based survey weights that adjust for age, gender, and ethnicity (New Zealand European, Asian, Māori, Pacific) [@sibley2021].
For more information about the NZAVS, visit: [OSF.IO/75SNB](https://doi.org/10.17605/OSF.IO/75SNB). The data for this study were obtained from the NZAVS waves 10-15 cohort, covering years 2018-2024. Although this cohort is a national probability sample, we weighted responses by New Zealand 2018 Census estimates (age, gender, ethnicity) to produce results that better reflect the New Zealand population. Information on these survey weights can be found in the NZAVS documentation, see: [OSF.IO/75SNB](https://doi.org/10.17605/OSF.IO/75SNB). Refer to [Appendix A](#appendix-timeline) for a histogram of daily responses for this cohort.


### Target Population

The target population for this study comprises the cohort of New Zealand residents in New Zealand Attitudes and Values Study wave 10 (years 2018-2019) [@sibley2021].

### Treatment Indicator


We assessed religious service attendance using the following question:


- *Do you identify with a religion and/or spiritual group? If yes, how many times did you attend a church or place of worship during the last month?*


Responses were rounded to the nearest whole number. Because few participants reported attending more than eight times, we capped responses above eight at eight (see Appendix B, variable `religion_church_round`). In the regular church service condition, we did not intervene on responses greater than four to reduce computational burdens during estimation.


### Outcomes

### Baseline Covariates

We controlled for a broad range of baseline variables measured at Wave 10 (2018–2019) to reduce confounding by demographic, personality, and behavioural factors (see Appendix for full measures). These included age, gender, ethnicity, education level, personality traits (Agreeableness, Conscientiousness, Extraversion, Honesty-Humility, Neuroticism, and Openness), household income, employment status, parenting status, relationship status, religious belonging, and health-related behaviours (e.g. smoking, alcohol use, hours spent exercising). We also controlled for all outcome measures and for religious service attendance at baseline to minimise reverse causation (refer to [Appendix B](appendix-baseline)).

### Exposure

The primary exposure was religious service attendance. We assessed how often participants attended any church or place of worship during the study period, creating an intervention that either shifted attendance to at least monthly or set attendance to zero.

### Outcomes

We categorised outcomes into five domains—health, psychological well-being, present-reflective outcomes, life-reflective outcomes, and social outcomes—based on validated scales and measures. Table 1 summarises each domain and its associated measures. For instance, health outcomes included BMI and hours of sleep, whereas psychological well-being encompassed anxiety and depression. Outcomes were standardised where appropriate (i.e. converted to z-scores) to facilitate comparison.

| Domain          | Example Measures                           |
|-----------------|--------------------------------------------|
| Health          | BMI, Hours of Sleep, Hours of Exercise, SF-Health   |
| Psychological Well-Being | Anxiety, Depression, Fatigue, Rumination         |
| Present-Reflective        | Body Satisfaction, Forgiveness, Self Esteem, Sexual Satisfaction |
| Life-Reflective           | Gratitude, Life Satisfaction, Meaning (Sense & Purpose)           |
| Social                    | Belonging, Support, Community                            |


Data summaries for all measures used in this study are provided in [Appendix B](appendix-baseline).

## Causal Interventions

When psychologists model time-series data, they often use growth models to quantify patterns of change over time. However, many research questions are causal: we want to know what would happen if we could intervene on certain variables (e.g., religious service attendance). To study these questions using observational time-series data, we must clearly state our causal question. Here, we ask:

> "What if, at each wave, we intervened to set religious service attendance to a certain level, and then measured everyone's well-being at the final wave?"

We compare two hypothetical interventions that alter religious service attendance over four exposure waves (Waves 1–4), with outcomes measured at Wave 5, and controlling for a rich set of baseline covariates measured at Wave 0. In line with the modified treatment policies literature, we define **shift functions** to describe each regime. 

1. **Regular Religious Service Attendance**  
   At each wave, if a person's attendance is below four times per month, we shift it up to four; otherwise, we leave it unchanged.

2. **No Religious Service Attendance**  
   At each wave, if a person's attendance is above zero, we shift it down to zero; otherwise, we leave it unchanged.

A confounder is a variable that when included in the the model, removes any non-causal association between a 'treatment' and 'outcome'. Here, we adjust for important confounders at the baseline wave (Wave 0). We also adjust for the following time-varying confounders at each wave: physical disability, employment, partner status, and parenting status. These factors may, independently of baseline measurements, influence both attendance at each wave and later outcomes.

### Notation

- $A_k$: Observed religious service attendance at Wave $k$, for $k = 1, \dots, 4$.  
- $Y_\tau$: Outcome measured at the end of the study (Wave 5).  
- $W_0$: Confounders measured at baseline (Wave 0).  
- $L_k$: Time-varying confounders measured at Wave $k$ (for $k = 1, \dots, 4$).  

### Shift Functions

Let $\boldsymbol{d}(a_k)^+$ represent the **regular attendance** treatment sequence and $\boldsymbol{d}(a_k)^-$ the **no attendance** treatment sequence, where the interventions occure at each wave $k = 1\dots 4$. Formally:

#### Regular Attendance Regime $\bigl(\boldsymbol{d}(a_k^+)\bigr)$

$$
\boldsymbol{d}(a_k^+) 
\;=\; 
\begin{cases}
4, & \text{if } A_k < 4,\\[6pt]
A_k, & \text{otherwise.}
\end{cases}
$$

#### No Attendance Regime $\bigl(\boldsymbol{d}(a_k^-)\bigr)$

$$
\boldsymbol{d}(a_k^-) 
\;=\; 
\begin{cases}
0, & \text{if } A_k > 0,\\[6pt]
A_k, & \text{otherwise.}
\end{cases}
$$

Here, $A_k$ is the observed attendance at Wave $k$. The shift function $\boldsymbol{d}$ 'nudges' $A_k$ to a target level (four times per month or zero) only if the current value is below (for regular attendance) or above (for no attendance) that target. Across the four waves, these shifts form a sequence $\boldsymbol{\bar{d}}$, which defines a complete intervention regime.


::: {#tbl-intervention}
```{=latex}
\tvtable
```
Causal diagrams showing sources of bias in a three wave panel study.
:::


### Causal Contrast

We compare the average well-being under the **regular attendance** regime, $\boldsymbol{\bar{d}}(a^+)$, to the average well-being under the **no attendance** regime, $\boldsymbol{\bar{d}}(a^-)$. Specifically, the average treatment effect (ATE) is given:

$$
\text{ATE}^{\text{wellbeing}} 
\;=\; 
\mathbb{E}
\Bigl[
  Y_\tau\!\bigl(\boldsymbol{\bar{d}}(a^+)\bigr) 
  \;-\; 
  Y_\tau\!\bigl(\boldsymbol{\bar{d}}(a^-)\bigr)
\Bigr].
$$

### Assumptions

To estimate this effect from observational data, we assume:

1. **Conditional Exchangeability:** Once we condition on $W_0$ and each $L_k$, the interventions $\boldsymbol{\bar{d}}(a^+)$ or $\boldsymbol{\bar{d}}(a^-)$ are effectively random with respect to potential outcomes.
2. **Consistency:** The potential outcome under a given regime matches the observed outcome when that regime is actually followed.
3. **Positivity:** Everyone has a non-zero probability of receiving each level of attendance (i.e., a chance to be 'shifted' up or down) given their covariates.

Mathematically, for conditional exchangeability, we write:

$$
\Bigl\{
  Y\bigl(\boldsymbol{d}(a^+)\bigr), 
  \; 
  Y\bigl(\boldsymbol{d}(a^-)\bigr)
\Bigr\}
\coprod
A_k |
L_k,
W_0.
$$

Under these assumptions, our statistical models permit us to estimate $\text{ATE}^{\text{wellbeing}}$ from observational data. Again, that contrast is 'regularly attend religious service at least four wave' versus 'never attend religious service at least four waves'.  Finally, we define the target population as the New Zealand Population from 2019-2024, the years in which measurements were taken. 

Although both growth models and causal inference methods can inform changes over time, they focus on different questions. Growth models quantify how individuals vary in their natural trajectories. In contrast, causal models explicitly ask: "What happens if we intervene?" By defining hypothetical interventions, adjusting for confounders, and specifying assumptions, researchers can rigorously address "what if" questions, bridging the gap between observational data and actionable insights. This approach opens new avenues for psychological scientists to design and evaluate interventions that might guide policy and practice with evidence.

### Statistical Estimator

We estimate the causal effect of modified treatment policies over time using a semi-parametric Sequential Doubly-Robust estimator from the `lmtp` package [@williams2021]. The SDR algorithm proceeds in two steps. First, machine learning algorithms flexibly model the relationships among treatments, covariates, and outcomes, allowing SDR to capture complex, high-dimensional covariate structures without strict model assumptions. This step yields an initial set of estimates [@díaz2021]. In the second step, SDR "targets" these initial estimates by incorporating observed data distribution information, improving the accuracy of the causal effect estimate through an iterative process. The SDR estimator is multiply robust for repeated treatments across multiple waves [@diaz2023lmtp; @hoffman2023], improving model robustness to misspecification in either the outcome or treatment model. The `lmtp` package relies on the `SuperLearner` library in R, which integrates diverse machine learning algorithms [@SuperLearner2023]. We used the `SL.ranger`, `SL.glmnet`, and `SL.xgboost` [@polley2023; @xgboost2023; @Ranger2017] learners. **`SL.ranger`**: implements a random forest algorithm that handles non-linear relationships and complex patterns, improving model accuracy but potentially increasing variance. **`SL.glmnet`**: provides regularised linear models that help manage high dimensionality and collinearity, effectively reducing model variance and improving stability. **`SL.xgboost`**: uses gradient boosting to optimize performance and capture complex interactions, balancing the model’s ability to explore data complexities without overfitting [@polley2023]. The ensemble approach of `superlearner` optimally combines predictions from these models. Graphs, tables and output reports were created using the `margot` package [@margot2024]. For further details of the targeted learning using `lmtp` see [@hoffman2022; @hoffman2023; @díaz2021].


## Sensitivity Analysis


We perform sensitivity analyses using the E-value metric [@vanderweele2017; @linden2020EVALUE]. The E-value represents the minimum association strength (on the risk ratio scale) that an unmeasured confounder would need to have with both the exposure and outcome—after adjusting for measured covariates—to explain away the observed exposure-outcome association [@vanderweele2020; @linden2020EVALUE].



## Results


### Health

```{r}
#| label: fig-health
#| fig-cap: "Health effects"
#| eval: true
#| echo: false
#| fig-height: 16
#| fig-width: 16

health_religious_vs_secular$plot
```

```{r}
#| label: tbl-health
#| tbl-cap: "Health effects"
#| eval: true
#| echo: false

health_religious_vs_secular$transformed_table|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


```{r, results = 'asis'}
cat(health_religious_vs_secular$interpretation)
```

{{< pagebreak >}}

### Psychological Well-Being

```{r}
#| label: fig-psych
#| fig-cap: "Effects on Psychological Well-Being"
#| eval: true
#| echo: false
#| fig-height: 16
#| fig-width: 16

psych_religious_vs_secular$plot
```

```{r}
#| label: tbl-psych
#| tbl-cap: "Effects on Psychological Well-Being"
#| eval: true
#| echo: false

psych_religious_vs_secular$transformed_table|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


```{r, results = 'asis'}
cat(psych_religious_vs_secular$interpretation)
```

{{< pagebreak >}}
### Life-Focussed Well-Being

```{r}
#| label: fig-present
#| fig-cap: "Effects on Person-Focussed Well-Being"
#| eval: true
#| echo: false
#| fig-height: 16
#| fig-width: 16

present_religious_vs_secular$plot
```

```{r}
#| label: tbl-present
#| tbl-cap: "Effects on Person-Focussed Well-Being"
#| eval: true
#| echo: false

present_religious_vs_secular$transformed_table|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


```{r, results = 'asis'}
cat(present_religious_vs_secular$interpretation)
```


{{< pagebreak >}}
### Life-Focussed Well-Being

```{r}
#| label: fig-life
#| fig-cap: "Effects on Life-Focussed Well-Being"
#| eval: true
#| echo: false
#| fig-height: 16
#| fig-width: 16

life_religious_vs_secular$plot
```

```{r}
#| label: tbl-life
#| tbl-cap: "Effects on Life-Focussed Well-Being"
#| eval: true
#| echo: false

life_religious_vs_secular$transformed_table|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


```{r, results = 'asis'}
cat(life_religious_vs_secular$interpretation)
```


{{< pagebreak >}}
### Social-Focussed Well-Being

```{r}
#| label: fig-social
#| fig-cap: "Effects on Life-Focussed Well-Being"
#| eval: true
#| echo: false
#| fig-height: 16
#| fig-width: 16

social_religious_vs_secular$plot
```

```{r}
#| label: tbl-social
#| tbl-cap: "Effects on Social Well-Being"
#| eval: true
#| echo: false

social_religious_vs_secular$transformed_table|>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


```{r, results = 'asis'}
cat(social_religious_vs_secular$interpretation)
```

{{< pagebreak >}}
## Discussion

Our findings suggest that regular religious service attendance can modestly enhance meaning, gratitude, and sexual satisfaction. Yet, our analysis also underscores the challenges of making strong causal claims in observational settings. The absence of consistent or robust evidence for many hypothesised effects does not mean that such effects do not exist. Uncertainty arises not only from possible residual confounding, but also from the likelihood that non-directed measurement error biases effects toward the null. In other words, failures to detect a relationship might owe to limitations in our measures rather than to a genuine absence of effect.

A further caveat is that causal effect estimates reflect a hypothetical scenario in which the entire target population either consistently attends services or never attends. This population-level contrast represents an average treatment effect; we have not examined how the causal effects of religious service attendance vary by faith tradition, intensity of belief, or cultural context. Such studies involve changing the target population from everyone to members of specific population strata or group. Moroever, at an individual level, different people will respond differently to religious behaviours, and we assume that people often know themselves best. Our findings project an average treatment effect of the adult population of New Zealand, which should not be confused with life advice.

One of our most robust findings is that religious engagement increases a sense of meaning and sense of purpose. Why this should be so remains speculative. Evolutionary accounts might question why, if meaning and purpose are biologically desirable, they are not universal 'default' states of consciousness. Why would the time and material investments of religious service attendance require our attention [@sosis2003cooperation]? Some scholars suggest that religious healing might function as a hard-to-fake signal that validates religious commitments, rather than as an evolutionary end in itself [@bulbulia2006nature]. Any evolutionary or functional explanations for why religious practice boosts meaning presently remains speculative, and must reckon with the complex cultural and biological processes that have given rise to and conserved the religions of our day.

Closely related to meaning is the finding that religious engagement fosters gratitude. In classical Christian thought dating at least to Aquinas, religion is framed as a virtue of justice called 'piety', which entails rightly acknowledging the sources of one's existence and sustenance as a debt that cannot be repaid [@bulbulia2023understanding]. In a modern idiom, one might refer to this virtue a 'gratitude'. Indeed, the rehearsal of gratitude is a prominent feature not only of Christian religious service but of most religious traditions [@mccullough2001gratitude; @bono2004gratitude]. It has been hypothesised that active attention to gratitude in religious faith serves to foster prosociality, which, if confirmed, would help to explain the durability of this result to robust causal estimation workflows that controls for confounding.

The positive causal association we observe between religious attendance and sexual satisfaction also raises intriguing questions. Prior research has documented associations between religiosity and marital sexual satisfaction [@dew2020joint], although these studies rely on cross-sectional data and cannot reliably infer causation. In line with that correlational literature, however, we find that religious service attendance causes modest improvements in sexual satisfaction, effects that remain after controlling for baseline values of both indicators. One possible explanation is that religious activities help align values, enhance communication, and foster stable social support networks within couples, thereby strengthening intimacy. Such intimacy is especially valuable for parenting—described as the ultimate cooperation problem because it involves demanding commitments that link biological fates [@bulbulia2015]. Yet there may be non-social mechanisms at work as well, and in general, the intersection of sex and religion remains under-examined [though see @shaver2020church; @shaver2024religious; @shaver2022integrating].

In conclusion, our results indicate that religious service attendance can enhance certain facets of well-being, particularly meaning and purpose, gratitude, and sexual satisfaction. These findings hold even in a secular-majority country. However, we find little evidence of broad effects on other well-being outcomes. Future research should focus on fine-grained analyses of heterogeneity in these effects, explore mechanistic pathways that explain how religius service affects well-being, and remain mindful that individual experience often resists sweeping generalisations, whether religious or otherwise, and that such benefits, or the absence of such benefits, will not hold for everyone equally.


### Ethics

The University of Auckland Human Participants Ethics Committee reviews the NZAVS every three years. Our most recent ethics approval statement is as follows: The New Zealand Attitudes and Values Study was approved by the University of Auckland Human Participants Ethics Committee on 26/05/2021 for six years until 26/05/2027, Reference Number UAHPEC22576.


### Data Availability

The data described in the paper are part of the New Zealand Attitudes and Values Study. Members of the NZAVS management team and research group hold full copies of the NZAVS data. A de-identified dataset containing only the variables analysed in this manuscript is available upon request from the corresponding author or any member of the NZAVS advisory board for replication or checking of any published study using NZAVS data. The code for the analysis can be found at: [OSF link](https://osf.io/wgtz4/). 


### Acknowledgements

The New Zealand Attitudes and Values Study is supported by a grant from the Templeton Religious Trust (TRT0196; TRT0418). JB received support from the Max Plank Institute for the Science of Human History. [**To be filled out for all authors**]. The funders had no role in preparing the manuscript or deciding to publish it.


### Author Statement


All authors had input into the manuscript. JB did the analysis and developed the approach. CGS led data collection. JB, DD, CGS, KR, at GT obtained funding.


{{< pagebreak >}}
## Appendix A: Daily Data Collection  {#appendix-timeline}

{{< pagebreak >}}

## New Zealand Attitudes and Values Study Data Collection (2018 retained cohort) {#appendix-daily} 

```{r}
#| label: fig-timeline
#| fig-cap: "Historgram of New Zealand Attitudes and Values Study Daily Data Collection: Time 11 - Time 15."
#| eval: true
#| include: true
#| echo: false
#| fig-width: 12
#| fig-height: 12
#| 


timeline_histogram
```


{{< pagebreak >}}
## Appendix B: Measures and Demographic Statistics {#appendix-baseline}


## Measures 

```{r, results='asis'}
cat(appendix_text_version_1)
```



### Sample Demographic Statistics


::: {#tbl-baseline}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

library(gtsummary)
library(kableExtra)

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_baseline |> 
  kable_styling(
    font_size = 6,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Demographic statistics for New Zealand Attitudes and Values Cohort waves 2018.
:::


### Exposure Variable: Religious Service Attendance  {#appendix-exposure} 

@tble-sample-exposures presents sample statistic for the exposure variable, religious service attendance, during the baseline wave and exposure waves. This variable was not measured in part of NZAVS time 12 (years 2020-2021) and part of NZAVS time 13 (years 2021-2022). To address missingness, we carried the previous observation forward, which may result in conservative causal effect estimation, however it would be unlike to bias estimation away from the null because the measurement error is random, and cannot be systematically related to the outcomes.  

::: {#tbl-sample-exposures}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_exposures |> 
  kable_styling(
    font_size = 12,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Demographic statistics for New Zealand Attitudes and Values Cohort waves 2018.
:::

{{< pagebreak >}}

### Outcome Variables {#appendix-outcomes} 


### Health Outcome Variables

::: {#tbl-sample-outcomes-health}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_outcomes_health |> 
  kable_styling(
    font_size = 12,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Health variables measured at baseline (NZAVS time 10, years 2018-2019, and time 15, years 2023-2024).
:::



### Psychological Well-Being Outcome Variables

::: {#tbl-sample-outcomes-psych}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_outcomes_psych |> 
  kable_styling(
    font_size = 12,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Psychological well-being variables measured at baseline (NZAVS time 10, years 2018-2019, and time 15, years 2023-2024).
:::



### Present-Focussed Well-Being Indicators

::: {#tbl-sample-outcomes-present}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_outcomes_present |> 
  kable_styling(
    font_size = 12,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Present-focussed well-being variables measured at baseline (NZAVS time 10, years 2018-2019, and time 15, years 2023-2024).
:::



### Life-Focussed Well-Being Indicators

::: {#tbl-sample-outcomes-life}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_outcomes_life |> 
  kable_styling(
    font_size = 12,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Life-reflective well-being variables measured at baseline (NZAVS time 10, years 2018-2019, and time 15, years 2023-2024).
:::


### Social Well-Being Indicators

::: {#tbl-sample-outcomes-social}
```{r, results = 'asis'}
#| eval: true
#| include: true
#| echo: false

# summary_tables$variables |> 
#   kbl(
#     format = "latex",
#     booktabs = TRUE,
#     digits = 2,
#     row.names = FALSE                      # remove row names to eliminate any unintended columns
#   ) 


latex_table_outcomes_social |> 
  kable_styling(
    font_size = 12,
    latex_options = c("hold_position", "repeat_header", "striped", "longtable")
   ) 

```
Life-reflective well-being variables measured at baseline (NZAVS time 10, years 2018-2019, and time 15, years 2023-2024).
:::


{{< pagebreak >}}
## Appendix C: Confouding Control 

::: {#tbl-02}
```{=latex}
\tvtable
```
Causal diagrams showing sources of bias in a three wave panel study.
:::

For confounding control, we employ a modified disjunctive cause criterion [@vanderweele2019], which involves:


1.	Identifying all common causes of both the treatment and outcomes.
2.	Excluding instrumental variables that affect the exposure but not the outcome.
3.	Including proxies for unmeasured confounders affecting both exposure and outcome.
4.	Controlling for baseline exposure and baseline outcome, serving as proxies for unmeasured common causes [@vanderweele2020].


The covariates included for confounding control are detailed in @table-exposure. This list adheres to the guidelines provided in [@bulbulia2024PRACTICAL] and were pre-specified in our study protocol [https://osf.io/ce4t9/](https://osf.io/ce4t9/). 

Where there are multiple exposures, causal inference may be threatened by time-varying confounding [@bulbulia_2024_swig_time]. 

{{< pagebreak >}}

## Appendix D Transition Matrix to Verify Positivity Assumption {#appendix-transition}


```{r, results = 'asis'}
#| label: tbl-transition
#| tbl-cap: "Transition Matrix Showing Change"
#| eval: true
#| include: true
#| echo: false

transition_matrix$table
```

```{r, results = 'asis'}
cat(transition_matrix$explanation)
```


{{< pagebreak >}}

## References {.appendix-refs}
