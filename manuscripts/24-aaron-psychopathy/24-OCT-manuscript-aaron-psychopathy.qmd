---
title: "Causal effect of Psychopathy on Partner Well-Being: A National Longitudinal Study"
abstract: |
author: 
  - name: Aaron Hissey
    affiliation: Victoria University of Wellington, New Zealand
    orcid_id: 0000-0000-0000-0000
    email: aaron.hissey@vuw.ac.nz
    corresponding: yes
  - name: Hedwig Eisenbarth
    affiliation: Victoria University of Wellington, New Zealand
    orcid_id: 0000-0000-0000-0000
    email: hedwig.eisenbarth@vuw.ac.nz
    corresponding: yes
  - name: Chris G. Sibley
    affiliation: School of Psychology, University of Auckland
    orcid_id: 0000-0002-4064-8800
  - name: Matthew Hammond
    affiliation: School of Psychology, University of Auckland
    orcid_id: 0000-0000-0000-0000
  - name: Joseph A. Bulbulia
    affiliation: Victoria University of Wellington, New Zealand
    orcid_id: 0000-0002-5861-2056
    email: joseph.bulbulia@vuw.ac.nz
keywords:
  - Causal Inference
  - Relationships
  - Panel
  - Psychopathy
  - Personality
  - Well-being
  - Outcome-wide
editor_options: 
  chunk_output_type: console
format:
  pdf:
    bibliography: /Users/joseph/GIT/templates/bib/references.bib
    sanitize: true
    keep-tex: true
    link-citations: true
    colorlinks: true
    documentclass: article
    classoption: [singlecolumn]
    lof: false
    lot: false
    geometry:
      - top=30mm
      - left=20mm
      - heightrounded
    header-includes:
      - \input{/Users/joseph/GIT/latex/latex-for-quarto.tex}
date: last-modified
execute:
  echo: false
  warning: false
  include: true
  eval: true
fontfamily: libertinus
bibliography: /Users/joseph/GIT/templates/bib/references.bib
csl: /Users/joseph/GIT/templates/csl/camb-a.csl
---

```{r}
#| label: load-libraries
#| echo: false
#| include: false
#| eval: true
#| 
# for making graphs
library("tinytex")
library("extrafont")
loadfonts(device = "all")
library("margot")
library("glue")
library("patchwork")
library("kableExtra")


# set paths

# set paths for short
push_mods_short <-
  fs::path_expand(
    "/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/lmtp/24/aaron_psychopathy"
  )

# set paths for long
push_mods_long <-
  fs::path_expand(
    "/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/24-aaron-psycho-long"
  )

# set paths for short figs
push_figs_short <-
  fs::path_expand(
    "/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/lmtp/24/aaron_psychopathy/figs"
  )
# set paths for long figs
push_figs_long <-
  fs::path_expand(
    "/Users/joseph/Library/CloudStorage/Dropbox-v-project/data/24-aaron-psycho-long/figs"
  )


# reproducibility
set.seed(123)

# create nice labels
nice_exposure_name <- glue::glue("Psychopathy Facet")
nice_exposure_name_psychopathy_combined <- glue::glue("Psychopathy")
nice_exposure_name_antagonism <- glue::glue("Antagonism")
nice_exposure_name_disinhibition <- glue::glue("Disinhibition")
nice_exposure_name_emotional_stability <- glue::glue("Emotional Stability")
nice_exposure_name_narcissism<- glue::glue("Narcissism")


# read exposure vars
t0_name_exposure <- margot::here_read("t0_name_exposure", push_mods_short)
t1_name_exposure <- margot::here_read("t1_name_exposure", push_mods_short)

# original df for interpretations
original_df_short <- margot::here_read("df_wide_encoded_ordered", push_mods_short)
original_df_long <- margot::here_read("df_wide_encoded_ordered", push_mods_long)

# nice labels
shift =   glue::glue('one point')
scale_exposure <- glue::glue("(1-7)")
nice_scale_exposure <- glue::glue("from 1 to 7")

exposure_lower_bound <- glue::glue("1")
exposure_upper_bound <- glue::glue("7")
# shift =   glue::glue('two points')
nice_baseline_wave <- glue::glue("NZAVS time 10, years 2018-2019")
nice_exposure_waves_short <- glue::glue("NZAVS time 11, years 2019-2020")
nice_exposure_waves_long <- glue::glue("NZAVS time 11,12,13 years 2019-2022")
nice_outcome_wave_short <- glue::glue("NZAVS time 12, years 2020-2021")
nice_outcome_wave_long <- glue::glue("NZAVS time 14, years 2022-2023")


# labels
# # outcome vars
# t4_outcome_vars_z <- paste0("t4_", outcome_vars, "_z")
df_lmtp_short  <- margot::here_read_qs("df_lmtp", push_mods_short)
df_lmtp_long <- margot::here_read_qs("df_lmtp", push_mods_long)

# read health outcomes
outcome_vars <- here_read("outcome_vars")
# get partner outcomes
t2_partner_outcomes_z <- paste0("t2_partner_", outcome_vars, "_z")
t4_partner_outcomes_z <- paste0("t4_partner_", outcome_vars, "_z")


# get personal outcomes
t2_outcomes_z <- paste0("t2_", outcome_vars, "_z")
t4_outcomes_z <- paste0("t4_", outcome_vars, "_z")

# sort
t2_outcomes_z <- sort(t2_outcomes_z)
t4_outcomes_z <- sort(t4_outcomes_z)

# sort
t2_partner_outcomes_z <- sort(t2_partner_outcomes_z)
t4_partner_outcomes_z <- sort(t4_partner_outcomes_z)


# label mappings for  outcomes
label_mapping_partner_short <- list(
  "t2_partner_conflict_in_relationship_z" = "Conflict in Relationship: Partner",
  "t2_partner_kessler_latent_anxiety_z" = "Kessler 6 Anxiety: Partner",
  "t2_partner_kessler_latent_depression_z" = "Kessler 6 Depression: Partner",
  "t2_partner_kessler6_sum_z" = "Kessler 6 Distress: Partner",
  "t2_partner_lifesat_z" = "Life Satisfaction: Partner",
  "t2_partner_pwi_z" = "Personal Well-Being Index: Partner",
  "t2_partner_sat_relationship_z" = "Satisfaction with Relationship: Partner",
  "t2_partner_self_esteem_z" = "Self Esteem: Partner"
)

label_mapping_self_short <- list(
  "t2_conflict_in_relationship_z" = "Conflict in Relationship: Self",
  "t2_kessler_latent_anxiety_z" = "Kessler 6 Anxiety: Self",
  "t2_kessler_latent_depression_z" = "Kessler 6 Depression: Self",
  "t2_kessler6_sum_z" = "Kessler 6 Distress: Self",
  "t2_lifesat_z" = "Life Satisfaction: Self",
  "t2_pwi_z" = "Personal Well-Being Index: Self",
  "t2_sat_relationship_z" = "Satisfaction with Relationship: Self",
  "t2_self_esteem_z" = "Self Esteem: Self"
)

label_mapping_partner_long <- list(
  "t4_partner_conflict_in_relationship_z" = "Conflict in Relationship: Partner",
  "t4_partner_kessler_latent_anxiety_z" = "Kessler 6 Anxiety: Partner",
  "t4_partner_kessler_latent_depression_z" = "Kessler 6 Depression: Partner",
  "t4_partner_kessler6_sum_z" = "Kessler 6 Distress: Partner",
  "t4_partner_lifesat_z" = "Life Satisfaction: Partner",
  "t4_partner_pwi_z" = "Personal Well-Being Index: Partner",
  "t4_partner_sat_relationship_z" = "Satisfaction with Relationship: Partner",
  "t4_partner_self_esteem_z" = "Self Esteem: Partner"
)

label_mapping_self_long <- list(
  "t4_conflict_in_relationship_z" = "Conflict in Relationship: Self",
  "t4_kessler_latent_anxiety_z" = "Kessler 6 Anxiety: Self",
  "t4_kessler_latent_depression_z" = "Kessler 6 Depression: Self",
  "t4_kessler6_sum_z" = "Kessler 6 Distress: Self",
  "t4_lifesat_z" = "Life Satisfaction: Self",
  "t4_pwi_z" = "Personal Well-Being Index: Self",
  "t4_sat_relationship_z" = "Satisfaction with Relationship: Self",
  "t2_self_esteem_z" = "Self Esteem: Self"
)

contrast_partner_up <- glue::glue("If people increased by {shift} in a {nice_exposure_name} what would be the effect on their partner's well-being")

contrast_partner_down <- glue::glue("If people decreased by {shift} in a {nice_exposure_name} what would be the effect on their partner's well-being")


contrast_self_up <- glue::glue("If people with partner's increased by {shift} in a {nice_exposure_name} what would be the effect on their well-being")

contrast_self_down<- glue::glue("If people with partner's decreased by {shift} in a {nice_exposure_name} what would be the effect on their well-being")

treatment_down_null <- glue::glue("down {shift} compared with observed levels of intervention?")  
treatment_up_null <- glue::glue("up {shift} compared with observed levels of intervention?")

# create the titles with automatic exposure insertion
baseline_wave <- margot::here_read("baseline_wave", push_mods_short)


exposure_waves_short   <- margot::here_read("exposure_waves", push_mods_short )
outcome_wave_short <- margot::here_read("outcome_wave", push_mods_short)

exposure_waves_long <- margot::here_read("exposure_waves", push_mods_long )
outcome_wave_long <- margot::here_read("outcome_wave", push_mods_long)

# get table/graphs
summary_table_short <- margot::here_read_qs("summary_tables", push_mods_short)
summary_table_long <- margot::here_read_qs("summary_tables", push_mods_long)

# n_this study
n_participants_short <- summary_table_short$n_participants
n_participants_long <- summary_table_long$n_participants


# percentage missing at baseline
# percent_missing_baseline <- here_read("percent_missing_baseline")
# percentage_missing_baseline <- glue::glue(round(percent_missing_baseline,2))


# nice labels
scale_exposure <- glue::glue('1-7')
nice_scale_exposure =  glue::glue('ordinal scale 1-7')
exposure_lower_bound =  glue::glue('1')
exposure_upper_bound =  glue::glue('7')


# histogram of exposure
histogram_antagonism_emotional_stability_disinhibition_narcissism_psychopathy_combined_by_wave_short <- here_read_qs("histogram_antagonism_emotional_stability_disinhibition_narcissism_psychopathy_combined_by_wave", push_mods_short)
histogram_antagonism_emotional_stability_disinhibition_narcissism_psychopathy_combined_by_wave_long <- here_read_qs("histogram_antagonism_emotional_stability_disinhibition_narcissism_psychopathy_combined_by_wave", push_mods_long)

## Short model options
title_up_short  <- glue::glue("Three-wave Shift UP 1 pt. NULL (baseline)")
title_down_short <- glue::glue("Three-wave Shift DOWN 1 pt vs. NULL (baseline)")

options_base_partner_up_short <- list(
  type = "RD",
  title = title_up_short,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_partner_short
)


options_base_self_up_short <- list(
  type = "RD",
  title = title_up_short,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0,   x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_self_short)



options_base_partner_down_short <- list(
  type = "RD",
  title = title_down_short  ,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_partner_short
)


options_base_self_down_short <- list(
  type = "RD",
  title = title_down_short,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_self_short)





options_antagonism_partner_up_short<- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "antagonism_partner_up_short"
)

options_antagonism_self_up_short<- margot_plot_create_options(
  subtitle = "Antagonism Effect on Self",
  base_defaults = options_base_self_up_short,
  filename_prefix = "antagonism_self_up_short"
)



options_disinhibition_partner_up_short<- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "disinhibition_partner_up_short"
)



options_disinhibition_self_up_short<- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Self",
  base_defaults = options_base_self_up_short,
  filename_prefix = "disinhibition_self_up_short"
)


options_emotional_stability_partner_up_short<- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "emotional_stability_partner_up_short"
)

options_emotional_stability_self_up_short<- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Self",
  base_defaults = options_base_self_up_short,
  filename_prefix = "emotional_stability_self_up_short"
)


options_narcissism_partner_up_short<- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "narcissism_partner_up_short"
)

options_narcissism_self_up_short<- margot_plot_create_options(
  subtitle = "Narcissism Effect on Self",
  base_defaults = options_base_self_up_short,
  filename_prefix = "narcissism_self_up_short"
)

options_psychopathy_combined_partner_up_short <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "psychopathy_combined_partner_up_short"
)

options_psychopathy_combined_self_up_short <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Self",
  base_defaults = options_base_self_up_short,
  filename_prefix = "psychopathy_combined_self_up_short"
)

# down

options_antagonism_partner_down_short<- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "antagonism_partner_down_short"
)

options_antagonism_self_down_short<- margot_plot_create_options(
  subtitle = "Antagonism Effect on Self",
  base_defaults = options_base_self_down_short,
  filename_prefix = "antagonism_self_down_short"
)

options_disinhibition_partner_down_short<- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "disinhibition_partner_down_short"
)
options_disinhibition_self_down_short <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Self",
  base_defaults = options_base_self_down_short,
  filename_prefix = "disinhibition_self_down_short"
)
options_emotional_stability_partner_down_short <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner",
  base_defaults = options_base_partner_down_short ,
  filename_prefix = "emotional_stability_partner_down_short"
)

options_emotional_stability_self_down_short <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Self",
  base_defaults = options_base_self_down_short,
  filename_prefix = "emotional_stability_self_down_short"
)


options_narcissism_partner_up_short <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "narcissism_partner_up_short"
)

options_narcissism_self_down_short <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Self",
  base_defaults = options_base_self_down_short,
  filename_prefix = "narcissism_self_down_short"
)

options_psychopathy_combined_partner_up_short <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "psychopathy_combined_partner_up_short"
)

options_psychopathy_combined_self_down_short  <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Self",
  base_defaults = options_base_self_down_short,
  filename_prefix = "psychopathy_combined_self_down_short"
)


# # plot options
options_antagonism_partner_osf_up_short <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "antagonism_partner_osf_up_short"
)

options_disinhibition_partner_osf_up_short  <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "disinhibition_partner_osf_up_short"
)

options_emotional_stability_partner_osf_up_short <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "emotional_stability_partner_osf_up_short"
)

options_narcissism_partner_osf_up_short <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "narcissism_partner_osf_up_short"
)

options_psychopathy_combined_partner_osf_up_short  <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_up_short,
  filename_prefix = "psychopathy_combined_partner_osf_up_short"
)

# down
options_antagonism_partner_osf_down_short <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "antagonism_partner_osf_down_short"
)

options_disinhibition_partner_osf_down_short <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "disinhibition_partner_osf_down_short"
)

options_emotional_stability_partner_osf_down_short <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "emotional_stability_partner_osf_down_short"
)

options_narcissism_partner_osf_down_short  <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "narcissism_partner_osf_down_short"
)

options_psychopathy_combined_partner_osf_down_short  <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner (OSF SPEC)",
  base_defaults = options_base_partner_down_short,
  filename_prefix = "psychopathy_combined_partner_osf_down_short"
)



# models ------------------------------------------------------------------

# short models
psychopathy_combined_partner_lmtp_output_short <- here_read_qs('psychopathy_combined_partner_lmtp_output', push_mods_short)
psychopathy_combined_partner_lmtp_output_short$combined_tables


psychopathy_combined_partner_shift_up_vs_null_short <- margot_plot(
  psychopathy_combined_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_psychopathy_combined_partner_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
) 


psychopathy_combined_partner_shift_up_vs_null_short$plot


psychopathy_combined_partner_shift_down_vs_null_short <- margot_plot(
  psychopathy_combined_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_psychopathy_combined_partner_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
) 
psychopathy_combined_partner_shift_down_vs_null_short$plot

# 
antagonism_partner_lmtp_output_short <- here_read_qs('antagonism_partner_lmtp_output', push_mods_short)
antagonism_partner_lmtp_output_short$combined_tables
antagonism_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null



antagonism_partner_shift_up_vs_null_short <- margot_plot(
  antagonism_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_antagonism_partner_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  )

antagonism_partner_shift_up_vs_null_short$plot

antagonism_partner_shift_down_vs_null_short <- margot_plot(
  antagonism_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_antagonism_partner_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)

antagonism_partner_shift_down_vs_null_short$plot

#
#
disinhibition_partner_lmtp_output_short <- here_read_qs('disinhibition_partner_lmtp_output', push_mods_short)

disinhibition_partner_lmtp_output_short$combined_tables

disinhibition_partner_shift_up_vs_null_short <- margot_plot(
  disinhibition_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_disinhibition_partner_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  
)

disinhibition_partner_shift_up_vs_null_short$plot

disinhibition_partner_shift_down_vs_null_short <- margot_plot(
  disinhibition_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_disinhibition_partner_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  
)

disinhibition_partner_shift_down_vs_null_short$plot

# 

emotional_stability_partner_lmtp_output_short <- here_read_qs('emotional_stability_partner_lmtp_output', push_mods_short)
emotional_stability_partner_lmtp_output_short$combined_tables

emotional_stability_partner_shift_up_vs_null_short <- margot_plot(
  emotional_stability_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_emotional_stability_partner_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  )
emotional_stability_partner_shift_up_vs_null_short$plot
emotional_stability_partner_shift_up_vs_null_short$interpretation

emotional_stability_partner_shift_down_vs_null_short <- margot_plot(
  emotional_stability_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_emotional_stability_partner_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
emotional_stability_partner_shift_down_vs_null_short$plot
emotional_stability_partner_shift_down_vs_null_short$interpretation

#

narcissism_partner_lmtp_output_short <- here_read_qs('narcissism_partner_lmtp_output', push_mods_short)
narcissism_partner_lmtp_output_short$combined_tables

narcissism_partner_shift_up_vs_null_short <- margot_plot(
  narcissism_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_narcissism_partner_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
narcissism_partner_shift_up_vs_null_short$plot
narcissism_partner_shift_up_vs_null_short$transformed_table


narcissism_partner_shift_down_vs_null_short <- margot_plot(
  narcissism_partner_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_narcissism_partner_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
narcissism_partner_shift_down_vs_null_short$plot
narcissism_partner_shift_down_vs_null_short$transformed_table



# self --------------------------------------------------------------------

psychopathy_combined_self_lmtp_output_short <- here_read_qs('psychopathy_combined_self_lmtp_output', push_mods_short)

psychopathy_combined_self_shift_up_vs_null_short <- margot_plot(
  psychopathy_combined_self_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_psychopathy_combined_self_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short

)

psychopathy_combined_self_shift_up_vs_null_short$plot/psychopathy_combined_partner_shift_up_vs_null_short$plot


psychopathy_combined_self_shift_down_vs_null_short <- margot_plot(
  psychopathy_combined_self_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_psychopathy_combined_self_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
  
)
psychopathy_combined_self_shift_down_vs_null_short$plot/psychopathy_combined_partner_shift_down_vs_null_short$plot



antagonism_self_lmtp_output_short <- here_read_qs('antagonism_self_lmtp_output', push_mods_short)
antagonism_self_lmtp_output_short$combined_tables
  
antagonism_self_shift_up_vs_null_short <- margot_plot(
  antagonism_self_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_antagonism_self_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
)

antagonism_self_shift_up_vs_null_short$plot/
  antagonism_partner_shift_up_vs_null_short$plot


antagonism_self_shift_down_vs_null_short <- margot_plot(
  antagonism_self_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_antagonism_self_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
)

antagonism_self_shift_down_vs_null_short$plot/
  antagonism_partner_shift_down_vs_null_short$plot

#
disinhibition_self_lmtp_output_short <- here_read_qs('disinhibition_self_lmtp_output', push_mods_short)

disinhibition_self_shift_up_vs_null_short <- margot_plot(
  disinhibition_self_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_disinhibition_self_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
)

disinhibition_self_shift_up_vs_null_short$plot /
  disinhibition_partner_shift_up_vs_null_short$plot

disinhibition_self_shift_down_vs_null_short <- margot_plot(
  disinhibition_self_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_disinhibition_self_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
)

disinhibition_self_shift_down_vs_null_short$plot /
  disinhibition_partner_shift_down_vs_null_short$plot

# 
emotional_stability_self_lmtp_output_short <- here_read_qs('emotional_stability_self_lmtp_output', push_mods_short)

emotional_stability_self_shift_up_vs_null_short <- margot_plot(
  emotional_stability_self_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_emotional_stability_self_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
)
emotional_stability_self_shift_up_vs_null_short$plot  / emotional_stability_partner_shift_up_vs_null_short$plot

# 
narcissism_self_lmtp_output_short <- here_read_qs('narcissism_self_lmtp_output', push_mods_short)

narcissism_self_shift_up_vs_null_short <- margot_plot(
  narcissism_self_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_narcissism_self_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_self_short
)


narcissism_self_shift_up_vs_null_short$plot/
  narcissism_partner_shift_up_vs_null_short$plot




# original study ----------------------------------------------------------
# 
psychopathy_combined_partner_osf_lmtp_output_short <- here_read_qs('psychopathy_combined_partner_osf_lmtp_output', push_mods_short)

psychopathy_combined_partner_shift_up_vs_null_osf_short <- margot_plot(
  psychopathy_combined_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_psychopathy_combined_partner_osf_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
) 

psychopathy_combined_partner_shift_up_vs_null_osf_short$plot / psychopathy_combined_partner_shift_up_vs_null_short$plot



psychopathy_combined_partner_shift_down_vs_null_osf_short <- margot_plot(
  psychopathy_combined_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_psychopathy_combined_partner_osf_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
) 
psychopathy_combined_partner_shift_down_vs_null_osf_short$plot / psychopathy_combined_partner_shift_down_vs_null_short$plot

# 
antagonism_partner_osf_lmtp_output_short <- here_read_qs('antagonism_partner_osf_lmtp_output', push_mods_short)
# 
antagonism_partner_shift_up_vs_null_osf_short <- margot_plot(
  antagonism_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_antagonism_partner_osf_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  )
antagonism_partner_shift_up_vs_null_osf_short$plot/antagonism_partner_shift_up_vs_null_short$plot



antagonism_partner_shift_down_vs_null_osf_short <- margot_plot(
  antagonism_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_antagonism_partner_osf_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
antagonism_partner_shift_down_vs_null_osf_short$plot / antagonism_partner_shift_down_vs_null_short$plot

disinhibition_partner_osf_lmtp_output_short <- here_read_qs('disinhibition_partner_osf_lmtp_output', push_mods_short)
# 
disinhibition_partner_shift_up_vs_null_osf_short <- margot_plot(
  disinhibition_partner_lmtp_output_osf_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_disinhibition_partner_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  
)

disinhibition_partner_shift_up_vs_null_osf_short$plot /disinhibition_partner_shift_up_vs_null_short$plot

disinhibition_partner_shift_down_vs_null_osf_short <- margot_plot(
  disinhibition_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_disinhibition_partner_osf_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
  
)

disinhibition_partner_shift_down_vs_null_osf_short$plot /disinhibition_partner_shift_down_vs_null_short$plot

# 
emotional_stability_partner_osf_lmtp_output_short <- here_read_qs('emotional_stability_partner_osf_lmtp_output', push_mods_short)
# 
emotional_stability_partner_shift_up_vs_null_osf_short<- margot_plot(
  emotional_stability_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_emotional_stability_partner_osf_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
emotional_stability_partner_shift_up_vs_null_osf_short$plot/emotional_stability_partner_shift_up_vs_null_short$plot


emotional_stability_partner_shift_down_vs_null_osf_short<- margot_plot(
  emotional_stability_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_emotional_stability_partner_osf_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
emotional_stability_partner_shift_down_vs_null_osf_short$plot/emotional_stability_partner_shift_down_vs_null_short$plot

# 
narcissism_partner_osf_lmtp_output_short <- here_read_qs('narcissism_partner_osf_lmtp_output', push_mods_short)

narcissism_partner_shift_up_vs_null_osf_short<- margot_plot(
  narcissism_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_narcissism_partner_osf_up_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
narcissism_partner_shift_up_vs_null_osf_short$plot/narcissism_partner_shift_up_vs_null_short$plot


narcissism_partner_shift_down_vs_null_osf_short<- margot_plot(
  narcissism_partner_osf_lmtp_output_short$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_narcissism_partner_osf_down_short,
  save_output = TRUE,
  save_path = here::here(push_mods_short),
  original_df = original_df_short,
  label_mapping = label_mapping_partner_short
)
narcissism_partner_shift_up_vs_null_osf_short$plot/narcissism_partner_shift_up_vs_null_short$plot


# participant numbers short study
n_participants_short = 1012
n_couples_short = 1012 / 2

# transition matrices short study
transition_matrices_short <- margot::here_read("transition_matrices", push_mods_short)

transition_matrices_short$psychopathy_combined

# long models ------------------------------------------------
title_up_long <- glue("Five-wave Shift UP 1 pt. NULL (baseline)")
title_down_long <- glue("Five-wave Shift DOWN 1 pt vs. NULL (baseline)")
title_up_down_long <- glue("Five-wave Shift UP 1 pt vs. Shift DOWN 1pt (baseline)")


options_base_partner_up_long <- list(
  type = "RD",
  title = title_up_long,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_partner_long
)



options_base_partner_down_long <- list(
  type = "RD",
  title = title_down_long,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_partner_long
)


options_base_partner_up_down_long <- list(
  type = "RD",
  title = title_up_down_long,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_self_long
)



options_base_self_up_long <- list(
  type = "RD",
  title = title_up_long,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_self_long)




options_base_self_down_long  <- list(
  type = "RD",
  title = title_down_long,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on type
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_partner_long
)


options_base_self_up_down_long <- list(
  type = "RD",
  title = title_up_down_long,
  order = "default",
  colors = c(
    "positive" = "#E69F00",
    "not reliable" = "grey50",
    "negative" = "#56B4E9"
  ),
  x_offset = -2.05, # will be set based on type
  x_lim_lo = -2.0, # will be set based on type
  x_lim_hi = 1, # will be set based on typee
  text_size = 4.5,
  linewidth = 0.5,
  estimate_scale = 1,
  base_size = 18,
  point_size = 4,
  title_size = 18,
  subtitle_size = 18,
  legend_text_size = 10,
  legend_title_size = 10,
  label_mapping_partner = label_mapping_partner_long
)




options_antagonism_partner_up_long <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner",
  base_defaults = options_base_partner_up_long,
  filename_prefix = "antagonism_partner_up_long"
)

options_antagonism_self_up_long <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Self",
  base_defaults = options_base_self_up_long,
  filename_prefix = "antagonism_self_up_long"
)


options_disinhibition_partner_up_long <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner",
  base_defaults = options_base_partner_up_long,
  filename_prefix = "disinhibition_partner_up_long"
)

options_disinhibition_self_up_long <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Self",
  base_defaults = options_base_self_up_long,
  filename_prefix = "disinhibition_self_up_long"
)

options_emotional_stability_partner_up_long <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner",
  base_defaults = options_base_partner_up_long,
  filename_prefix = "emotional_stability_partner_up_long"
)

options_emotional_stability_self_up_long <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Self",
  base_defaults = options_base_self_up_long,
  filename_prefix = "emotional_stability_self_up_long"
)

options_narcissism_partner_up_long <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner",
  base_defaults = options_base_partner_up_long,
  filename_prefix = "narcissism_partner_up_long"
)

options_narcissism_self_up_long <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Self",
  base_defaults = options_base_self_up_long,
  filename_prefix = "narcissism_self_up_long"
)

options_psychopathy_combined_partner_up_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner",
  base_defaults = options_base_partner_up_long,
  filename_prefix = "psychopathy_combined_partner_up_long"
)

options_psychopathy_combined_self_up_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Self",
  base_defaults = options_base_self_up_long,
  filename_prefix = "psychopathy_combined_self_up_long"
)

# down

options_antagonism_partner_down_long <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner",
  base_defaults = options_base_partner_down_long,
  filename_prefix = "antagonism_partner_down_long"
)

options_antagonism_self_down_long <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Self",
  base_defaults = options_base_self_down_long,
  filename_prefix = "antagonism_self_down_long"
)

options_disinhibition_partner_down_long <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner",
  base_defaults = options_base_partner_down_long,
  filename_prefix = "disinhibition_partner_down_long"
)

options_disinhibition_self_down_long <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Self",
  base_defaults = options_base_self_down_long,
  filename_prefix = "disinhibition_self_down_long"
)

options_emotional_stability_partner_down_long <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner",
  base_defaults = options_base_partner_down_long,
  filename_prefix = "emotional_stability_partner_down_long"
)

options_emotional_stability_self_down_long <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Self",
  base_defaults = options_base_self_down_long,
  filename_prefix = "emotional_stability_self_down_long"
)

options_narcissism_partner_down_long <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner",
  base_defaults = options_base_partner_down_long,
  filename_prefix = "narcissism_partner_down_long"
)

options_narcissism_self_down_long <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Self",
  base_defaults = options_base_self_down_long,
  filename_prefix = "narcissism_self_down_long"
)

options_psychopathy_combined_partner_down_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner",
  base_defaults = options_base_partner_down_long,
  filename_prefix = "psychopathy_combined_partner_down_long"
)

options_psychopathy_combined_self_down_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Self",
  base_defaults = options_base_self_down_long,
  filename_prefix = "psychopathy_combined_self_down_long"
)

options_psychopathy_combined_partner_up_down_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner",
  base_defaults = options_base_partner_up_down_long,
  filename_prefix = "psychopathy_combined_partner_up_down_long"
)

options_psychopathy_combined_self_up_down_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Self",
  base_defaults = options_base_self_up_down_long,
  filename_prefix = "psychopathy_combined_self_up_down_long"
)

## updown

options_antagonism_partner_up_down_long <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Partner",
  base_defaults = options_base_partner_up_down_long,
  filename_prefix = "antagonism_partner_up_down_long"
)

options_antagonism_self_up_down_long <- margot_plot_create_options(
  subtitle = "Antagonism Effect on Self",
  base_defaults = options_base_self_up_down_long,
  filename_prefix = "antagonism_self_up_down_long"
)

options_disinhibition_partner_up_down_long <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Partner",
  base_defaults = options_base_partner_up_down_long,
  filename_prefix = "disinhibition_partner_up_down_long"
)

options_disinhibition_self_up_down_long <- margot_plot_create_options(
  subtitle = "Disinhibition Effect on Self",
  base_defaults = options_base_self_up_down_long,
  filename_prefix = "disinhibition_self_up_down_long"
)

options_emotional_stability_partner_up_down_long <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Partner",
  base_defaults = options_base_partner_up_down_long,
  filename_prefix = "emotional_stability_partner_up_down_long"
)

options_emotional_stability_self_up_down_long <- margot_plot_create_options(
  subtitle = "Emotional Stability Effect on Self",
  base_defaults = options_base_self_up_down_long,
  filename_prefix = "emotional_stability_self_up_down_long"
)

options_narcissism_partner_up_down_long <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Partner",
  base_defaults = options_base_partner_up_down_long,
  filename_prefix = "narcissism_partner_up_down_long"
)

options_narcissism_self_up_down_long <- margot_plot_create_options(
  subtitle = "Narcissism Effect on Self",
  base_defaults = options_base_self_up_down_long,
  filename_prefix = "narcissism_self_up_down_long"
)

options_psychopathy_combined_partner_up_down_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Partner",
  base_defaults = options_base_partner_up_down_long,
  filename_prefix = "psychopathy_combined_partner_up_down_long"
)

options_psychopathy_combined_self_up_down_long <- margot_plot_create_options(
  subtitle = "Psychopathy Combined Effect on Self",
  base_defaults = options_base_self_up_down_long,
  filename_prefix = "psychopathy_combined_self_up_down_long"
)

# read models
# read data
psychopathy_combined_partner_lmtp_output_long <- here_read_qs('psychopathy_combined_partner_lmtp_output', push_mods_long)
# view tables
psychopathy_combined_partner_lmtp_output_long$combined_tables

# create partner shift up plot
psychopathy_combined_partner_shift_up_vs_null_long <- margot_plot(
  psychopathy_combined_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_psychopathy_combined_partner_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
) 
# view plot
psychopathy_combined_partner_shift_up_vs_null_long$plot

# create partner shift down plot
psychopathy_combined_partner_shift_down_vs_null_long <- margot_plot(
  psychopathy_combined_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_psychopathy_combined_partner_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
) 
# view plot
psychopathy_combined_partner_shift_down_vs_null_long$plot

# create partner shift up vs down plot
psychopathy_combined_partner_shift_up_vs_shift_down_long <- margot_plot(
  psychopathy_combined_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_shift_down,
  options = options_psychopathy_combined_partner_up_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
) 
# view plot
psychopathy_combined_partner_shift_up_vs_shift_down_long$plot

# read antagonism data
antagonism_partner_lmtp_output_long <- here_read_qs('antagonism_partner_lmtp_output', push_mods_long)
# view tables
antagonism_partner_lmtp_output_long$combined_tables

# create antagonism partner shift up plot
antagonism_partner_shift_up_vs_null_long <- margot_plot(
  antagonism_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_antagonism_partner_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
antagonism_partner_shift_up_vs_null_long$plot

# create antagonism partner shift down plot
antagonism_partner_shift_down_vs_null_long <- margot_plot(
  antagonism_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_antagonism_partner_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
antagonism_partner_shift_down_vs_null_long$plot

# read disinhibition data
disinhibition_partner_lmtp_output_long <- here_read_qs('disinhibition_partner_lmtp_output', push_mods_long)
# view tables
disinhibition_partner_lmtp_output_long$combined_tables

# create disinhibition partner shift up plot
disinhibition_partner_shift_up_vs_null_long <- margot_plot(
  disinhibition_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_disinhibition_partner_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
disinhibition_partner_shift_up_vs_null_long$plot

# create disinhibition partner shift down plot
disinhibition_partner_shift_down_vs_null_long <- margot_plot(
  disinhibition_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_disinhibition_partner_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
disinhibition_partner_shift_down_vs_null_long$plot

# read emotional stability data
emotional_stability_partner_lmtp_output_long <- here_read_qs('emotional_stability_partner_lmtp_output', push_mods_long)
# view tables
emotional_stability_partner_lmtp_output_long$combined_tables

# create emotional stability partner shift up plot
emotional_stability_partner_shift_up_vs_null_long <- margot_plot(
  emotional_stability_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_emotional_stability_partner_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
emotional_stability_partner_shift_up_vs_null_long$plot

# create emotional stability partner shift down plot
emotional_stability_partner_shift_down_vs_null_long <- margot_plot(
  emotional_stability_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_emotional_stability_partner_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
emotional_stability_partner_shift_down_vs_null_long$plot

# read narcissism data
narcissism_partner_lmtp_output_long <- here_read_qs('narcissism_partner_lmtp_output', push_mods_long)
# view tables
narcissism_partner_lmtp_output_long$combined_tables

# create narcissism partner shift up plot
narcissism_partner_shift_up_vs_null_long <- margot_plot(
  narcissism_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_narcissism_partner_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
narcissism_partner_shift_up_vs_null_long$plot

# create narcissism partner shift down plot
narcissism_partner_shift_down_vs_null_long <- margot_plot(
  narcissism_partner_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_narcissism_partner_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_partner_long
)
# view plot
narcissism_partner_shift_down_vs_null_long$plot

# read psychopathy self data
psychopathy_combined_self_lmtp_output_long <- here_read_qs('psychopathy_combined_self_lmtp_output', push_mods_long)

# create psychopathy self shift up plot
psychopathy_combined_self_shift_up_vs_null_long <- margot_plot(
  psychopathy_combined_self_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_psychopathy_combined_self_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
psychopathy_combined_self_shift_up_vs_null_long$plot/psychopathy_combined_partner_shift_up_vs_null_long$plot

# create psychopathy self shift down plot
psychopathy_combined_self_shift_down_vs_null_long <- margot_plot(
  psychopathy_combined_self_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_psychopathy_combined_self_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
psychopathy_combined_self_shift_down_vs_null_long$plot/psychopathy_combined_partner_shift_down_vs_null_long$plot

# read antagonism self data
antagonism_self_lmtp_output_long <- here_read_qs('antagonism_self_lmtp_output', push_mods_long)
# view tables
antagonism_self_lmtp_output_long$combined_tables

# create antagonism self shift up plot
antagonism_self_shift_up_vs_null_long <- margot_plot(
  antagonism_self_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_antagonism_self_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
antagonism_self_shift_up_vs_null_long$plot/antagonism_partner_shift_up_vs_null_long$plot

# create antagonism self shift down plot
antagonism_self_shift_down_vs_null_long <- margot_plot(
  antagonism_self_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_antagonism_self_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
antagonism_self_shift_down_vs_null_long$plot/antagonism_partner_shift_down_vs_null_long$plot

# read disinhibition self data
disinhibition_self_lmtp_output_long <- here_read_qs('disinhibition_self_lmtp_output', push_mods_long)

# create disinhibition self shift up plot
disinhibition_self_shift_up_vs_null_long <- margot_plot(
  disinhibition_self_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_disinhibition_self_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
disinhibition_self_shift_up_vs_null_long$plot/disinhibition_partner_shift_up_vs_null_long$plot

# create disinhibition self shift down plot
disinhibition_self_shift_down_vs_null_long <- margot_plot(
  disinhibition_self_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_disinhibition_self_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
disinhibition_self_shift_down_vs_null_long$plot/disinhibition_partner_shift_down_vs_null_long$plot

# read emotional stability self data
emotional_stability_self_lmtp_output_long <- here_read_qs('emotional_stability_self_lmtp_output', push_mods_long)

# create emotional stability self shift up plot
emotional_stability_self_shift_up_vs_null_long <- margot_plot(
  emotional_stability_self_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_emotional_stability_self_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
emotional_stability_self_shift_up_vs_null_long$plot/emotional_stability_partner_shift_up_vs_null_long$plot

# create emotional stability self shift down plot
emotional_stability_self_shift_down_vs_null_long <- margot_plot(
  emotional_stability_self_lmtp_output_long$combined_tables$combined_outcomes_shift_down_vs_null,
  options = options_emotional_stability_self_down_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
emotional_stability_self_shift_down_vs_null_long$plot/emotional_stability_partner_shift_down_vs_null_long$plot

# read narcissism self data
narcissism_self_lmtp_output_long <- here_read_qs('narcissism_self_lmtp_output', push_mods_long)

# create narcissism self shift up plot
narcissism_self_shift_up_vs_null_long <- margot_plot(
  narcissism_self_lmtp_output_long$combined_tables$combined_outcomes_shift_up_vs_null,
  options = options_narcissism_self_up_long,
  save_output = TRUE,
  save_path = here::here(push_mods_long),
  original_df = original_df_long,
  label_mapping = label_mapping_self_long
)
# view comparative plot
narcissism_self_shift_up_vs_null_long$plot/narcissism_partner_shift_up_vs_null_long$plot



# participant numbers long study
n_participants_long
n_couples_short = n_participants_long / 2

# transition matrices short study
transition_matrices_long<- margot::here_read("transition_matrices", push_mods_long)

transition_matrices_long$psychopathy_combined




#################### ONLY MODELS ####################


Estimation






# models ------------------------------------------------------------------

# view plot
psychopathy_combined_partner_shift_up_vs_null_short$plot


# view plot
psychopathy_combined_partner_shift_down_vs_null_short$plot


# view plot
antagonism_partner_shift_up_vs_null_short$plot

# view plot
antagonism_partner_shift_down_vs_null_short$plot

# view plot
disinhibition_partner_shift_up_vs_null_short$plot



# view plot
disinhibition_partner_shift_down_vs_null_short$plot


# view plot
emotional_stability_partner_shift_up_vs_null_short$plot
emotional_stability_partner_shift_up_vs_null_short$interpretation


# view plot
emotional_stability_partner_shift_down_vs_null_short$plot
emotional_stability_partner_shift_down_vs_null_short$interpretation


# view plot
narcissism_partner_shift_up_vs_null_short$plot
narcissism_partner_shift_up_vs_null_short$transformed_table



# view plot
narcissism_partner_shift_down_vs_null_short$plot
narcissism_partner_shift_down_vs_null_short$transformed_table



# self --------------------------------------------------------------------



# view plot
psychopathy_combined_self_shift_up_vs_null_short$plot/psychopathy_combined_partner_shift_up_vs_null_short$plot




# view plot
psychopathy_combined_self_shift_down_vs_null_short$plot/psychopathy_combined_partner_shift_down_vs_null_short$plot




# view plot
antagonism_self_shift_up_vs_null_short$plot/
  antagonism_partner_shift_up_vs_null_short$plot




# view plot
antagonism_self_shift_down_vs_null_short$plot/
  antagonism_partner_shift_down_vs_null_short$plot




# view plot
disinhibition_self_shift_up_vs_null_short$plot /
  disinhibition_partner_shift_up_vs_null_short$plot

# view plot
disinhibition_self_shift_down_vs_null_short$plot /
  disinhibition_partner_shift_down_vs_null_short$plot

# 


# view plot
emotional_stability_self_shift_up_vs_null_short$plot  / emotional_stability_partner_shift_up_vs_null_short$plot


# view plot
narcissism_self_shift_up_vs_null_short$plot/
  narcissism_partner_shift_up_vs_null_short$plot




# original study ----------------------------------------------------------

# view plot
psychopathy_combined_partner_shift_up_vs_null_osf_short$plot / psychopathy_combined_partner_shift_up_vs_null_short$plot




# view plot
psychopathy_combined_partner_shift_down_vs_null_osf_short$plot / psychopathy_combined_partner_shift_down_vs_null_short$plot




# view plot  
antagonism_partner_shift_up_vs_null_osf_short$plot/antagonism_partner_shift_up_vs_null_short$plot



# view plot
antagonism_partner_shift_down_vs_null_osf_short$plot / antagonism_partner_shift_down_vs_null_short$plot



# view plot
disinhibition_partner_shift_up_vs_null_osf_short$plot /disinhibition_partner_shift_up_vs_null_short$plot



# view plot
disinhibition_partner_shift_down_vs_null_osf_short$plot /disinhibition_partner_shift_down_vs_null_short$plot


# view plot
emotional_stability_partner_shift_up_vs_null_osf_short$plot/emotional_stability_partner_shift_up_vs_null_short$plot

# view plot
emotional_stability_partner_shift_down_vs_null_osf_short$plot/emotional_stability_partner_shift_down_vs_null_short$plot

# view plot
narcissism_partner_shift_up_vs_null_osf_short$plot/narcissism_partner_shift_up_vs_null_short$plot

# view plot
narcissism_partner_shift_down_vs_null_osf_short$plot/narcissism_partner_shift_down_vs_null_short$plot



# long models ------------------------------------------------


## LONG MODELS


# view plot
psychopathy_combined_partner_shift_up_vs_null_long$plot

# view plot
psychopathy_combined_partner_shift_down_vs_null_long$plot


# view plot
psychopathy_combined_partner_shift_up_vs_shift_down_long$plot

# view plot
antagonism_partner_shift_up_vs_null_long$plot

# view plot
antagonism_partner_shift_down_vs_null_long$plot

# view plot
disinhibition_partner_shift_up_vs_null_long$plot


# view plot
disinhibition_partner_shift_down_vs_null_long$plot

# view plot
emotional_stability_partner_shift_up_vs_null_long$plot


# view plot
emotional_stability_partner_shift_down_vs_null_long$plot

# view plot
narcissism_partner_shift_up_vs_null_long$plot

# view plot
narcissism_partner_shift_down_vs_null_long$plot


# view comparative plot
psychopathy_combined_self_shift_up_vs_null_long$plot/psychopathy_combined_partner_shift_up_vs_null_long$plot

# view comparative plot
psychopathy_combined_self_shift_down_vs_null_long$plot/psychopathy_combined_partner_shift_down_vs_null_long$plot

# view comparative plot
antagonism_self_shift_up_vs_null_long$plot/antagonism_partner_shift_up_vs_null_long$plot

# view comparative plot
antagonism_self_shift_down_vs_null_long$plot/antagonism_partner_shift_down_vs_null_long$plot


# view comparative plot
disinhibition_self_shift_up_vs_null_long$plot/disinhibition_partner_shift_up_vs_null_long$plot


)
# view comparative plot
disinhibition_self_shift_down_vs_null_long$plot/disinhibition_partner_shift_down_vs_null_long$plot


)
# view comparative plot
emotional_stability_self_shift_up_vs_null_long$plot/emotional_stability_partner_shift_up_vs_null_long$plot

)
# view comparative plot
emotional_stability_self_shift_down_vs_null_long$plot/emotional_stability_partner_shift_down_vs_null_long$plot


)
# view comparative plot
narcissism_self_shift_up_vs_null_long$plot/narcissism_partner_shift_up_vs_null_long$plot




```

## Introduction


### Causal Questions
A central question in psychopathy research is how it affects relationships. 

To address this question, we develop an outcome-wide longitudinal study using a national longitudinal probability sample in New Zealand. 

In Study 1a, we investigate the effect of a one-year intervention on psychopathic personality and its facets on partners. (Planned OSF study)


In Study 1b, we investigate the effect of a one-year intevention on psychopathic personality on those who receive the psychopathy treatments (selves), and compare self/partner outcomes. 


In Study 2a, we investigate the longer-term effects of three-year inteventions on psychopathic personality, focussing on three-year interventions on psychopathy.


In Study 2b, we investigate long-term effects on selves, again focussing on three-year interventions and comparing the effects on selves with those of partners. 

Study 1a and 1b clarify the short term effects of psychapthy interventions on partner who have been together at least one year. 

Study 2a and 2b clarify the longer term effects of psychopathy interventions on those who experience the interventions for at least three years. 


### Motivation

The questions we examine hold relevance across several subfields of psychological science, particularly forensic psychology, personality psychology, and relationship research. This study is also broadly significant for advancing causal questions within observational research.

Currently, few studies in relationship research address causality directly, tending instead to investigate statistical associations between actors and partners over time. Establishing causality, however, requires a clearly defined causal contrast of interest, well-defined treatments, and random assignment of individuals drawn from a population of interest to treatment conditions. Because we cannot observe an individuals response to an unassigned treatment, individual causal effects remain unobservable. However, with randomisation, investigators can infer population-level responses asymptotically, as individuals in treatment conditions are exchangeable. These effects are always obtained for populations or strata of populations, never for individuals. In relationship research, where the effects of interest are on partners of individuals, individual partner effects also remain elusive. Even when repeated measures designs are employed, causal effect estimates in experimental research are always "between-treatments" -- whatever the reporting habits of experimental researchers.  

Notably, for many theoretically relevant questions, randomised controlled trials are neither feasible nor ethical. In observational research, identifying causal effects requires assumptions usually inherent to experiments and a systematic approach in which investigators specify (1) a target population; (2) a causal question as a contrast of population averages under distinct treatments; (3) identification assumptions ensuring assignment to treatment conditions is as good as random; (4) a statistical estimator for causal quantities; (5) a statistical model with its assumptions; and (6) sensitivity analyses to evaluate results [@ogburn2021]. However in observational research, it is useful to always keep in model the ideal experiment or "target trial" that we investigators would conduct where such an experiment feasible and ethical [@hernan2024].  


To begin, when emulating a "target trial" observational investigators investigators must ensure that outcomes they measure do not precede the treatments being contrasted. In experimental designs, it is clear that events that occur before manipulation cannot be reported as outcomes, but this assurance is typically absent in observational research, where repeated measures over time are usually necessary to ensure the necessary chronological hygiene. Temporal resolution alone, however, is insufficient for causal inference. Investigators must define a clear pair, or set, of treatments (or exposures) for comparison. In randomised experiments, treatments and any control conditions define the contrasted conditions. In observational studies, where exposures are not administered by the researcher, the exposures and contrasts must be explicitly specified. Robust causal inference requires that the exposures under comparison are observed across all levels of covariates in the statistical model (the positiviety assumption), that the treatments although not under control of the investigators are comparable (causal consistency), and that treatment assignment although not under the control of investigators is "as good as random" (conditional exchangeability). Moreover, to obtain incident effects, investigators must ensure that only initiation into exposures are counted [@hernan2016]. For instance, examining a harmful exposure without accounting for initial susceptibility could introduce healthy-worker bias, misleadingly suggesting a positive association between the exposure and outcome when the true causal relationship is harmful [@robins1986]. Despite advanced statistical modelling and time series data, relationship research has yet to systematically adopt rigorous causal inference methods [@bulbulia2024swigstime]. The present study addresses this gap. 


## Method

### Sample

Data were collected as part of The New Zealand Attitudes and Values Study (NZAVS) is an annual longitudinal national probability panel study of social attitudes, personality, ideology and health outcomes. The NZAVS began in 2009. It includes questionnaire responses from over 72,000 New Zealand residents. The study includes researchers from many New Zealand universities, including the University of Auckland, Victoria University of Wellington, the University of Canterbury, the University of Otago, and Waikato University. Because the survey asks the same people to respond each year, it can track subtle changes in attitudes and values over time and is an important resource for researchers in New Zealand and worldwide. The NZAVS is university-based, not-for-profit and independent of political or corporate funding.https://doi.org/10.17605/OSF.IO/75SNB


[Appendix A](#appendix-demographics) provides information about demographic covariates used for confounding control (NZAVS time 10, years 2018-2019).


## Target Population

In Studies 1a and 1b, the target population consisted of all New Zealanders who were in a relationship at NZAVS time 10 (baseline, years 2018-2019) and remained in a relationship at NZAVS time 11 (years 2019-2020). 

In Studies 2a and 2b, the target population consisted of all New Zealanders who were in a relationship at NZAVS time 10 (baseline, years 2018-2019), and may have been lost to follow up in NZAVS time 11-14.  


### Eligibility criteria for Studies 1a and 1b (short-term interventions)

The sample consisted of respondents to NZAVS times 10 (baseline, years 2018-2019), time 11 (treatment wave, years 2019-2020), and time 12 (outcome wave) (years 2020-2021).

- Participants who were identified as being in couples in both the baseline and exposure waves, where both partners were observed.   
- Participants who provided full information to the psychopathy measures in the `r baseline_wave` and `r exposure_wave_short`. Participants may have been lost to follow up in the outcome wave `r outcome_wave_short`. 
- Missing data for all variables in the baseline wave baseline were allowed. Missing data at baseline were imputed through the `mice` package [@vanbuuren2018], and an extra column indicator was included to denote whether a variable was missing, following protocols described by [@williams2021].
- Inverse probability of censoring weights were calculated as part of estimation in `lmtp` to adjust for missing outcomes at NZAVS Time 12 (years 2020-2021, the outcome wave [@williams2021])


There were `r n_participants_short` NZAVS participants who met these criteria in `r n_couples` couples.

### Eligibility criteria for Studies 2a and 2b (longer-term interventions)

The sample consisted of respondents to NZAVS times 10 (baseline, years 2018-2019), times 11-13 (treatment waves, years 2019-2022), and time 14 (outcome wave, years 2022-2023).

- Participants who were identified as being in couples in the baseline wave, where both partners were observed. 
- Participants may have been lost to follow up in the exposure waves and outcomes waves. 
- Missing data for all variables in the baseline wave were allowed. Missing data at baseline were imputed through the `mice` package [@vanbuuren2018], and an extra column indicator was included to denote whether a variable was missing, following protocols described by [@williams2021].
- Inverse probability of censoring weights were calculated as part of estimation in `lmtp` to adjust for missing outcomes at NZAVS Time 14 (years 2022-2023, the outcome wave [@williams2021]).
- If one or more partner dropped out of the study, both partners were censored. 

There were `r n_participants_long` NZAVS participants who met these criteria in `r n_couples_long` couples.

### Causal Contrasts in Romantic Partnerships

We specify causal effects non-parametrically by defining contrasts between potential outcomes under different interventions. This approach allows us to clearly state what would happen to both individuals and their partners under specific changes to personality traits.

#### Notation

- A romantic partnership is defined as a pair of individuals $(s, p)$, where:
  - $s$ = self (the individual)
  - $p$ = partner
- $A_s$ = intervention on the self's psychopathic personality or one of its facets
- $A_p$ = partner's psychopathic personality (not intervened upon)
- $Y_s$ = outcome for self (e.g., well-being)
- $Y_p$ = outcome for partner
- $L$ = measured covariates

### Potential Outcomes

For any intervention where we set the self's personality facet to level $\tilde{a}_s$:

- $Y_p(\tilde{a}_s)$ denotes the potential outcome for the partner when the self is intervened upon.
- $Y_s(\tilde{a}_s)$ denotes the potential outcome for the self when the self is intervened upon.

Since we do not intervene on the partner's psychopathic personality, the partner's exposure remains at its observed value $\tilde{a}_p = A_p$.

### Assumptions

To identify these potential outcomes, we assume conditional exchangeability given measured covariates $L$:

$$
\{Y_p(\tilde{a}_s), Y_s(\tilde{a}_s)\} \coprod A_s \mid L
$$

This means that, conditional on $L$, the treatment assignments $A_s = \tilde{a}_s$ are 'as good as random.' This allows us to estimate causal effects from observed data.

## Intervention Types

We define three specific shift interventions on the psychopathic personality trait, which is bounded between 1 and 7:

### 1. Shift Up (+1)

We define the shift-up intervention as:

$$
a_s^+ = f(A_s) = 
\begin{cases}
A_s + 1, & \text{if } A_s + 1 \leq 7 \\
7, & \text{if } A_s + 1 > 7
\end{cases}
$$

This ensures that the shifted value does not exceed the maximum score of 7.

### 2. Shift Down (-1)

We define the shift-down intervention as:

$$
a_s^- = f(A_s) = 
\begin{cases}
A_s - 1, & \text{if } A_s - 1 \geq 1 \\
1, & \text{if } A_s - 1 < 1
\end{cases}
$$

This ensures that the shifted value does not go below the minimum score of 1.

### 3. Null (No Change)

The null intervention leaves the exposure at its observed value:

$$
a_s = A_s
$$

### Causal Effects

We specify causal effects by contrasting potential outcomes under these interventions.  In study 1 this intervention occurred for one year (baseline + 1 year), and in study 2 it occurred for three years (baseline + 3 years). Outcomes were measured one year after the end of the intervention to ensure temporal order in causal inferences [@vanderweele2020]. 

#### Average Partner Effect (APE)

The Average Partner Effect (APE) computes how changing the self's trait affects the partner's outcome.

##### For Shift Up:

$$
\text{APE}_{\text{up}} = E\left[ Y_p(a_s^+) - Y_p(a_s) \mid L \right]
$$

This Average Partner Effect (APE) computes the average change in the partner's outcome when we increase the self's trait by 1 point from the observed treatment level..

##### For Shift Down:

$$
\text{APE}_{\text{down}} = E\left[ Y_p(a_s^-) - Y_p(a_s) \mid L \right]
$$

This Average Partner Effect (APE) computes the average change in the partner's outcome when we decrease the self's trait by 1 point from the observed treatment level.

#### Average Self Effect (ASE)

The Average Self Effect (ASE) measures how changing one's own trait affects their own outcome.

##### For Shift Up:

$$
\text{ASE}_{\text{up}} = E\left[ Y_s(a_s^+) - Y_s(a_s) \mid L \right]
$$

This Average Self Effect computes the average change in the self's outcome when we increase their trait by 1 point from the observed treatment level.

##### For Shift Down:

$$
\text{ASE}_{\text{down}} = E\left[ Y_s(a_s^-) - Y_s(a_s) \mid L \right]
$$

This Average Self Effect computes the average change in the self's outcome when we decrease their trait by 1 point from the observed treatment level.

In Studies 1a and 1b, we estimate the Average Partner and Self effects, respectively, from one-year shift interventions (both increases and decreases) on psychopathic personality traits in a population of New Zealanders who have been in relationships for three years. The interventions occurred in the second year, with outcomes measured in the third year. We allowed for loss to follow-up and break-ups in the third year, estimating the per-protocol effect using inverse probability of censoring weights.

In Studies 2a and 2b, we estimate the Average Partner and Self effects from three-year shift interventions on psychopathic personality traits among New Zealanders in five-year relationships. The interventions took place from the second to the fourth year, and outcomes were measured in the fifth year. Loss to follow-up was permitted after baseline. When break-ups occurred, both partners were censored, and we estimated the per-protocol effect using inverse probability of censoring weights.

Having stated our causal estimands and target population, we now turn to our identification assumptions.


### Identification Assumptions

To consistently estimate causal effects, we rely on three assumptions. These assumptions are standard in the literature on causal inference [@hernan2024, @bulbulia2024].

1. **Causal Consistency:** potential outcomes must align with observed outcomes under the treatments in our data. Essentially, we assume potential outcomes do not depend on the specific way treatment was administered, as long as we consider measured covariates. Note that we adjust both for parter and self co-variates at baseline. 

2. **Conditional Exchangeability:** given the observed covariates, we assume treatment assignment is independent of potential outcomes. In simpler terms, this means "no unmeasured confounding"  any variables that influence both treatment assignment and outcomes are included in our covariate set. 

3. **Positivity:** for unbiased estimation, every subject must have a non-zero chance of receiving the treatment, regardless of their covariate values. We evaluate this assumption in each study by examining changes in psychopathy "treatments" from baseline (NZAVS time 10) to the treatment wave (NZAVS time 11).  [Appendix XXX](appendix-transition): Transition matrices shows this observed shifts in the treatment variables from baseline (NZAVS time 10) to exposure waves (NZAVS time 11).


<!-- ### Confounding Control Strategy -->

<!-- We followed @vanderweele2020's *minimally modified disjunctive criteria* for confounding control. -->

<!-- 1. **Initial identify confounders**: using causal diagrams, we began by enumerating all covariates that may influence either the treatment (exposure) or outcomes, spanning five domains. This includes variables directly affecting the exposure or outcome, as well as potential consequences of these variables (i.e. proxies.) -->

<!-- 2. **Remove instrumental variables**: we removed variables that are identified as instrumental variables, i.e., those influencing the exposure but not the outcome. Their inclusion can reduce the efficiency of the analysis. -->

<!-- 3. **Include proxy variables**: for unmeasured variables that affect both the exposure and outcome, we include proxy variables wherever possible. These proxies act as indicators for the unmeasured common causes. [Appendix B](#appendix-demographics) lists covariates we used for confounding control. These protocols follow advice in [@bulbulia2024PRACTICAL] as described in [https://osf.io/ce4t9/](https://osf.io/ce4t9/). -->

<!-- 4. **Baseline exposure control**: we included baseline measures of the outcome to adjust for unmeasured confounding [@vanderweele2020]. Accounting for prior exposure also allowed us to recover an incident exposure effect as opposed to a prevalent exposure effect: that is, we were able to focus on the one-year effect on partner well-being from initiation to psychopathy or a psychopathic trait [@danaei2012; @hernan2023]. -->

<!-- 5. **Baseline outcome control**: we also included baseline measures of the outcome to adjust for unmeasured confounding [@vanderweele2020]. This strategy also minimises the possibility of reverse causation. -->


<!-- Additionally, we adopted the following confounding-control strategies: -->





<!-- Valid inferences for the New Zealand population were secured by applying post-stratification census weights for age, European ethnicity, and gender. -->



#### Estimation 

In Studies 1a and 1b, we estimate the causal effect of modified treatment policies over time using Targeted Minimum Loss-based Estimation (TMLE), a semi-parametric estimator [@vanderlaan2011; @vanderlaan2018]. TMLE estimation was conducted via the lmtp package [@williams2021; @daz2021; @hoffman2023]. TMLE proceeds in two main steps involving outcome and treatment (exposure) models. First, machine learning algorithms flexibly model the relationships among treatments, covariates, and outcomes, allowing TMLE to capture complex, high-dimensional covariate structures without strict model assumptions. This step yields an initial set of estimates. In the second step, TMLE "targets" these initial estimates by incorporating observed data distribution information, improving the accuracy of the causal effect estimate through an iterative process. 

A notable strength of TMLE is its double-robustness property, meaning that consistent causal effect estimation is achieved as long as either the outcome or treatment model is correctly specified. TMLE also incorporates cross-validation to prevent overfitting. These features collectively create a robust methodology for examining causal effects of interventions on outcomes. The integration of TMLE with machine learning reduces reliance on restrictive modelling assumptions. For further details, see [@hoffman2022; @hoffman2023; @daz2021].

In Studies 2a and 2b, we used a Sequential Doubly-Robust Estimator from the `lmtp` package, which is multiply robust for repeated treatments across multiple waves [@diaz2023lmtp; @hoffman2023]. This estimator strengthens robustness to misspecification in either the outcome or treatment model. The lmtp package relies on the SuperLearner library, integrating diverse machine learning algorithms [@SuperLearner2023]. Given our relatively small sample sizes (fewer than 2,000 participants), we selected the Ranger estimator, a non-parametric causal forest method known for its resistance to overfitting [Ranger2017]. All statistical models implemented a 10-fold cross-validation.



#### Statistical Assumptions and Sensitivity Analysis

  1. We account for statistical dependencies among partners by including an indicator for relationship clusters, we assume no further statistical dependencies in the data.
  2. Although semi-parametric, multiply-robust estimators offer improved robustness against model misspecification compared to parametric models, they are not completely immune to it. We assume correct model specification for either the outcome or treatment model.
  3.  We perform sensitivity analyses using the E-value metric [@vanderweele2017; @linden2020EVALUE]. The E-value represents the minimum association strength (on the risk ratio scale) that an unmeasured confounder would need to have with both the exposure and outcomeafter adjusting for measured covariatesto explain away the observed exposure-outcome association [@vanderweele2020; @linden2020EVALUE].


#### Pre-Registered Analysis Plan

Criteria for analysis in study 1a was pre-specified and pre-registered in advance of the analysis at:[https://osf.io/ce4t9/](https://osf.io/ce4t9/), and followed standard NZAVS protocols for three-wave causal inference designs [@bulbulia2024PRACTICAL]. The results for Study 1a are presented in Appendix XXX.  

The Study 1a as presented in the main text we deviated from the current plan in two ways. First, we incorporated an additional baseline confounders: reported health disability, relationship status, and length of relationship. Second, we introduced indicators to denote when baseline variables had been imputed. These decisions are based on the assumption that health disability and relationship status might affect both personality traits and well-being outcomes. Additionally, length in a relationship might affect both personality facets and well-being outcomes. We introduced indicators to denote when baseline variables had been imputed. This refinement aligns our approach with the recommendations of @hoffman2023, ensuring robustness in handling missing data. Essentially machine learning can better adjust for imputation at baseline by recognising which variables have been imputed for each individual. 

Results for the pre-specified OSF are presented in Appendix XXX. *There were no substantive differences in the augmented design.* However, we report the augmented design as a model for best practice.

Study 1b was not pre-registered. On reflection, we decided to include the personal effects of psychopathic interventions on those who experience them to provide a more complete picture of the effects of psychopathy.  Study 1b followed the same protocols as Study 1a, with outcomes measured one year after the end of the intervention on selves rather than on partners. 

Studies 2a and 2b were not pre-registered. On reflection, we decided to include a multi-wave study to provide a more complete picture of psychopathy and its long term effects. Additionally, we allowed for censoring in the treatment wave to estimate the per-protocol effect of treatment, on the assumption that that psychopathic personality traits might lead to attrition already at the treatment wave. Although this prospect does not bias causal effect estimation in Studies 1a and 1b, the target population is smaller in those studies, which do not generalise to the population of New Zealand couples in the baseline wave, whose densitisty of psychopathic personality traits may be higher than those who carry on responding in the treatment wave [@bulbulia2024wierd]


## Study 1a: Three Wave Effect of Psychopathy Interventions on Partner Well-being

### Results Study 1A: Antagonism: Partner

```{r}
#| label: fig-results-antagonism-partner-up
#| fig-cap: "Results for antagonism effect on partner multi-dimensional well-being: z-transformed"
#| eval: true
#| include: true
#| echo: false
#| fig-height: 16
#| fig-width: 16


plot_antagonism_partner_lmtp_output_short$plot

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-antagonism-partner-up
#| tbl-cap: "Table for antagonism effect on partner multi-dimensional well-being: "
#| eval: true
#| include: false
#| echo: false

plot_antagonism_partner_lmtp_output$transformed_table |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_antagonism_partner_lmtp_output$interpretation)
```



### Results Study 1B: Antagonism: Self vs Partner 

```{r}
#| label: fig-results-antagonism-self
#| fig-cap: "Results for antagonism effect for self vs partner on multi-dimensional well-being: z-transformed"
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24

plot_antagonism_self_lmtp_output$plot + plot_antagonism_partner_lmtp_output$plot + plot_annotation(tag_levels = "A")

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-antagonism-self
#| tbl-cap: "Table for antagonism effect on for self on multi-dimensional well-being"
#| eval: true
#| include: false
#| echo: false

plot_antagonism_self_lmtp_output$transformed_table |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_antagonism_self_lmtp_output$interpretation)
```


{{< pagebreak >}}
## Results Study 2 Disinhibition 

### Results Study 2A Disinhibition: Partner

```{r}
#| label: fig-results-disinhibition-partner
#| fig-cap: "Results for disinhibition effect for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12


plot_disinhibition_partner_lmtp_output$plot

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-disinhibition-partner
#| tbl-cap: "Table for disinhibition effect for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_disinhibition_partner_lmtp_output$transformed_table|> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_disinhibition_partner_lmtp_output$interpretation)

```


{{< pagebreak >}}
### Results Study 2B Disinhibition: Self vs Partner

```{r}
#| label: fig-results-disinhibition-self
#| fig-cap: "Results for disinhibition effect for self vs partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24


plot_disinhibition_self_lmtp_output$plot + plot_disinhibition_partner_lmtp_output$plot + plot_annotation(tag_levels = "A")

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-disinhibition-self
#| tbl-cap: "Table for disinhibition effect for self on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_disinhibition_self_lmtp_output$transformed_table|> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_disinhibition_self_lmtp_output$interpretation)

```


{{< pagebreak >}}
## Results Study 3 Emotional Stability 


### Results Study 3A  Emotional Stability: Partner

```{r}
#| label: fig-results-emotional-partner
#| fig-cap: "Results for emotional stability effect for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12

plot_emotional_stability_partner_lmtp_output$plot

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-emotional-partner
#| tbl-cap: "Table for emotional stability effect for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_emotional_stability_partner_lmtp_output$transformed_table|> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_emotional_stability_partner_lmtp_output$interpretation)

```

{{< pagebreak >}}

### Results Study 3B  Emotional Stability: Self vs Partner

```{r}
#| label: fig-results-emotional-self
#| fig-cap: "Results for emotional stability effect for self vs partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24


plot_emotional_stability_self_lmtp_output$plot + plot_emotional_stability_partner_lmtp_output$plot + plot_annotation(tag_levels = "A")

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-emotional-self
#| tbl-cap: "Table for emotional stability effect for self on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_emotional_stability_self_lmtp_output$transformed_table|> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_emotional_stability_self_lmtp_output$interpretation)

```

{{< pagebreak >}}




## Results Study 4 Narcissism 



### Results Study 4A Narcissism: Partner

```{r}
#| label: fig-results-narcissism-partner
#| fig-cap: "Results for Narcissism stability gain for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12
plot_narcissism_partner_lmtp_output$plot
```

{{< pagebreak >}}

```{r}
#| label: tbl-results-narcissism-partner
#| tbl-cap: "Table for Narcissism gain for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_narcissism_partner_lmtp_output$transformed_table |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_narcissism_partner_lmtp_output$interpretation)


```
{{< pagebreak >}}


### Results Study 4B Narcissism: Self vs Partner

```{r}
#| label: fig-results-narcissism-self
#| fig-cap: "Results for Narcissism stability effect for self vs partner on multi-dimensional well-being: z-transformed"
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24

plot_narcissism_self_lmtp_output$plot + plot_narcissism_partner_lmtp_output$plot   + plot_annotation(tag_levels = "A")
```

{{< pagebreak >}}

```{r}
#| label: tbl-results-narcissism-self
#| tbl-cap: "Table for Narcissism effect for self on multi-dimensional well-being"
#| eval: true
#| include: true
#| echo: false

plot_narcissism_self_lmtp_output$transformed_table |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_narcissism_self_lmtp_output$interpretation)
```
{{< pagebreak >}}

## Results Study 5: Psychopathy Combined Score


### Results Study 5A: Psychopathy Combined Score: Partner
```{r}
#| label: fig-results-psychopathy-partner
#| fig-cap: "Results forPsychopathy Combined Score effect for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12

plot_psychopathy_combined_partner_lmtp_output$plot


```

{{< pagebreak >}}

```{r}
#| label: tbl-results-psychopathy-partner
#| tbl-cap: "Table for Psychopathy Combined Score effect for partner on multi-dimensional well-being."
#| include: true
#| echo: false

plot_psychopathy_combined_partner_lmtp_output$transformed_table |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_psychopathy_combined_partner_lmtp_output$interpretation)
```


### Results Study 5B  Psychopathy Combined Score: Self vs Partner

```{r}
#| label: fig-results-psychopathy-self
#| fig-cap: "Results for  Psychopathy Combined Score effect for self vs partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24

plot_psychopathy_combined_self_lmtp_output$plot + plot_psychopathy_combined_partner_lmtp_output$plot   + plot_annotation(tag_levels = "A")
```

{{< pagebreak >}}

```{r}
#| label: tbl-results-psychopathy-self
#| tbl-cap: "Table for Psychopathy Combined Score effect on self multi-dimensional well-being"
#| eval: true
#| include: true
#| echo: false

plot_narcissism_self_lmtp_output$transformed_table |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_psychopathy_combined_self_lmtp_output$interpretation)
```

## Discussion 

### Antagonism 

Antagonism affects partners and the self in different ways. For the **partner**, the only reliable result is a reduction in life satisfaction ($-0.10$, 95% CI: $[-0.17, -0.04]$).

For the **self**, antagonism reliably increases life satisfaction ($0.10$, 95% CI: $[0.04, 0.15]$), personal well-being ($0.13$, 95% CI: $[0.07, 0.19]$), satisfaction with the relationship ($0.11$, 95% CI: $[0.05, 0.17]$), and self-esteem ($0.08$, 95% CI: $[0.02, 0.13]$).

### Disinhibition

For the **partner**, none of the results are reliable as all confidence intervals cross zero.

For the **self**, disinhibition reliably reduces anxiety ($-0.10$, 95% CI: $[-0.15, -0.05]$) and distress ($-0.05$, 95% CI: $[-0.10, -0.01]$). There is also a marginally reliable improvement in personal well-being ($0.05$, 95% CI: $[0.00, 0.11]$) and self-esteem ($0.05$, 95% CI: $[0.00, 0.10]$).


### Emotional Stability

For the **partner**, none of the results are reliable as all confidence intervals cross zero.

For the **self**, emotional stability reliably reduces anxiety ($-0.10$, 95% CI: $[-0.15, -0.05]$) and distress ($-0.06$, 95% CI: $[-0.10, -0.01]$). There is also a marginally reliable improvement in personal well-being ($0.05$, 95% CI: $[0.00, 0.11]$) and self-esteem ($0.05$, 95% CI: $[0.01, 0.10]$).


### Narcicissm: 

For **partners**, narcissism reliably increases personal well-being ($0.07$, 95% CI: $[0.02, 0.12]$) and satisfaction with the relationship ($0.08$, 95% CI: $[0.01, 0.14]$). No other reliable effects are observed.

For the **self**, narcissism reliably reduces anxiety ($-0.08$, 95% CI: $[-0.14, -0.03]$), depression ($-0.10$, 95% CI: $[-0.16, -0.04]$), and distress ($-0.10$, 95% CI: $[-0.15, -0.04]$). It also reliably improves life satisfaction ($0.12$, 95% CI: $[0.06, 0.18]$) and self-esteem ($0.11$, 95% CI: $[0.06, 0.17]$).



### Psychopathy Combined 

For the **partner**, psychopathy reliably increases anxiety ($0.07$, 95% CI: $[0.03, 0.11]$) and distress ($0.05$, 95% CI: $[0.01, 0.09]$). It also reliably decreases personal well-being ($-0.11$, 95% CI: $[-0.14, -0.07]$), satisfaction with the relationship ($-0.06$, 95% CI: $[-0.10, -0.03]$), and self-esteem ($-0.09$, 95% CI: $[-0.13, -0.06]$).

For the **self**, psychopathy reliably reduces anxiety ($-0.08$, 95% CI: $[-0.14, -0.03]$), depression ($-0.10$, 95% CI: $[-0.16, -0.04]$), and distress ($-0.10$, 95% CI: $[-0.15, -0.04]$). It also reliably improves life satisfaction ($0.12$, 95% CI: $[0.06, 0.18]$) and self-esteem ($0.11$, 95% CI: $[0.06, 0.17]$).


### Importance of Research

These findings reveal that focussing on specific traits of psychopathic personality affects people differently than does psychopathy as a whole.  When we target individual traits such as antagonism or narcissism, people often feel better about themselves -- they report higher life satisfaction, well-being, and self-esteem, and experience reduced depression and anxiety. However, these personal improvements can come at a cost to their partners, who may suffer from decreased life satisfaction and increased distress. This indicates a complex interplay between self-improvement and relational harm.

On the other hand, when psychopathy is treated as a single, combined dimension, partners tend to suffer more. They experience more anxiety and distress, along with lower personal well-being and satisfaction in the relationship. Although, individuals for whom psychopathy increases might feel less depressed, they do not experience an overall improvement in well-being. As for partners, self-esteem, relationship satisfaction, and personal well being declines.  Moreover, life satisifaction declines and anxiety increases. There is a darker effects of psychopathy in couples are not restricted to the partners, but also extend to those in whom psychopathy personality is manifest. 

{{< pagebreak >}}

### Ethics

The NZAVS is reviewed every three years by the University of Auckland Human Participants Ethics Committee. Our most recent ethics approval statement is as follows: The New Zealand Attitudes and Values Study was approved by the University of Auckland Human Participants Ethics Committee on 26/05/2021 for six years until 26/05/2027, Reference Number UAHPEC22576.

### Acknowledgements

The New Zealand Attitudes and Values Study is supported by a grant from the TempletoReligion Trust (TRT0196; TRT0418). JB received support from the Max Planck Institute for the Science of Human History. The funders had no role in preparing the manuscript or the decision to publish.

### Author Statement

TBA... e.g. 


- AH conceived of the study, led the validation study, and developed the theory 
- HE ...  MH ...contributed to the theory.
- CS led data collection. 
- JB developed the inferential approach and did the analysis.  
- All authors contributed to writing the final version of the manuscript, which was substantially AHs work.

{{< pagebreak >}}

## References

::: {#refs}
:::


{{< pagebreak >}}

## Appendix A: Measurues {#appendix-measures}

#### Age (waves: 1-15)

We asked participants' age in an open-ended question ("What is your age?" or "What is your date of birth").

<!-- #### Disability (waves: 5-15) -->

<!-- We assessed disability with a one item indicator adapted from @verbrugge1997, that asks "Do you have a health condition or disability that limits you, and that has lasted for 6+ months?" (1 = Yes, 0 = No). -->

#### Disability


We assessed disability with a one-item indicator adapted from @verbrugge1997. It asks, "Do you have a health condition or disability that limits you and that has lasted for 6+ months?" (1 = Yes, 0 = No).


#### Education Attainment (waves: 1, 4-15)

Participants were asked "What is your highest level of qualification?". We coded participans highest finished degree according to the New Zealand Qualifications Authority. Ordinal-Rank 0-10 NZREG codes (with overseas school quals coded as Level 3, and all other ancillary categories coded as missing) See:https://www.nzqa.govt.nz/assets/Studying-in-NZ/New-Zealand-Qualification-Framework/requirements-nzqf.pdf

<!-- #### Employment (waves: 1-3, 4-11) -->

<!-- We asked participants "Are you currently employed? (This includes self-employed or casual work)". \* note: This question disappeared in the updated NZAVS Technical documents (Data Dictionary). -->

<!-- #### European (waves: 1-15) -->

<!-- Participants were asked "Which ethnic group do you belong to (NZ census question)?" or "Which ethnic group(s) do you belong to? (Open-ended)" (wave: 3). Europeans were coded as 1, whereas other ethnicities were coded as 0. -->

#### Ethnicity (waves: 3)

Based on the New Zealand Census, we asked participants "Which ethnic group(s) do you belong to?". The responses were: (1) New Zealand European; (2) Mori; (3) Samoan; (4) Cook Island Mori; (5) Tongan; (6) Niuean; (7) Chinese; (8) Indian; (9) Other such as DUTCH, JAPANESE, TOKELAUAN. Please state:. We coded their answers into four groups: Maori, Pacific, Asian, and Euro (except for Time 3, which used an open-ended measure).

#### Gender (waves: 1-15)

We asked participants' gender in an open-ended question: "what is your gender?" or "Are you male or female?" (waves: 1-5). Female was coded as 0, Male was coded as 1, and gender diverse coded as 3 [@fraser_coding_2020]. (or 0.5 = neither female nor male)

Here, we coded all those who responded as Male as 1, and those who did not as 0.

#### Income (waves: 1-3, 4-15)

Participants were asked "Please estimate your total household income (before tax) for the year XXXX". To stablise this indicator, we first took the natural log of the response + 1, and then centred and standardised the log-transformed indicator.

<!-- #### Job Security (waves: 1-3,4-7,9-15) -->

<!-- Participants indicated their feeling of job security by answering "How secure do you feel in your current job?" on a scale from 1 (not secure) to 7 (very secure). -->

#### Parent (waves: 5-15) -->

Participants were asked "If you are a parent, what is the birth date of your eldest child?" or "If you are a parent, in which year was your eldest child born?" (waves: 10-15). Parents were coded as 1, while the others were coded as 0. -->

<!-- #### Number of Children (waves: 1-3, 4-15) -->

<!-- We measured the number of children using one item from @Bulbulia_2015. We asked participants "How many children have you given birth to, fathered, or adopted. How many children have you given birth to, fathered, or adopted?" or ""How many children have you given birth to, fathered, or adopted. How many children have you given birth to, fathered, and/or parented?" (waves: 12-15). -->

<!-- Here, we used responses to create a binary indicator for parenthood: Parent Yes = 1/ No = 0.  -->

#### Political Orientation

We measured participants' political orientation using a single item adapted from @jost_end_2006-1.

"Please rate how politically liberal versus conservative you see yourself as being."

(1 = Extremely Liberal to 7 = Extremely Conservative)

#### NZSEI-13 (waves: 8-15)

We assessed occupational prestige and status using the New Zealand Socio-economic Index 13 (NZSEI-13) [@fahy2017]. This index uses the income, age, and education of a reference group, in this case, the 2013 New Zealand census, to calculate a score for each occupational group. Scores range from 10 (Lowest) to 90 (Highest). This list of index scores for occupational groups was used to assign each participant a NZSEI-13 score based on their occupation.

Participants were asked "If you are a parent, what is the birth date of your eldest child?".

#### Living with Partner

Participants were asekd "Do you live with your partner?" (1 = Yes, 0 = No).

#### Living in an Urban Area (waves: 1-15)

We coded whether they are living in an urban or rural area (1 = Urban, 0 = Rural) based on the addresses provided.

We coded whether they are living in an urban or rural area (1 = Urban, 0 = Rural) based on the addresses provided.

#### NZ Deprivation Index (waves: 1-15)

We used the NZ Deprivation Index to assign each participant a score based on where they live [@atkinson2019]. This score combines data such as income, home ownership, employment, qualifications, family structure, housing, and access to transport and communication for an area into one deprivation score.

<!-- #### NZ-Born (waves: 1-2,4-15) -->

<!-- We asked participants "Which country were you born in?" or "Where were you born? (please be specific, e.g., which town/city?)" (waves: 6-15). -->

<!-- #### Mini-IPIP 6 (waves: 1-3,4-15) -->

<!-- We measured participants' personality with the Mini International Personality Item Pool 6 (Mini-IPIP6) [@sibley2011] which consists of six dimensions and each dimension is measured with four items: -->

<!-- 1.  agreeableness, -->

<!--     i.  I sympathize with others' feelings. -->
<!--     ii. I am not interested in other people's problems. (r) -->
<!--     iii. I feel others' emotions. -->
<!--     iv. I am not really interested in others. (r) -->

<!-- 2.  conscientiousness, -->

<!--     i.  I get chores done right away. -->
<!--     ii. I like order. -->
<!--     iii. I make a mess of things. (r) -->
<!--     iv. I ften forget to put things back in their proper place. (r) -->

<!-- 3.  extraversion, -->

<!--     i.  I am the life of the party. -->
<!--     ii. I don't talk a lot. (r) -->
<!--     iii. I keep in the background. (r) -->
<!--     iv. I talk to a lot of different people at parties. -->

<!-- 4.  honesty-humility, -->

<!--     i.  I feel entitled to more of everything. (r) -->
<!--     ii. I deserve more things in life. (r) -->
<!--     iii. I would like to be seen driving around in a very expensive car. (r) -->
<!--     iv. I would get a lot of pleasure from owning expensive luxury goods. (r) -->

<!-- 5.  neuroticism, and -->

<!--     i.  I have frequent mood swings. -->
<!--     ii. I am relaxed most of the time. (r) -->
<!--     iii. I get upset easily. -->
<!--     iv. I seldom feel blue. (r) -->

<!-- 6.  openness to experience -->

<!--     i.  I have a vivid imagination. -->
<!--     ii. I have difficulty understanding abstract ideas. (r) -->
<!--     iii. I do not have a good imagination. (r) -->
<!--     iv. I am not interested in abstract ideas. (r) -->

<!-- Each dimension was assessed with four items and participants rated the accuracy of each item as it applies to them from 1 (Very Inaccurate) to 7 (Very Accurate). Items marked with (r) are reverse coded. -->

<!-- #### Honesty-Humility-Modesty Facet (waves: 10-14) -->

<!-- Participants indicated the extent to which they agree with the following four statements from @campbell2004 , and @sibley2011 (1 = Strongly Disagree to 7 = Strongly Agree) -->

<!-- ```          -->
<!-- i.  I want people to know that I am an important person of high status, (Waves: 1, 10-14) -->
<!-- ii. I am an ordinary person who is no better than others. -->
<!-- iii. I wouldn't want people to treat me as though I were superior to them. -->
<!-- iv. I think that I am entitled to more respect than the average person is. -->
<!-- ``` -->


## Appendix B. Baseline Demographic Statistics {#appendix-demographics}


```{r}
#| label: tbl-table-demography-code
#| tbl-cap: "Baseline demographic statistics"
#| eval: false
#| echo: false
#| include: false

summary_tables$baseline_table |> kbl(format = "markdown")


```






##  Appendix C: Baseline and Treatment Wave Exposure Statistics {#appendix-exposures}


```{r}
#| label: tbl-table-exposures-code
#| tbl-cap: "Exposures at baseline and treatment wave"
#| eval: false
#| echo: false
#| include: false

summary_tables$exposure_tables |> kbl(format = "markdown")
```


##  Appendix E: Baseline and End of Study Outcome Statistics {#appendix-outcomes}


```{r}
#| label: tbl-table-demographic_vars-code
#| tbl-cap: "Outcomes at baseline and end-of-study"
#| eval: false
#| echo: false
#| include: false
summary_tables$outcome_table |> kbl(format = "markdown")

```



## Appendix XX: Transition Matrices




```{r}
#| label: fig-exposure_histograms
#| fig-cap: "Distribution of the treatment variables at baseline."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 16
#| fig-width: 12

histogram_antagonism_emotional_stability_disinhibition_narcissism_psychopathy_combined_by_wave
```

@fig-exposure_histograms presents this distribution of the treatment variables at baseline, along with their means and standard deviations. 
We next consider change in the treatment variables over time.  Note that to make the transition tables readible, we rounded values of each exposure to the nearest whole number. This means that the tables will show less change than occurred. However, because our interest in exposures for which there is a one point shift in the response (up or down), the tables give an approximate sense of how change occurred in the same over one year. 

### Transition Table: Antagonism

```{r}
#| label: tbl-table-transition-antagonism
#| tbl-cap: "Observed shifts from the baseline to exposure wave in Antagonism"
#| eval: false
#| echo: false
#| include: false
transition_matrices$antagonism$table
#transition_matrices$antagonism$explanation
```

@tbl-table-transition-antagonism: This transition matrix captures shifts in states across Antagonismfrom the baseline to exposure wave. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the treatment at baseline (From), and the columns correspond to the state at the following wave (To). **Diagonal entries** (in **bold**) correspond to the number of individuals who remained in their initial state across both waves. **Off-diagonal entries** correspond to the transitions of individuals from their baseline state to a different state in the treatment wave. A higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more frequent shifts from the baseline state to other states.



### Transition Table: Disinhibition

```{r}
#| label: tbl-table-transition-disinhibition
#| tbl-cap: "Observed shifts from the baseline to exposure wave in Disinhibition"
#| eval: false
#| echo: false
#| include: false
transition_matrices$disinhibition$table
# transition_matrices$disinhibition$explanation
```

@tbl-table-transition-disinhibition: This transition matrix captures shifts in states across Disinhibition from the baseline to exposure wave. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the treatment at baseline (From), and the columns correspond to the state at the following wave (To). **Diagonal entries** (in **bold**) correspond to the number of individuals who remained in their initial state across both waves. **Off-diagonal entries** correspond to the transitions of individuals from their baseline state to a different state in the treatment wave. A higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more frequent shifts from the baseline state to other states.



### Transition Table: Emotional Stability

```{r}
#| label: tbl-table-transition-emotional_stability
#| tbl-cap: "Observed shifts from the baseline to exposure wave in Emotional Stability"
#| eval: false
#| echo: false
#| include: false
transition_matrices$emotional_stability$table
#transition_matrices$emotional_stability$explanation
```

@tbl-table-transition-emotional_stability: This transition matrix captures shifts in states across Emotional Stability from the baseline to exposure wave. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the treatment at baseline (From), and the columns correspond to the state at the following wave (To). **Diagonal entries** (in **bold**) correspond to the number of individuals who remained in their initial state across both waves. **Off-diagonal entries** correspond to the transitions of individuals from their baseline state to a different state in the treatment wave. A higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more frequent shifts from the baseline state to other states.



### Transition Table: Narcissism

```{r}
#| label: tbl-table-transition-narcissism
#| tbl-cap: "Observed shifts from the baseline to exposure wave in Narcissism"
#| eval: false
#| echo: false
#| include: false
transition_matrices$narcissism
#transition_matrices$emotional_stability$explanation
```

@tbl-table-transition-narcissism: This transition matrix captures shifts in states across Narcissism from the baseline to exposure wave. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the treatment at baseline (From), and the columns correspond to the state at the following wave (To). **Diagonal entries** (in **bold**) correspond to the number of individuals who remained in their initial state across both waves. **Off-diagonal entries** correspond to the transitions of individuals from their baseline state to a different state in the treatment wave. A higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more frequent shifts from the baseline state to other states.


### Transition Table: Emotional Stability

```{r}
#| label: tbl-table-transition-emotional_stability
#| tbl-cap: "Observed shifts from the baseline to exposure wave in Emotional Stability"
#| eval: false
#| echo: false
#| include: false
#transition_matrices$psychopathy_combined$table
transition_matrices$psychopathy_combined$explanation
```

@tbl-table-transition-emotional_stability: This transition matrix captures shifts in states across Emotional Stability from the baseline to exposure wave. Each cell in the matrix represents the count of individuals transitioning from one state to another. The rows correspond to the treatment at baseline (From), and the columns correspond to the state at the following wave (To). **Diagonal entries** (in **bold**) correspond to the number of individuals who remained in their initial state across both waves. **Off-diagonal entries** correspond to the transitions of individuals from their baseline state to a different state in the treatment wave. A higher number on the diagonal relative to the off-diagonal entries in the same row indicates greater stability in a state. Conversely, higher off-diagonal numbers suggest more frequent shifts from the baseline state to other states.



##  Appendix XX: OSF Planned Study Results {#appendix-xx}

### Results for OSF planned study 

## Results Study 1 Antagonism OSF (Partner)

```{r}
#| label: fig-results-antagonism-partner_osf
#| fig-cap: "Results for antagonism effect on osf partner multi-dimensional well-being: z-transformed"
#| eval: true
#| include: true
#| echo: false
#| fig-height: 16
#| fig-width: 16


plot_antagonism_partner_osf_lmtp_output$plot

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-antagonism-partner-osf
#| tbl-cap: "Table for antagonism effect on osf partner multi-dimensional well-being"
#| eval: true
#| include: false
#| echo: false

plot_antagonism_partner_osf_lmtp_output$transformed_table |>
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_antagonism_partner_osf_lmtp_output$interpretation)
```



### Results Study 1: Compare Antagonism OSF vs Reported (Partner)

```{r}
#| label: fig-results-antagonism-osf-compare
#| fig-cap: "Results for antagonism effect for osf vs reported partner on multi-dimensional well-being: z-transformed"
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24

plot_antagonism_partner_osf_lmtp_output$plot + plot_antagonism_partner_lmtp_output$plot + plot_annotation(tag_levels = "A")

```

{{< pagebreak >}}
## Results Study 2 Disinhibition OSF (Partner)

```{r}
#| label: fig-results-disinhibition-partner-osf
#| fig-cap: "Results for disinhibition effect for osf partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12


plot_disinhibition_partner_osf_lmtp_output$plot

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-disinhibition-partner-osf
#| tbl-cap: "Table for disinhibition effect for osf partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_disinhibition_partner_osf_lmtp_output$transformed_table|> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_disinhibition_partner_osf_lmtp_output$interpretation)

```


{{< pagebreak >}}
### Results Study Compare Disinhibition OSF vs Reported (Partner)

```{r}
#| label: fig-results-disinhibition-osf-compare
#| fig-cap: "Results for disinhibition effect for osf vs reported partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24


plot_disinhibition_partner_osf_lmtp_output$plot + plot_disinhibition_partner_lmtp_output$plot + plot_annotation(tag_levels = "A")

```

{{< pagebreak >}}

## Results Study 3  Emotional Stability: OSF (Partner) 

```{r}
#| label: fig-results-emotional-partner-osf
#| fig-cap: "Results for emotional stability effect for osf partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12

plot_emotional_stability_partner_osf_lmtp_output$plot

```

{{< pagebreak >}}

```{r}
#| label: tbl-results-emotional-partner-osf
#| tbl-cap: "Table for emotional stability effect for osf partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_emotional_stability_partner_osf_lmtp_output$transformed_table|> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_emotional_stability_partner_osf_lmtp_output$interpretation)

```

{{< pagebreak >}}

### Results Study 3  Emotional Stability OSF vs Reported (Partner)

```{r}
#| label: fig-results-emotional-osf-compare
#| fig-cap: "Results for emotional stability effect for osf vs reported partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24


plot_emotional_stability_self_lmtp_output$plot + plot_emotional_stability_partner_lmtp_output$plot + plot_annotation(tag_levels = "A")

```

{{< pagebreak >}}




## Results Study 4 Narcissism 



### Results Study 4A Narcissism: Partner

```{r}
#| label: fig-results-narcissism-partner-osf
#| fig-cap: "Results for Narcissism stability gain for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12
plot_narcissism_partner_osf_lmtp_output$plot
```

{{< pagebreak >}}

```{r}
#| label: tbl-results-narcissism-partner-osf
#| tbl-cap: "Table for Narcissism gain for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false

plot_narcissism_partner_osf_lmtp_output$transformed_table |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_narcissism_partner_osf_lmtp_output$interpretation)


```
{{< pagebreak >}}


### Results Study B Narcissism OSF vs Reported (Partner)

```{r}
#| label: fig-results-narcissism-self-osf
#| fig-cap: "Results for Narcissism stability effect for self vs partner on multi-dimensional well-being: z-transformed"
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24

plot_narcissism_partner_osf_lmtp_output$plot + plot_narcissism_partner_lmtp_output$plot   + plot_annotation(tag_levels = "A")
```

## Results Study 5: Psychopathy Combined Score: OSF (Partner)

```{r}
#| label: fig-results-psychopathy-partner-osf
#| fig-cap: "Results forPsychopathy Combined Score effect for partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 12

plot_psychopathy_combined_partner_osf_lmtp_output$plot


```

{{< pagebreak >}}

```{r}
#| label: tbl-results-psychopathy-partner-osf
#| tbl-cap: "Table for Psychopathy Combined Score effect for partner on multi-dimensional well-being."
#| include: true
#| echo: false

plot_psychopathy_combined_partner_osf_lmtp_output$transformed_table |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")

cat(plot_psychopathy_combined_partner_osf_lmtp_output$interpretation)
```


### Psychopathy Combined Score OSF vs Reported (Partner)

```{r}
#| label: fig-results-psychopathy-osf-compare
#| fig-cap: "Results for  Psychopathy Combined Score effect for self vs partner on multi-dimensional well-being."
#| eval: true
#| include: true
#| echo: false
#| fig-height: 12
#| fig-width: 24

plot_psychopathy_combined_partner_osf_lmtp_output$plot + plot_psychopathy_combined_partner_lmtp_output$plot   + plot_annotation(tag_levels = "A")
```



## Appendix XXX Null Contrasts for the reported model

###  Antagonism
#### Antagonism (Partner): Gain vs Null

```{r}
#| label: tbl-results-antagonism-partner-null-gain
#| tbl-cap: "Table for Antagonism on partner multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

antagonism_partner_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Antagonism (Partner): Loss vs Null

```{r}
#| label: tbl-results-antagonism-null-loss
#| tbl-cap: "Table for Antagonism on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

antagonism_partner_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```

###  Disinhibition
#### Disinhibition (Partner): Gain vs Null

```{r}
#| label: tbl-results-disinhibition-partner-null-gain
#| tbl-cap: "Table for Disinhibition effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

disinhibition_partner_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Disinhibition (Partner): Loss vs Null

```{r}
#| label: tbl-results-disinhibition-null-loss
#| tbl-cap: "Table for Disinhibition on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

disinhibition_partner_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```



###  Emotional Stability

#### Emotional Stability (Partner): Gain vs Null

```{r}
#| label: tbl-results-emotional-stability-partner-null-gain
#| tbl-cap: "Table for Disinhibition effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

emotional_stability_partner_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Emotional Stability (Partner): Loss vs Null

```{r}
#| label: tbl-results-emotional-stability-null-loss
#| tbl-cap: "Table for Disinhibition on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

emotional_stability_partner_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```



### Narcissism
####Narcissism (Partner): Gain vs Null

```{r}
#| label: tbl-results-narcissism-partner-null-gain
#| tbl-cap: "Table for Narcissism effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

narcissism_partner_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Narcissism (Partner): Loss vs Null

```{r}
#| label: tbl-results-psychopathy_combined_null-loss
#| tbl-cap: "Table for Narcissism on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

psychopathy_combined_partner_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


### Psychopathy Combined Score
#### Psychopathy Combined Score (Partner): Gain vs Null

```{r}
#| label: tbl-results-psychopathy_combined_partner-null-gain
#| tbl-cap: "Table for Narcissism effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

psychopathy_combined_partner_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Psychopathy Combined Score (Partner): Loss vs Null

```{r}
#| label: tbl-results-narcissism-null-loss
#| tbl-cap: "Table for Narcissism on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

psychopathy_combined_partner_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```



## Appendix XXX Null Contrasts for the OSF model

###  Antagonism OSF
#### Antagonism OSF (Partner): Gain vs Null

```{r}
#| label: tbl-results-antagonism-partner-null-gain-osf
#| tbl-cap: "Table for Antagonism on partner multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

antagonism_partner_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Antagonism OSF (Partner): Loss vs Null

```{r}
#| label: tbl-results-antagonism-null-loss-osf
#| tbl-cap: "Table for Antagonism on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

antagonism_partner_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```

###  Disinhibition OSF
#### Disinhibition OSF (Partner): Gain vs Null

```{r}
#| label: tbl-results-disinhibition-partner-null-gain-osf
#| tbl-cap: "Table for Disinhibition effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

disinhibition_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Disinhibition OSF (Partner): Loss vs Null

```{r}
#| label: tbl-results-disinhibition-null-loss-osf
#| tbl-cap: "Table for Disinhibition on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

disinhibition_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```



###  Emotional Stability OSF

#### Emotional Stability OSF (Partner): Gain vs Null

```{r}
#| label: tbl-results-emotional-stability-partner-null-gain-osf
#| tbl-cap: "Table for Disinhibition effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

emotional_stability_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Emotional Stability OSF (Partner): Loss vs Null

```{r}
#| label: tbl-results-emotional-stability-null-loss-osf
#| tbl-cap: "Table for Disinhibition on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

emotional_stability_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```



### Narcissism OSF

####Narcissism OSF (Partner): Gain vs Null

```{r}
#| label: tbl-results-narcissism-partner-null-gain-osf
#| tbl-cap: "Table for Narcissism effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

narcissism_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Narcissism OSF (Partner): Loss vs Null

```{r}
#| label: tbl-results-psychopathy_combined_null-loss-osf
#| tbl-cap: "Table for Narcissism on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

psychopathy_combined_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


### Psychopathy Combined Score OSF 

#### Psychopathy Combined Score OSF (Partner): Gain vs Null

```{r}
#| label: tbl-results-psychopathy_combined_partner-null-gain-osf
#| tbl-cap: "Table for Narcissism effect for partner on multi-dimensional well-being: gain vs null."
#| include: true
#| echo: false

psychopathy_combined_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_up_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```


#### Psychopathy Combined Score OSF (Partner): Loss vs Null

```{r}
#| label: tbl-results-narcissism-null-loss-osf
#| tbl-cap: "Table for Narcissism on partner multi-dimensional well-being: loss vs null."
#| include: true
#| echo: false

psychopathy_combined_partner_osf_lmtp_output$combined_tables$combined_outcomes_shift_down_vs_null |> 
  mutate(across(where(is.numeric), ~ round(., 2))) %>%
  kbl(format = "markdown")
```